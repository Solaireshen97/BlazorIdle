# Buff状态显示UI说明

## UI布局示意

### 战斗界面整体布局

```
┌─────────────────────────────────────────────────────────────────┐
│                     战斗状态显示区域                              │
├────────────────────────────┬────────────────────────────────────┤
│    👤 玩家状态面板          │    👹 怪物状态面板                  │
│  - 血量条                   │  - 怪物血量列表                     │
│  - 攻击进度                 │  - 波次信息                         │
├────────────────────────────┼────────────────────────────────────┤
│  🎭 增益效果                │  😈 敌方效果                        │
│  ┌──┐ ┌──┐ ┌──┐           │  ┌──┐ ┌──┐                        │
│  │💪│ │🛡️│ │⚡│           │  │😡│ │☠️│                        │
│  │5 │ │8s│ │12│            │  │15│ │3s│                        │
│  └──┘ └──┘ └──┘            │  └──┘ └──┘                         │
│  狂暴  破甲  精准            │  狂暴  中毒                         │
└────────────────────────────┴────────────────────────────────────┘
│                     地下城进度面板（如有）                         │
└─────────────────────────────────────────────────────────────────┘
```

## Buff图标卡片详细设计

### 增益效果卡片（玩家Buff）

```
┌────────────────┐
│ 8.5s     [图标] │  ← 左上角：倒计时
│                │
│      💪        │  ← 中央：Emoji图标 (18px)
│                │
│ [5层]          │  ← 右下角：层数显示
└────────────────┘
  42x42像素
  绿色边框 (#66bb6a)
  浅绿背景 (#e8f5e9)
```

### 减益效果卡片（敌人Buff）

```
┌────────────────┐
│ 3.2s     [图标] │  ← 左上角：倒计时
│                │
│      😡        │  ← 中央：Emoji图标 (18px)
│                │
│ [1层]          │  ← 右下角：层数显示
└────────────────┘
  42x42像素
  红色边框 (#ef5350)
  浅红背景 (#ffebee)
```

## 图标映射表

### 战士职业Buff

| Buff ID | 名称 | 图标 | 说明 |
|---------|------|------|------|
| berserk | Berserk | 💪 | 狂暴状态，增加急速 |
| warrior_expose_armor | Expose Armor | 🛡️ | 破甲，降低目标护甲 |
| warrior_precision | Precision | ⚡ | 精准，增加暴击率 |

### 游侠职业Buff

| Buff ID | 名称 | 图标 | 说明 |
|---------|------|------|------|
| ranger_bleed | Ranger Bleed | 🔥 | 流血，持续物理伤害 |
| ranger_hunters_mark | Hunter's Mark | 🎯 | 猎人印记，增加伤害 |
| ranger_sharpsight | Sharpsight | 👁️ | 锐视，增加暴击伤害 |
| focus_flow | Focus Flow | 🌊 | 专注涌动，持续恢复专注值 |

### 敌人Buff

| Buff ID | 名称 | 图标 | 说明 |
|---------|------|------|------|
| enrage | Enrage | 😡 | 激怒，增加伤害 |
| poison | Poison | ☠️ | 中毒，持续伤害 |
| regeneration | Regeneration | 💚 | 再生，持续治疗 |
| berserk | Berserk | 😡 | 狂暴（敌人版本） |

### 默认图标

| 场景 | 图标 | 说明 |
|------|------|------|
| 未知Buff | ✨ | 通用Buff图标 |

## 倒计时显示格式

| 剩余时间 | 显示格式 | 示例 |
|---------|---------|------|
| < 10秒 | 小数点1位 | `8.5s`, `3.2s` |
| 10-59秒 | 整数秒 | `15s`, `45s` |
| ≥ 60秒 | 分钟 | `2m`, `5m` |
| 永久 | 不显示 | （无倒计时） |

## 层数显示规则

| 条件 | 显示 |
|------|------|
| Stacks = 1 | 不显示层数 |
| Stacks > 1 | 在右下角显示层数 |
| 达到MaxStacks | 层数正常显示（无特殊标记） |

## 鼠标悬停提示（Tooltip）

```
狂暴
层数: 5/10
剩余: 8.5秒
```

或者（单层Buff）：

```
精准
剩余: 12.0秒
```

## 响应式布局

### 桌面端（宽屏）

```
┌────────────────────────────┬────────────────────────────┐
│  🎭 增益效果                │  😈 敌方效果                │
│  [💪] [🛡️] [⚡] [🔥]       │  [😡] [☠️]                │
└────────────────────────────┴────────────────────────────┘
```

### 移动端（窄屏）

Buff图标会自动换行（flex-wrap: wrap）：

```
┌───────────────────────────────────────┐
│  🎭 增益效果                           │
│  [💪] [🛡️] [⚡]                       │
│  [🔥] [🎯]                            │
└───────────────────────────────────────┘
```

## 动态更新

- **轮询频率**: 随战斗状态动态调整（1-5秒）
- **倒计时更新**: 每次轮询刷新
- **Buff出现/消失**: 平滑过渡（依赖浏览器默认）

## 性能特性

- ✅ 纯展示组件，无复杂计算
- ✅ 条件渲染（无Buff时不显示）
- ✅ 最小化DOM节点（每个Buff仅3-4个元素）
- ✅ 无额外API请求（包含在战斗状态查询中）

## 可访问性

- ✅ `title` 属性提供完整信息
- ✅ `cursor: help` 提示可悬停
- ✅ 高对比度配色（WCAG AA级）
- ✅ Emoji图标跨平台兼容

## 浏览器兼容性

- ✅ Chrome/Edge: 完全支持
- ✅ Firefox: 完全支持
- ✅ Safari: 完全支持（Emoji可能略有差异）
- ✅ 移动浏览器: 完全支持

## 实际效果预览

### 战士战斗中的Buff显示

**玩家Buff（增益）：**
- 💪 狂暴 (6秒) - 增加30%急速
- ⚡ 精准 (8秒) - 增加20%暴击率

**敌人Buff（从玩家视角看是"减益"）：**
- 🛡️ 破甲 (8秒) - 目标护甲-150

### 游侠战斗中的Buff显示

**玩家Buff（增益）：**
- 🎯 猎人印记 (10秒) - 增加10%物理伤害
- 👁️ 锐视 (8秒) - 增加50%暴击伤害
- 🌊 专注涌动 (5秒, 3层) - 每秒恢复3点专注值

**敌人Buff（从玩家视角看是"减益"）：**
- 🔥 流血 (8秒, 2层) - 每2秒造成30点物理伤害

## 未来扩展可能性

### 短期
- 点击Buff显示详细效果描述
- Buff效果数值显示（如"-25% 护甲"）
- Buff出现/消失动画

### 中期
- 自定义图标上传
- Buff分类显示（增益/减益/控制）
- Buff历史记录

### 长期
- Buff触发音效
- Buff统计分析
- Buff推荐系统

---

**文档版本**: 1.0  
**最后更新**: 2025-10-10  
**相关组件**: BuffBarPanel.razor
