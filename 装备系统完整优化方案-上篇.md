# BlazorIdle è£…å¤‡ç³»ç»Ÿå®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ - ä¸Šç¯‡

**é¡¹ç›®**: BlazorIdle  
**æ–‡æ¡£ç±»å‹**: ç»¼åˆè®¾è®¡æ–¹æ¡ˆï¼ˆæ•´åˆç‰ˆï¼‰  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-11  
**ç‰ˆæœ¬**: 2.0 æ•´åˆç‰ˆ  
**çŠ¶æ€**: è®¾è®¡é˜¶æ®µ - å¾…å®æ–½  
**æ–‡æ¡£åˆ†å†Œ**: ä¸Šç¯‡ï¼ˆå…±ä¸‰ç¯‡ï¼‰

---

## ğŸ“‹ æ–‡æ¡£è¯´æ˜

æœ¬æ–‡æ¡£æ•´åˆäº†ä»¥ä¸‹ä¸¤å¥—ä¼˜åŒ–æ–¹æ¡ˆçš„å†…å®¹ï¼š
1. **è£…å¤‡ç³»ç»Ÿä¼˜åŒ–æ–¹æ¡ˆ.md** - ä¾§é‡åŸºç¡€è£…å¤‡åŠŸèƒ½å®ç°ï¼ˆç”Ÿæˆã€æ‰è½ã€ç®¡ç†ã€å¢å¼ºï¼‰
2. **è£…å¤‡ç³»ç»Ÿä¼˜åŒ–è®¾è®¡æ–¹æ¡ˆ.md** - ä¾§é‡é«˜çº§ç‰¹æ€§ï¼ˆ17æ§½ä½ã€æŠ¤ç”²ç±»å‹ã€æ­¦å™¨ç³»ç»Ÿã€èŒä¸šé™åˆ¶ï¼‰

æ•´åˆåå½¢æˆä¸€å¥—å®Œæ•´çš„ã€å¯åˆ†æ­¥å®æ–½çš„è£…å¤‡ç³»ç»Ÿä¼˜åŒ–æ–¹æ¡ˆï¼Œåˆ†ä¸ºä¸Šã€ä¸­ã€ä¸‹ä¸‰ç¯‡ï¼š
- **ä¸Šç¯‡**ï¼šæ¦‚è§ˆã€æ¶æ„è®¾è®¡ã€Phase 1-3ï¼ˆæ•°æ®æ¨¡å‹ä¸æ ¸å¿ƒåŠŸèƒ½ï¼‰
- **ä¸­ç¯‡**ï¼šPhase 4-6ï¼ˆå‰ç«¯å®ç°ã€è£…å¤‡å¢å¼ºã€å¥—è£…ç³»ç»Ÿï¼‰
- **ä¸‹ç¯‡**ï¼šPhase 7-9ï¼ˆé«˜çº§åŠŸèƒ½ã€æµ‹è¯•æ–‡æ¡£ã€é£é™©ç®¡ç†ï¼‰

---

## ğŸ“– ç›®å½•

### ä¸Šç¯‡å†…å®¹
1. [æ•´åˆè®¾è®¡æ¦‚è§ˆ](#1-æ•´åˆè®¾è®¡æ¦‚è§ˆ)
2. [å½“å‰çŠ¶æ€å…¨é¢åˆ†æ](#2-å½“å‰çŠ¶æ€å…¨é¢åˆ†æ)
3. [è®¾è®¡ç›®æ ‡ä¸åŸåˆ™](#3-è®¾è®¡ç›®æ ‡ä¸åŸåˆ™)
4. [è£…å¤‡ç³»ç»Ÿå®Œæ•´æ¶æ„](#4-è£…å¤‡ç³»ç»Ÿå®Œæ•´æ¶æ„)
5. [æ•°æ®æ¨¡å‹å®Œæ•´è®¾è®¡](#5-æ•°æ®æ¨¡å‹å®Œæ•´è®¾è®¡)
6. [Phase 1: æ•°æ®åº“ä¸é¢†åŸŸæ¨¡å‹åŸºç¡€](#phase-1-æ•°æ®åº“ä¸é¢†åŸŸæ¨¡å‹åŸºç¡€-ç¬¬1-2å‘¨)
7. [Phase 2: è£…å¤‡ç”Ÿæˆä¸æ‰è½ç³»ç»Ÿ](#phase-2-è£…å¤‡ç”Ÿæˆä¸æ‰è½ç³»ç»Ÿ-ç¬¬3-4å‘¨)
8. [Phase 3: è£…å¤‡ç®¡ç†ä¸æˆ˜æ–—é›†æˆ](#phase-3-è£…å¤‡ç®¡ç†ä¸æˆ˜æ–—é›†æˆ-ç¬¬5-6å‘¨)

---

## 1. æ•´åˆè®¾è®¡æ¦‚è§ˆ

### 1.1 æ•´åˆç›®æ ‡

æœ¬æ–¹æ¡ˆå°†ä¸¤å¥—è£…å¤‡ä¼˜åŒ–æ–¹æ¡ˆæ·±åº¦æ•´åˆï¼Œå®ç°ä»¥ä¸‹æ ¸å¿ƒç›®æ ‡ï¼š

#### åŸºç¡€åŠŸèƒ½ç›®æ ‡ï¼ˆæ¥è‡ªæ–¹æ¡ˆä¸€ï¼‰
- âœ… å®Œå–„æœåŠ¡ç«¯è£…å¤‡ç”Ÿæˆã€æ‰è½ã€è£…å¤‡/å¸ä¸‹ã€å±æ€§è®¡ç®—
- âœ… é›†æˆåˆ°æˆ˜æ–—ç³»ç»Ÿå’Œç»æµç³»ç»Ÿ
- âœ… æ”¯æŒè£…å¤‡å¢å¼ºï¼ˆåˆ†è§£/é‡é“¸/è¯æ¡é‡ç½®ï¼‰
- âœ… å®ç°å‰ç«¯è£…å¤‡ç®¡ç†å’Œæ“ä½œç•Œé¢

#### é«˜çº§ç‰¹æ€§ç›®æ ‡ï¼ˆæ¥è‡ªæ–¹æ¡ˆäºŒï¼‰
- âœ… æ‰©å±•è£…å¤‡æ§½ä½ä»9ä¸ªåˆ°17ä¸ªï¼ˆå«åŒæˆ’æŒ‡ã€åŒé¥°å“ã€å®Œæ•´æ­¦å™¨ç³»ç»Ÿï¼‰
- âœ… å¼•å…¥æŠ¤ç”²ç±»å‹ç³»ç»Ÿï¼ˆå¸ƒç”²ã€çš®ç”²ã€é”ç”²ã€æ¿ç”²ï¼‰
- âœ… å®ç°æ­¦å™¨ç±»å‹ç³»ç»Ÿï¼ˆ15ç§æ­¦å™¨ç±»å‹ï¼Œæ”»å‡»é€Ÿåº¦æœºåˆ¶ï¼‰
- âœ… å®ç°æŠ¤ç”²å‡ä¼¤å’Œæ ¼æŒ¡æœºåˆ¶
- âœ… å®ç°èŒä¸šè£…å¤‡é™åˆ¶å’Œå¹³è¡¡

### 1.2 æ•´åˆä¼˜åŠ¿

é€šè¿‡æ•´åˆä¸¤å¥—æ–¹æ¡ˆï¼Œæˆ‘ä»¬è·å¾—ï¼š

1. **å®Œæ•´æ€§** - ä»åŸºç¡€æ•°æ®æ¨¡å‹åˆ°é«˜çº§æ¸¸æˆæœºåˆ¶çš„å…¨è¦†ç›–
2. **æ¸è¿›æ€§** - åˆ†9ä¸ªPhaseé€æ­¥å®æ–½ï¼Œæ¯ä¸ªPhaseå¯ç‹¬ç«‹æµ‹è¯•å’Œä¸Šçº¿
3. **å¯éªŒè¯æ€§** - æ¯ä¸ªPhaseåŒ…å«å‰ç«¯éªŒè¯æ­¥éª¤ï¼Œç¡®ä¿åŠŸèƒ½å¯è§å¯ç”¨
4. **ä¸€è‡´æ€§** - ç»Ÿä¸€çš„ä»£ç é£æ ¼ã€æ¶æ„åŸåˆ™å’Œå®æ–½æ ‡å‡†
5. **æ‰©å±•æ€§** - ä¸ºæœªæ¥åŠŸèƒ½é¢„ç•™æ¥å£ï¼ˆé™„é­”ã€å®çŸ³ã€ç‰¹æ®Šæ•ˆæœç­‰ï¼‰

### 1.3 æ ¸å¿ƒè®¾è®¡äº®ç‚¹

| è®¾è®¡ç»´åº¦ | æ ¸å¿ƒäº®ç‚¹ |
|---------|---------|
| **æ•°æ®é©±åŠ¨** | æ‰€æœ‰é…ç½®é€šè¿‡JSONç®¡ç†ï¼Œæ”¯æŒçƒ­é‡è½½ï¼Œæ— éœ€é‡æ–°ç¼–è¯‘ |
| **æœåŠ¡ç«¯æƒå¨** | æ‰€æœ‰è£…å¤‡æ“ä½œå’Œå±æ€§è®¡ç®—åœ¨æœåŠ¡ç«¯éªŒè¯ï¼Œé˜²æ­¢ä½œå¼Š |
| **é¢†åŸŸé©±åŠ¨** | æ¸…æ™°çš„é¢†åŸŸè¾¹ç•Œï¼ˆEquipment / Economy / Combatï¼‰ï¼Œç¬¦åˆDDDæ¨¡å¼ |
| **ç±»WoWè®¾è®¡** | å‚è€ƒã€Šé­”å…½ä¸–ç•Œã€‹æˆç†Ÿçš„è£…å¤‡ç³»ç»Ÿè®¾è®¡ |
| **æ€§èƒ½ä¼˜åŒ–** | å±æ€§è®¡ç®—ç¼“å­˜ã€æ‡’åŠ è½½ã€æ‰¹é‡æ“ä½œæ”¯æŒ |
| **å‰ç«¯å‹å¥½** | æ¯ä¸ªåç«¯åŠŸèƒ½å¯¹åº”å‰ç«¯éªŒè¯ç‚¹ï¼Œç¡®ä¿ç”¨æˆ·å¯æ„ŸçŸ¥ |

---

## 2. å½“å‰çŠ¶æ€å…¨é¢åˆ†æ

### 2.1 å·²å®Œæˆçš„å·¥ä½œ

æ ¹æ®é¡¹ç›®æ–‡æ¡£åˆ†æï¼Œè£…å¤‡ç³»ç»ŸUIæ¡†æ¶å·²åœ¨ **Step 5** å®Œæˆï¼š

#### âœ… å·²å®ç°éƒ¨åˆ†

**1. å‰ç«¯UIæ¡†æ¶** (`EquipmentPanel.razor`)
- 9ä¸ªè£…å¤‡æ§½ä½UIï¼ˆå¤´ç›”/æ­¦å™¨/èƒ¸ç”²/å‰¯æ‰‹/è…°å¸¦/è…¿éƒ¨/é‹å­/é¥°å“1/é¥°å“2ï¼‰
- æ€»å±æ€§å±•ç¤ºé¢æ¿
- å“è´¨é¢œè‰²ç³»ç»Ÿï¼ˆæ™®é€š/ç¨€æœ‰/å²è¯—/ä¼ è¯´ï¼‰
- è£…å¤‡æ§½ä½å¸ƒå±€ï¼ˆ3x3ç½‘æ ¼ï¼‰

**2. æ•°æ®æ¨¡å‹å®šä¹‰** (`ApiModels.cs`)
- `EquipmentResponse`: è£…å¤‡æ å“åº”
- `EquipmentSlotDto`: è£…å¤‡æ§½
- `GearInstanceDto`: è£…å¤‡å®ä¾‹
- `AffixDto`: è£…å¤‡è¯æ¡

**3. APIæ¥å£é¢„ç•™** (`EquipmentController.cs`)
- `GET /api/equipment/{characterId}` - è·å–è£…å¤‡æ ï¼ˆè¿”å›ç©ºæ§½ï¼‰
- `POST /api/equipment/{characterId}/{slot}` - è£…å¤‡ç‰©å“ï¼ˆè¿”å›501ï¼‰
- `DELETE /api/equipment/{characterId}/{slot}` - å¸ä¸‹è£…å¤‡ï¼ˆè¿”å›501ï¼‰
- `GET /api/equipment/{characterId}/stats` - è·å–è£…å¤‡å±æ€§ï¼ˆè¿”å›é›¶å±æ€§ï¼‰

**4. æµ‹è¯•è¦†ç›–**
- 18ä¸ªå•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡
- è¦†ç›–æ§½ä½ç±»å‹ã€å“è´¨ã€å±æ€§ç­‰æ ¸å¿ƒåŠŸèƒ½

### 2.2 ç¼ºå¤±çš„å…³é”®åŠŸèƒ½

#### âŒ æ•°æ®å±‚ç¼ºå¤±
- è£…å¤‡å®šä¹‰è¡¨ï¼ˆGearDefinitionï¼‰
- è£…å¤‡å®ä¾‹è¡¨ï¼ˆGearInstanceï¼‰
- è£…å¤‡è¯æ¡ç³»ç»Ÿï¼ˆAffix / AffixInstanceï¼‰
- å¥—è£…ç³»ç»Ÿï¼ˆGearSetï¼‰
- æŠ¤ç”²ç±»å‹å’Œæ­¦å™¨ç±»å‹é…ç½®

#### âŒ æœåŠ¡å±‚ç¼ºå¤±
- è£…å¤‡ç”Ÿæˆé€»è¾‘ï¼ˆå“è´¨/Tier/è¯æ¡éšæœºï¼‰
- è£…å¤‡æ‰è½ç³»ç»Ÿï¼ˆé›†æˆåˆ°Economyï¼‰
- è£…å¤‡/å¸ä¸‹æ“ä½œæœåŠ¡
- è£…å¤‡å±æ€§è®¡ç®—ä¸æ±‡æ€»æœåŠ¡
- è£…å¤‡å¢å¼ºæœåŠ¡ï¼ˆåˆ†è§£/é‡é“¸/è¯æ¡é‡ç½®ï¼‰
- æŠ¤ç”²è®¡ç®—å’Œæ ¼æŒ¡æœºåˆ¶

#### âŒ é›†æˆå±‚ç¼ºå¤±
- è£…å¤‡å±æ€§æ³¨å…¥åˆ° CharacterStats
- è£…å¤‡å±æ€§å‚ä¸æˆ˜æ–—è®¡ç®—
- è£…å¤‡ç‰¹æ•ˆ/è§¦å‘æŠ€èƒ½
- èŒä¸šè£…å¤‡é™åˆ¶éªŒè¯

### 2.3 å¯å¤ç”¨çš„ç°æœ‰ç³»ç»Ÿ

#### 1. ç»æµç³»ç»Ÿ (`Domain/Combat/Economy/`)
- âœ… `EconomyRegistry`: ç‰©å“æ³¨å†Œä¸­å¿ƒ
- âœ… `LootTable`: æ‰è½è¡¨ç³»ç»Ÿ
- âœ… `EconomyCalculator`: æ‰è½è®¡ç®—å™¨
- âœ… `RewardGrantService`: å¥–åŠ±å‘æ”¾æœåŠ¡
- âœ… `InventoryItem`: èƒŒåŒ…ç‰©å“è¡¨
- **å¯æ‰©å±•**: å°†è£…å¤‡ä½œä¸ºç‰¹æ®Šç‰©å“ç±»å‹é›†æˆ

#### 2. æˆ˜æ–—ç³»ç»Ÿ (`Domain/Combat/`)
- âœ… `CharacterStats`: è§’è‰²å±æ€§ï¼ˆæ”»å‡»/æš´å‡»/æ€¥é€Ÿ/ç©¿é€ï¼‰
- âœ… `PlayerCombatant`: ç©å®¶æˆ˜æ–—å•ä½
- âœ… `StatsBuilder`: å±æ€§æ„å»ºå™¨
- âœ… `BuffManager`: Buffç®¡ç†ï¼ˆå¯ç”¨äºå¥—è£…æ•ˆæœï¼‰
- **éœ€é›†æˆ**: è£…å¤‡å±æ€§è®¡ç®—æ³¨å…¥åˆ°å±æ€§æ„å»ºæµç¨‹

#### 3. èŒä¸šç³»ç»Ÿ (`Domain/Combat/Professions/`)
- âœ… `IProfessionModule`: èŒä¸šæ¨¡å—æ¥å£
- âœ… `WarriorModule`: æˆ˜å£«å®ç°
- âœ… `RangerModule`: æ¸¸ä¾ å®ç°
- **éœ€æ‰©å±•**: èŒä¸šè£…å¤‡é™åˆ¶é…ç½®

---

## 3. è®¾è®¡ç›®æ ‡ä¸åŸåˆ™

### 3.1 ç»¼åˆè®¾è®¡ç›®æ ‡

#### åŠŸèƒ½ç›®æ ‡
1. **å®Œæ•´çš„è£…å¤‡ç”Ÿå‘½å‘¨æœŸ**
   - ç”Ÿæˆï¼šéšæœºå“è´¨ã€Tierã€è¯æ¡ã€å±æ€§
   - è·å–ï¼šé€šè¿‡æˆ˜æ–—æ‰è½ã€ä»»åŠ¡å¥–åŠ±ã€å•†åº—è´­ä¹°
   - ä½¿ç”¨ï¼šè£…å¤‡/å¸ä¸‹ã€å±æ€§ç”Ÿæ•ˆã€å¥—è£…æ¿€æ´»
   - å¢å¼ºï¼šåˆ†è§£ã€é‡é“¸ã€è¯æ¡é‡ç½®
   - ç®¡ç†ï¼šèƒŒåŒ…å­˜å‚¨ã€å¯¹æ¯”ã€æ’åºã€ç­›é€‰

2. **å®Œæ•´çš„è£…å¤‡ç³»ç»Ÿç‰¹æ€§**
   - 17ä¸ªè£…å¤‡æ§½ä½ï¼ˆå¤´/é¢ˆ/è‚©/èƒŒ/èƒ¸/è…•/æ‰‹/è…°/è…¿/è„š/ä¸»æ‰‹/å‰¯æ‰‹/åŒæ‰‹/æˆ’æŒ‡Ã—2/é¥°å“Ã—2ï¼‰
   - 4ç§æŠ¤ç”²ç±»å‹ï¼ˆå¸ƒç”²/çš®ç”²/é”ç”²/æ¿ç”²ï¼‰ï¼Œå½±å“å‡ä¼¤
   - 15ç§æ­¦å™¨ç±»å‹ï¼Œå½±å“æ”»å‡»é€Ÿåº¦å’Œä¼¤å®³å€ç‡
   - æ ¼æŒ¡æœºåˆ¶ï¼ˆç›¾ç‰Œç‰¹æœ‰ï¼‰
   - èŒä¸šè£…å¤‡é™åˆ¶ï¼ˆæˆ˜å£«ä¸èƒ½ç©¿å¸ƒç”²ï¼Œæ³•å¸ˆä¸èƒ½ç”¨åŒæ‰‹æ–§ç­‰ï¼‰

3. **å®Œæ•´çš„æˆ˜æ–—é›†æˆ**
   - è£…å¤‡å±æ€§æ­£ç¡®æ³¨å…¥è§’è‰²å±æ€§
   - æŠ¤ç”²å€¼å½±å“ä¼¤å®³å‡å…
   - æ­¦å™¨æ”»å‡»é€Ÿåº¦å½±å“æˆ˜æ–—èŠ‚å¥
   - æ ¼æŒ¡æ¦‚ç‡è§¦å‘å¹¶å‡ä¼¤
   - å¥—è£…æ•ˆæœè§¦å‘ç‰¹æ®ŠBuff

#### æŠ€æœ¯ç›®æ ‡
1. **æœåŠ¡ç«¯æƒå¨æ€§** - æ‰€æœ‰è£…å¤‡æ“ä½œåœ¨æœåŠ¡ç«¯éªŒè¯å’Œè®¡ç®—
2. **æ•°æ®é©±åŠ¨** - é…ç½®åŒ–ç®¡ç†ï¼Œæ”¯æŒå¿«é€Ÿè°ƒæ•´å’Œæ‰©å±•
3. **é«˜æ€§èƒ½** - ç¼“å­˜ä¼˜åŒ–ï¼Œæ‰¹é‡æ“ä½œï¼Œæ‡’åŠ è½½
4. **å¯æµ‹è¯•æ€§** - å®Œæ•´çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•è¦†ç›–
5. **å¯ç»´æŠ¤æ€§** - æ¸…æ™°çš„æ¨¡å—åˆ’åˆ†ï¼Œç¬¦åˆSOLIDåŸåˆ™

#### ä½“éªŒç›®æ ‡
1. **ç›´è§‚æ˜“ç”¨** - å‰ç«¯ç•Œé¢å‹å¥½ï¼Œæ“ä½œæµç•…
2. **å³æ—¶åé¦ˆ** - è£…å¤‡æ“ä½œç«‹å³å¯è§ï¼Œå±æ€§å˜åŒ–æ¸…æ™°
3. **æ·±åº¦å¯ç©** - è£…å¤‡æ­é…ç­–ç•¥ä¸°å¯Œï¼Œä¼˜åŒ–ç©ºé—´å¤§
4. **å¹³è¡¡åˆç†** - ä¸åŒèŒä¸šã€ä¸åŒè£…å¤‡ç±»å‹å„æœ‰ä¼˜åŠ¿

### 3.2 æ ¸å¿ƒè®¾è®¡åŸåˆ™

æ ¹æ®ã€Šæ•´åˆè®¾è®¡æ€»ç»“.txtã€‹ç¬¬3èŠ‚æ¶æ„åŸåˆ™ï¼Œæˆ‘ä»¬éµå¾ªï¼š

#### 1. æœåŠ¡ç«¯æƒå¨ (Server Authoritative)
```
âœ… æ‰€æœ‰è£…å¤‡æ“ä½œåœ¨æœåŠ¡ç«¯éªŒè¯
âœ… è£…å¤‡å±æ€§è®¡ç®—åœ¨æœåŠ¡ç«¯å®Œæˆ
âœ… é˜²æ­¢å®¢æˆ·ç«¯ä½œå¼Š
âœ… æ‰è½è¡¨å’Œéšæœºæ•°åœ¨æœåŠ¡ç«¯æ§åˆ¶
```

#### 2. æ•°æ®é©±åŠ¨ (Data-Driven)
```
âœ… è£…å¤‡å®šä¹‰é…ç½®åŒ–ï¼ˆJSON/æ•°æ®è¡¨ï¼‰
âœ… è¯æ¡æ± ã€æ‰è½è¡¨é…ç½®åŒ–
âœ… æŠ¤ç”²ç±»å‹ã€æ­¦å™¨ç±»å‹é…ç½®åŒ–
âœ… èŒä¸šé™åˆ¶é…ç½®åŒ–
âœ… ä¾¿äºå¹³è¡¡è°ƒæ•´å’Œå†…å®¹æ‰©å±•
```

#### 3. é¢†åŸŸé©±åŠ¨è®¾è®¡ (DDD)
```
âœ… æ¸…æ™°çš„é¢†åŸŸè¾¹ç•Œï¼ˆEquipment / Economy / Combatï¼‰
âœ… èšåˆæ ¹æ¨¡å¼ï¼ˆGearInstance ä½œä¸ºèšåˆæ ¹ï¼‰
âœ… é¢†åŸŸäº‹ä»¶ä¼ æ’­ï¼ˆEquipmentChanged / StatsRecalculatedï¼‰
âœ… å€¼å¯¹è±¡å°è£…ï¼ˆStatModifier, TierLevel, Rarityï¼‰
```

#### 4. å¯æµ‹è¯•æ€§ (Testability)
```
âœ… å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘
âœ… å¯æ³¨å…¥ä¾èµ–ï¼ˆRNG / Repositoryï¼‰
âœ… å¹‚ç­‰æ€§ä¿è¯
âœ… ç¡®å®šæ€§éšæœºï¼ˆRNGContextï¼‰
```

#### 5. æ€§èƒ½ä¼˜åŒ–
```
âœ… å±æ€§è®¡ç®—ç¼“å­˜ï¼ˆè£…å¤‡å˜æ›´æ—¶å¤±æ•ˆï¼‰
âœ… æ‡’åŠ è½½è£…å¤‡æ•°æ®
âœ… æ‰¹é‡æ“ä½œæ”¯æŒ
âœ… æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
```

#### 6. å®‰å…¨æ€§
```
âœ… è£…å¤‡æ“ä½œé™é¢‘
âœ… äº¤æ˜“éªŒè¯ï¼ˆé˜²æ­¢åˆ·è£…å¤‡ï¼‰
âœ… è£…å¤‡ç»‘å®šæœºåˆ¶
âœ… å®¡è®¡æ—¥å¿—è®°å½•
```

---

## 4. è£…å¤‡ç³»ç»Ÿå®Œæ•´æ¶æ„

### 4.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯å±‚ (Blazor)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EquipmentPanel.razor    â”‚ InventoryPanel.razor              â”‚
â”‚  GearEnhancementDialog   â”‚ GearComparisonTooltip            â”‚
â”‚  EquipmentApiClient      â”‚ å‰ç«¯çŠ¶æ€ç®¡ç†                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ HTTP/SignalR
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      APIå±‚ (Controllers)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EquipmentController     â”‚ è£…å¤‡CRUDæ“ä½œ                       â”‚
â”‚  EnhancementController   â”‚ è£…å¤‡å¢å¼ºæ“ä½œ                       â”‚
â”‚  ValidationMiddleware    â”‚ è¯·æ±‚éªŒè¯å’Œé™é¢‘                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨æœåŠ¡å±‚ (Services)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  EquipmentService        â”‚ è£…å¤‡ç®¡ç†æ ¸å¿ƒé€»è¾‘                   â”‚
â”‚  GearGenerationService   â”‚ è£…å¤‡ç”Ÿæˆç®—æ³•                       â”‚
â”‚  StatsAggregationService â”‚ å±æ€§èšåˆè®¡ç®—                       â”‚
â”‚  DisenchantService       â”‚ åˆ†è§£æœåŠ¡                          â”‚
â”‚  ReforgeService          â”‚ é‡é“¸æœåŠ¡                          â”‚
â”‚  SetBonusService         â”‚ å¥—è£…æ•ˆæœæœåŠ¡                       â”‚
â”‚  ArmorCalculator         â”‚ æŠ¤ç”²è®¡ç®—æœåŠ¡                       â”‚
â”‚  BlockCalculator         â”‚ æ ¼æŒ¡è®¡ç®—æœåŠ¡                       â”‚
â”‚  EquipmentValidator      â”‚ è£…å¤‡éªŒè¯æœåŠ¡                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     é¢†åŸŸæ¨¡å‹å±‚ (Domain)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Models:                                                     â”‚
â”‚  - GearDefinition        â”‚ è£…å¤‡å®šä¹‰ï¼ˆé…ç½®ï¼‰                   â”‚
â”‚  - GearInstance          â”‚ è£…å¤‡å®ä¾‹ï¼ˆè¿è¡Œæ—¶ï¼‰                 â”‚
â”‚  - Affix/AffixInstance   â”‚ è¯æ¡ç³»ç»Ÿ                          â”‚
â”‚  - GearSet               â”‚ å¥—è£…å®šä¹‰                          â”‚
â”‚  - ArmorTypeConfig       â”‚ æŠ¤ç”²ç±»å‹é…ç½®                       â”‚
â”‚  - WeaponTypeConfig      â”‚ æ­¦å™¨ç±»å‹é…ç½®                       â”‚
â”‚  - ProfessionEquipConfig â”‚ èŒä¸šè£…å¤‡é™åˆ¶                       â”‚
â”‚                                                              â”‚
â”‚  Value Objects:                                              â”‚
â”‚  - StatModifier          â”‚ å±æ€§ä¿®é¥°ç¬¦                         â”‚
â”‚  - TierLevel             â”‚ å“çº§                              â”‚
â”‚  - Rarity                â”‚ ç¨€æœ‰åº¦                            â”‚
â”‚  - EquipmentSlot         â”‚ è£…å¤‡æ§½ä½æšä¸¾                       â”‚
â”‚  - ArmorType             â”‚ æŠ¤ç”²ç±»å‹æšä¸¾                       â”‚
â”‚  - WeaponType            â”‚ æ­¦å™¨ç±»å‹æšä¸¾                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®æŒä¹…å±‚ (Repository)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  IGearDefinitionRepository                                   â”‚
â”‚  IGearInstanceRepository                                     â”‚
â”‚  IAffixRepository                                            â”‚
â”‚  IGearSetRepository                                          â”‚
â”‚  â†“                                                           â”‚
â”‚  GameDbContext (EF Core)                                     â”‚
â”‚  â†“                                                           â”‚
â”‚  PostgreSQL Database                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ¨ªå‘é›†æˆï¼š
â”œâ”€ Economy System: æ‰è½è¡¨ã€å¥–åŠ±å‘æ”¾ã€ææ–™ç³»ç»Ÿ
â”œâ”€ Combat System: å±æ€§æ³¨å…¥ã€æˆ˜æ–—è®¡ç®—ã€Buffç³»ç»Ÿ
â”œâ”€ Profession System: èŒä¸šé™åˆ¶ã€èŒä¸šç‰¹æ€§
â””â”€ RNG System: ç¡®å®šæ€§éšæœºã€ç§å­ç®¡ç†
```

### 4.2 æ¨¡å—è¯¦ç»†åˆ’åˆ†

```
BlazorIdle.Server/Domain/Equipment/
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ GearDefinition.cs          # è£…å¤‡å®šä¹‰ï¼ˆé…ç½®æ•°æ®ï¼‰
â”‚   â”œâ”€â”€ GearInstance.cs            # è£…å¤‡å®ä¾‹ï¼ˆè§’è‰²æŒæœ‰ï¼‰
â”‚   â”œâ”€â”€ Affix.cs                   # è¯æ¡å®šä¹‰
â”‚   â”œâ”€â”€ AffixInstance.cs           # è¯æ¡å®ä¾‹
â”‚   â”œâ”€â”€ GearSet.cs                 # å¥—è£…å®šä¹‰
â”‚   â”œâ”€â”€ ArmorTypeConfig.cs         # æŠ¤ç”²ç±»å‹é…ç½®
â”‚   â”œâ”€â”€ WeaponTypeConfig.cs        # æ­¦å™¨ç±»å‹é…ç½®
â”‚   â”œâ”€â”€ EquipmentSlotConfig.cs     # è£…å¤‡æ§½ä½é…ç½®
â”‚   â”œâ”€â”€ ProfessionEquipmentConfig.cs # èŒä¸šè£…å¤‡é™åˆ¶
â”‚   â””â”€â”€ EquipmentSystemConfiguration.cs # ä¸»é…ç½®ç±»
â”‚
â”œâ”€â”€ Enums/
â”‚   â”œâ”€â”€ EquipmentSlot.cs           # è£…å¤‡æ§½ä½ï¼ˆ17ä¸ªï¼‰
â”‚   â”œâ”€â”€ ArmorType.cs               # æŠ¤ç”²ç±»å‹ï¼ˆ4ç§ï¼‰
â”‚   â”œâ”€â”€ WeaponType.cs              # æ­¦å™¨ç±»å‹ï¼ˆ15ç§ï¼‰
â”‚   â”œâ”€â”€ Rarity.cs                  # ç¨€æœ‰åº¦
â”‚   â”œâ”€â”€ SlotCategory.cs            # æ§½ä½åˆ†ç±»
â”‚   â””â”€â”€ ModifierType.cs            # ä¿®é¥°ç¬¦ç±»å‹
â”‚
â”œâ”€â”€ ValueObjects/
â”‚   â”œâ”€â”€ StatModifier.cs            # å±æ€§ä¿®é¥°ç¬¦
â”‚   â”œâ”€â”€ TierLevel.cs               # å“çº§ï¼ˆT1-T3ï¼‰
â”‚   â”œâ”€â”€ StatRange.cs               # å±æ€§èŒƒå›´
â”‚   â””â”€â”€ EquipmentSlotOccupancy.cs  # æ§½ä½å ç”¨
â”‚
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ GearGenerationService.cs   # è£…å¤‡ç”Ÿæˆæ ¸å¿ƒ
â”‚   â”œâ”€â”€ EquipmentService.cs        # è£…å¤‡ç®¡ç†æ ¸å¿ƒ
â”‚   â”œâ”€â”€ StatsAggregationService.cs # å±æ€§èšåˆ
â”‚   â”œâ”€â”€ DisenchantService.cs       # è£…å¤‡åˆ†è§£
â”‚   â”œâ”€â”€ ReforgeService.cs          # å“çº§é‡é“¸
â”‚   â”œâ”€â”€ AffixRerollService.cs      # è¯æ¡é‡ç½®
â”‚   â”œâ”€â”€ SetBonusService.cs         # å¥—è£…æ•ˆæœ
â”‚   â”œâ”€â”€ ArmorCalculator.cs         # æŠ¤ç”²è®¡ç®—
â”‚   â”œâ”€â”€ BlockCalculator.cs         # æ ¼æŒ¡è®¡ç®—
â”‚   â”œâ”€â”€ AttackSpeedCalculator.cs   # æ”»é€Ÿè®¡ç®—
â”‚   â”œâ”€â”€ EquipmentValidator.cs      # è£…å¤‡éªŒè¯
â”‚   â”œâ”€â”€ EquipmentConfigurationService.cs # é…ç½®åŠ è½½
â”‚   â””â”€â”€ EquipmentCacheService.cs   # ç¼“å­˜ç®¡ç†
â”‚
â”œâ”€â”€ Repositories/
â”‚   â”œâ”€â”€ IGearDefinitionRepository.cs
â”‚   â”œâ”€â”€ IGearInstanceRepository.cs
â”‚   â”œâ”€â”€ IAffixRepository.cs
â”‚   â””â”€â”€ IGearSetRepository.cs
â”‚
â””â”€â”€ Events/
    â”œâ”€â”€ EquipmentChangedEvent.cs   # è£…å¤‡å˜æ›´äº‹ä»¶
    â”œâ”€â”€ StatsRecalculatedEvent.cs  # å±æ€§é‡ç®—äº‹ä»¶
    â”œâ”€â”€ SetBonusActivatedEvent.cs  # å¥—è£…æ¿€æ´»äº‹ä»¶
    â””â”€â”€ GearEnhancedEvent.cs       # è£…å¤‡å¢å¼ºäº‹ä»¶
```

### 4.3 æ ¸å¿ƒæ•°æ®æµ

#### è£…å¤‡ç”Ÿæˆæµç¨‹
```
æ‰è½è§¦å‘ï¼ˆæˆ˜æ–—/ä»»åŠ¡ï¼‰
  â†“
EconomyCalculator é€‰æ‹©è£…å¤‡å®šä¹‰
  â†“
GearGenerationService.Generate()
  â”œâ”€ 1. ç¡®å®šç¨€æœ‰åº¦ï¼ˆåŠ æƒéšæœºï¼‰
  â”œâ”€ 2. ç¡®å®šå“çº§ï¼ˆé»˜è®¤T1ï¼‰
  â”œâ”€ 3. è®¡ç®—ç‰©å“ç­‰çº§
  â”œâ”€ 4. RollåŸºç¡€å±æ€§ï¼ˆèŒƒå›´å†…éšæœºï¼‰
  â”œâ”€ 5. ç”Ÿæˆè¯æ¡
  â”‚   â”œâ”€ æ ¹æ®ç¨€æœ‰åº¦å†³å®šæ•°é‡
  â”‚   â”œâ”€ ä»è¯æ¡æ± éšæœºé€‰æ‹©
  â”‚   â”œâ”€ Rollè¯æ¡æ•°å€¼
  â”‚   â””â”€ é˜²æ­¢é‡å¤è¯æ¡
  â”œâ”€ 6. åº”ç”¨æŠ¤ç”²/æ­¦å™¨ç±»å‹ç‰¹æ€§
  â”œâ”€ 7. è®¡ç®—è£…å¤‡è¯„åˆ†
  â””â”€ 8. åˆ›å»ºGearInstance
  â†“
RewardGrantService å†™å…¥èƒŒåŒ…
  â†“
å‰ç«¯é€šçŸ¥ï¼ˆæ‰è½æç¤ºï¼‰
```

#### è£…å¤‡è£…å¤‡æµç¨‹
```
ç©å®¶ç‚¹å‡»è£…å¤‡æŒ‰é’®
  â†“
å‰ç«¯ POST /api/equipment/{characterId}/{slot}
  â†“
EquipmentController æ¥æ”¶è¯·æ±‚
  â†“
EquipmentValidator éªŒè¯
  â”œâ”€ æ§½ä½åŒ¹é…æ£€æŸ¥
  â”œâ”€ ç­‰çº§éœ€æ±‚æ£€æŸ¥
  â”œâ”€ èŒä¸šé™åˆ¶æ£€æŸ¥
  â”œâ”€ åŒæ‰‹æ­¦å™¨å ç”¨æ£€æŸ¥
  â””â”€ èƒŒåŒ…æ˜¯å¦æ‹¥æœ‰æ£€æŸ¥
  â†“
EquipmentService.EquipItem()
  â”œâ”€ å¸ä¸‹æ—§è£…å¤‡ï¼ˆå¦‚æœ‰ï¼‰
  â”œâ”€ è£…å¤‡æ–°è£…å¤‡
  â”œâ”€ æ›´æ–°GearInstanceçŠ¶æ€
  â””â”€ è§¦å‘ EquipmentChangedEvent
  â†“
StatsAggregationService é‡ç®—å±æ€§
  â”œâ”€ èšåˆæ‰€æœ‰è£…å¤‡å±æ€§
  â”œâ”€ åº”ç”¨å¥—è£…åŠ æˆ
  â”œâ”€ è®¡ç®—æŠ¤ç”²å‡ä¼¤
  â”œâ”€ è®¡ç®—æ ¼æŒ¡
  â””â”€ æ›´æ–°CharacterStats
  â†“
è¿”å›å‰ç«¯ï¼ˆæ–°è£…å¤‡æ  + æ–°å±æ€§ï¼‰
  â†“
å‰ç«¯æ›´æ–°UIï¼ˆè£…å¤‡æ  + å±æ€§é¢æ¿ï¼‰
```

#### æˆ˜æ–—å±æ€§æ³¨å…¥æµç¨‹
```
æˆ˜æ–—å¼€å§‹
  â†“
StatsBuilder.BuildStats(character)
  â”œâ”€ è·å–åŸºç¡€èŒä¸šå±æ€§
  â”œâ”€ æ³¨å…¥è£…å¤‡å±æ€§ï¼ˆè°ƒç”¨StatsAggregationServiceï¼‰
  â”‚   â”œâ”€ åŸºç¡€å±æ€§ï¼ˆæ”»å‡»/ç”Ÿå‘½/æŠ¤ç”²ï¼‰
  â”‚   â”œâ”€ è¯æ¡å±æ€§ï¼ˆæš´å‡»/æ€¥é€Ÿ/ç©¿é€ï¼‰
  â”‚   â”œâ”€ å¥—è£…åŠ æˆ
  â”‚   â””â”€ æŠ¤ç”²å‡ä¼¤ç³»æ•°
  â”œâ”€ åº”ç”¨Buffä¿®é¥°
  â””â”€ è¿”å›æœ€ç»ˆCharacterStats
  â†“
BattleEngine ä½¿ç”¨æœ€ç»ˆå±æ€§è¿›è¡Œæˆ˜æ–—
  â”œâ”€ æ”»å‡»é€Ÿåº¦æ¥è‡ªæ­¦å™¨ç±»å‹
  â”œâ”€ ä¼¤å®³å‡å…åº”ç”¨æŠ¤ç”²å…¬å¼
  â”œâ”€ æ ¼æŒ¡åˆ¤å®šï¼ˆå¦‚æœ‰ç›¾ç‰Œï¼‰
  â””â”€ å¥—è£…ç‰¹æ•ˆè§¦å‘
```

---

## 5. æ•°æ®æ¨¡å‹å®Œæ•´è®¾è®¡

### 5.1 æ ¸å¿ƒå®ä½“æ¨¡å‹

#### GearDefinition (è£…å¤‡å®šä¹‰ - é…ç½®æ•°æ®)

```csharp
/// <summary>
/// è£…å¤‡å®šä¹‰ - é…ç½®æ•°æ®ï¼Œå®šä¹‰è£…å¤‡çš„åŸºç¡€æ¨¡æ¿
/// </summary>
public class GearDefinition
{
    /// <summary>è£…å¤‡å®šä¹‰IDï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰</summary>
    public string Id { get; set; } // ä¾‹å¦‚: "sword_iron", "helmet_steel"
    
    /// <summary>æ˜¾ç¤ºåç§°</summary>
    public string Name { get; set; } // ä¾‹å¦‚: "é“å‰‘", "é’¢é“å¤´ç›”"
    
    /// <summary>å›¾æ ‡</summary>
    public string Icon { get; set; } // Emoji æˆ–å›¾æ ‡è·¯å¾„
    
    /// <summary>è£…å¤‡æ§½ä½</summary>
    public EquipmentSlot Slot { get; set; }
    
    /// <summary>éœ€æ±‚ç­‰çº§</summary>
    public int RequiredLevel { get; set; } = 1;
    
    /// <summary>åŸºç¡€å±æ€§èŒƒå›´ï¼ˆJSONï¼‰</summary>
    /// <example>{"AttackPower": {"Min": 10, "Max": 15}, "Health": {"Min": 50, "Max": 100}}</example>
    public string BaseStatsJson { get; set; }
    
    /// <summary>å…è®¸çš„è¯æ¡æ± ï¼ˆJSONï¼‰</summary>
    /// <example>["affix_strength", "affix_crit", "affix_haste"]</example>
    public string AllowedAffixPoolJson { get; set; }
    
    /// <summary>ç¨€æœ‰åº¦æƒé‡ï¼ˆJSONï¼‰</summary>
    /// <example>{"Common": 0.6, "Rare": 0.3, "Epic": 0.08, "Legendary": 0.02}</example>
    public string RarityWeightsJson { get; set; }
    
    /// <summary>å¥—è£…IDï¼ˆå¯é€‰ï¼‰</summary>
    public string? SetId { get; set; }
    
    // ===== æ–°å¢ï¼šæŠ¤ç”²å’Œæ­¦å™¨å±æ€§ =====
    
    /// <summary>æŠ¤ç”²ç±»å‹</summary>
    public ArmorType ArmorType { get; set; } = ArmorType.None;
    
    /// <summary>æ­¦å™¨ç±»å‹</summary>
    public WeaponType WeaponType { get; set; } = WeaponType.None;
    
    /// <summary>åŸºç¡€æŠ¤ç”²å€¼ï¼ˆä»…é˜²å…·ï¼‰</summary>
    public double BaseArmor { get; set; } = 0;
    
    /// <summary>åŸºç¡€æ”»å‡»é€Ÿåº¦ï¼ˆä»…æ­¦å™¨ï¼Œç§’/æ¬¡ï¼‰</summary>
    public double BaseAttackSpeed { get; set; } = 0;
    
    /// <summary>æ”»å‡»å€ç‡ï¼ˆä»…æ­¦å™¨ï¼‰</summary>
    public double AttackPowerMultiplier { get; set; } = 1.0;
    
    /// <summary>æ ¼æŒ¡æ¦‚ç‡ï¼ˆä»…ç›¾ç‰Œï¼‰</summary>
    public double BlockChance { get; set; } = 0;
    
    /// <summary>æ ¼æŒ¡å‡ä¼¤ï¼ˆä»…ç›¾ç‰Œï¼‰</summary>
    public double BlockReduction { get; set; } = 0;
    
    /// <summary>èŒä¸šé™åˆ¶ï¼ˆJSONæ•°ç»„ï¼‰</summary>
    /// <example>["Warrior", "Paladin"] - ä»…æˆ˜å£«å’Œåœ£éª‘å£«å¯è£…å¤‡</example>
    public string? AllowedProfessionsJson { get; set; }
    
    /// <summary>æ˜¯å¦åŒæ‰‹æ­¦å™¨</summary>
    public bool IsTwoHanded { get; set; } = false;
}
```

#### GearInstance (è£…å¤‡å®ä¾‹ - è¿è¡Œæ—¶æ•°æ®)

```csharp
/// <summary>
/// è£…å¤‡å®ä¾‹ - ç©å®¶å®é™…æŒæœ‰çš„è£…å¤‡ï¼ŒåŒ…å«éšæœºç”Ÿæˆçš„å±æ€§
/// </summary>
public class GearInstance
{
    /// <summary>å®ä¾‹ID</summary>
    public Guid Id { get; set; }
    
    /// <summary>å…³è”çš„è£…å¤‡å®šä¹‰ID</summary>
    public string DefinitionId { get; set; }
    
    /// <summary>æ‰€å±è§’è‰²ID</summary>
    public Guid CharacterId { get; set; }
    
    /// <summary>ç¨€æœ‰åº¦ï¼ˆç”Ÿæˆæ—¶ç¡®å®šï¼‰</summary>
    public Rarity Rarity { get; set; }
    
    /// <summary>å“çº§ï¼ˆT1-T3ï¼Œå¯é‡é“¸æå‡ï¼‰</summary>
    public int Tier { get; set; } = 1;
    
    /// <summary>ç‰©å“ç­‰çº§ï¼ˆå½±å“å±æ€§æ•°å€¼ï¼‰</summary>
    public int ItemLevel { get; set; }
    
    /// <summary>å®é™…å±æ€§ï¼ˆJSONï¼‰- Rollåçš„åŸºç¡€å±æ€§</summary>
    /// <example>{"AttackPower": 12, "Health": 75}</example>
    public string RolledStatsJson { get; set; }
    
    /// <summary>è¯æ¡å®ä¾‹åˆ—è¡¨ï¼ˆJSONï¼‰</summary>
    /// <example>[{"AffixId": "affix_strength", "Value": 10}, ...]</example>
    public string AffixInstancesJson { get; set; }
    
    /// <summary>è£…å¤‡è¯„åˆ†ï¼ˆç»¼åˆè¯„ä»·ï¼‰</summary>
    public int QualityScore { get; set; }
    
    /// <summary>æ˜¯å¦å·²è£…å¤‡</summary>
    public bool IsEquipped { get; set; } = false;
    
    /// <summary>å½“å‰æ§½ä½ï¼ˆå¦‚å·²è£…å¤‡ï¼‰</summary>
    public EquipmentSlot? CurrentSlot { get; set; }
    
    /// <summary>æ˜¯å¦ç»‘å®š</summary>
    public bool IsBound { get; set; } = false;
    
    /// <summary>åˆ›å»ºæ—¶é—´</summary>
    public DateTime CreatedAt { get; set; }
    
    /// <summary>æœ€åæ›´æ–°æ—¶é—´</summary>
    public DateTime UpdatedAt { get; set; }
    
    // ===== å¯¼èˆªå±æ€§ =====
    public GearDefinition Definition { get; set; }
    public Character Character { get; set; }
}
```

#### Affix (è¯æ¡å®šä¹‰ - é…ç½®æ•°æ®)

```csharp
/// <summary>
/// è¯æ¡å®šä¹‰ - é…ç½®æ•°æ®ï¼Œå®šä¹‰å¯èƒ½å‡ºç°çš„è¯æ¡ç±»å‹
/// </summary>
public class Affix
{
    /// <summary>è¯æ¡ID</summary>
    public string Id { get; set; } // ä¾‹å¦‚: "affix_strength", "affix_crit"
    
    /// <summary>æ˜¾ç¤ºåç§°æ¨¡æ¿</summary>
    /// <example>"+{value} åŠ›é‡", "+{value}% æš´å‡»"</example>
    public string NameTemplate { get; set; }
    
    /// <summary>å½±å“çš„å±æ€§ç±»å‹</summary>
    public string StatType { get; set; } // "AttackPower", "CritChance", etc.
    
    /// <summary>ä¿®é¥°ç¬¦ç±»å‹</summary>
    public ModifierType ModifierType { get; set; } // Additive / Multiplicative / FinalAdd
    
    /// <summary>æ•°å€¼èŒƒå›´æœ€å°å€¼</summary>
    public double MinValue { get; set; }
    
    /// <summary>æ•°å€¼èŒƒå›´æœ€å¤§å€¼</summary>
    public double MaxValue { get; set; }
    
    /// <summary>è¯æ¡å“è´¨ï¼ˆå½±å“å‡ºç°æ¦‚ç‡ï¼‰</summary>
    public int AffixTier { get; set; } = 1;
    
    /// <summary>æƒé‡ï¼ˆRollæ¦‚ç‡ï¼‰</summary>
    public double Weight { get; set; } = 1.0;
}
```

#### GearSet (å¥—è£…å®šä¹‰ - é…ç½®æ•°æ®)

```csharp
/// <summary>
/// å¥—è£…å®šä¹‰ - é…ç½®æ•°æ®ï¼Œå®šä¹‰å¥—è£…æ•ˆæœ
/// </summary>
public class GearSet
{
    /// <summary>å¥—è£…ID</summary>
    public string Id { get; set; } // ä¾‹å¦‚: "set_warrior_tier1"
    
    /// <summary>å¥—è£…åç§°</summary>
    public string Name { get; set; } // ä¾‹å¦‚: "ç‹‚æˆ˜å£«å¥—è£…"
    
    /// <summary>å¥—è£…æè¿°</summary>
    public string Description { get; set; }
    
    /// <summary>å¥—è£…ä»¶æ•°è¦æ±‚ä¸æ•ˆæœï¼ˆJSONï¼‰</summary>
    /// <example>
    /// {
    ///   "2": {"AttackPower": 10},
    ///   "4": {"AttackPower": 20, "CritChance": 0.05},
    ///   "6": {"AttackPower": 30, "CritChance": 0.10, "SpecialEffect": "berserk"}
    /// }
    /// </example>
    public string BonusesJson { get; set; }
    
    /// <summary>å¥—è£…å›¾æ ‡</summary>
    public string Icon { get; set; }
}
```

### 5.2 æšä¸¾å®šä¹‰

#### EquipmentSlot (17ä¸ªè£…å¤‡æ§½ä½)

```csharp
/// <summary>
/// è£…å¤‡æ§½ä½æšä¸¾ - å®Œæ•´17æ§½ä½ç³»ç»Ÿ
/// </summary>
public enum EquipmentSlot
{
    // ===== é˜²å…·æ§½ä½ (10ä¸ª) =====
    Head,           // å¤´éƒ¨ - å¤´ç›”
    Neck,           // é¢ˆéƒ¨ - é¡¹é“¾
    Shoulder,       // è‚©éƒ¨ - è‚©ç”²
    Back,           // èƒŒéƒ¨ - æŠ«é£
    Chest,          // èƒ¸éƒ¨ - èƒ¸ç”²
    Wrist,          // æ‰‹è…• - æŠ¤è…•
    Hands,          // æ‰‹éƒ¨ - æ‰‹å¥—
    Waist,          // è…°éƒ¨ - è…°å¸¦
    Legs,           // è…¿éƒ¨ - è…¿ç”²
    Feet,           // è„šéƒ¨ - é‹å­
    
    // ===== é¥°å“æ§½ä½ (4ä¸ª) =====
    Finger1,        // ç¬¬ä¸€ä¸ªæˆ’æŒ‡
    Finger2,        // ç¬¬äºŒä¸ªæˆ’æŒ‡
    Trinket1,       // ç¬¬ä¸€ä¸ªé¥°å“
    Trinket2,       // ç¬¬äºŒä¸ªé¥°å“
    
    // ===== æ­¦å™¨æ§½ä½ (3ä¸ª) =====
    MainHand,       // ä¸»æ‰‹æ­¦å™¨
    OffHand,        // å‰¯æ‰‹æ­¦å™¨/ç›¾ç‰Œ
    TwoHand         // åŒæ‰‹æ­¦å™¨ï¼ˆå ç”¨MainHand+OffHandï¼‰
}
```

#### ArmorType (æŠ¤ç”²ç±»å‹)

```csharp
/// <summary>
/// æŠ¤ç”²ç±»å‹ - å½±å“æŠ¤ç”²å€¼å’ŒèŒä¸šé™åˆ¶
/// </summary>
public enum ArmorType
{
    None,       // æ— ç±»å‹ï¼ˆé¥°å“ã€æŠ«é£ç­‰ï¼‰
    Cloth,      // å¸ƒç”² - æ³•ç³»èŒä¸š
    Leather,    // çš®ç”² - æ•æ·èŒä¸š
    Mail,       // é”ç”² - æ··åˆèŒä¸š
    Plate       // æ¿ç”² - åŠ›é‡èŒä¸š
}
```

#### WeaponType (æ­¦å™¨ç±»å‹)

```csharp
/// <summary>
/// æ­¦å™¨ç±»å‹ - å½±å“æ”»å‡»é€Ÿåº¦å’ŒèŒä¸šé™åˆ¶
/// </summary>
public enum WeaponType
{
    None,           // æ— ç±»å‹
    
    // å•æ‰‹æ­¦å™¨
    Sword,          // å‰‘ - é€Ÿåº¦ï¼šä¸­ç­‰
    Dagger,         // åŒ•é¦– - é€Ÿåº¦ï¼šå¿«
    Axe,            // æ–§ - é€Ÿåº¦ï¼šä¸­ç­‰
    Mace,           // é”¤ - é€Ÿåº¦ï¼šæ…¢
    Fist,           // æ‹³å¥— - é€Ÿåº¦ï¼šå¾ˆå¿«
    Wand,           // é­”æ– - é€Ÿåº¦ï¼šå¾ˆå¿«ï¼ˆæ³•ç³»ï¼‰
    
    // åŒæ‰‹æ­¦å™¨
    TwoHandSword,   // åŒæ‰‹å‰‘ - é€Ÿåº¦ï¼šæ…¢
    TwoHandAxe,     // åŒæ‰‹æ–§ - é€Ÿåº¦ï¼šå¾ˆæ…¢
    TwoHandMace,    // åŒæ‰‹é”¤ - é€Ÿåº¦ï¼šå¾ˆæ…¢
    Staff,          // æ³•æ– - é€Ÿåº¦ï¼šæ…¢ï¼ˆæ³•ç³»ï¼‰
    Polearm,        // é•¿æŸ„æ­¦å™¨ - é€Ÿåº¦ï¼šæ…¢
    
    // è¿œç¨‹æ­¦å™¨
    Bow,            // å¼“ - é€Ÿåº¦ï¼šä¸­ç­‰
    Crossbow,       // å¼© - é€Ÿåº¦ï¼šæ…¢
    Gun,            // æª - é€Ÿåº¦ï¼šå¿«
    
    // å‰¯æ‰‹ä¸“ç”¨
    Shield          // ç›¾ç‰Œ - æä¾›æ ¼æŒ¡
}
```

### 5.3 é…ç½®ç±»æ¨¡å‹

#### ArmorTypeConfig

```csharp
/// <summary>
/// æŠ¤ç”²ç±»å‹é…ç½®
/// </summary>
public class ArmorTypeConfig
{
    public ArmorType Type { get; set; }
    public string TypeId { get; set; }
    public string DisplayName { get; set; }
    
    /// <summary>åŸºç¡€æŠ¤ç”²å€ç‡</summary>
    public double BaseArmorMultiplier { get; set; }
    
    /// <summary>è€åŠ›åŠ æˆå€ç‡</summary>
    public double StaminaMultiplier { get; set; }
    
    /// <summary>æ¬¡çº§å±æ€§æƒé‡</summary>
    public Dictionary<string, double> SecondaryStatWeights { get; set; }
    
    /// <summary>å¯è£…å¤‡çš„æ§½ä½</summary>
    public List<EquipmentSlot> ApplicableSlots { get; set; }
}
```

#### WeaponTypeConfig

```csharp
/// <summary>
/// æ­¦å™¨ç±»å‹é…ç½®
/// </summary>
public class WeaponTypeConfig
{
    public WeaponType Type { get; set; }
    public string TypeId { get; set; }
    public string DisplayName { get; set; }
    
    /// <summary>åŸºç¡€æ”»å‡»é€Ÿåº¦ï¼ˆç§’/æ¬¡ï¼‰</summary>
    public double BaseAttackSpeed { get; set; }
    
    /// <summary>æ”»å‡»å€ç‡</summary>
    public double AttackPowerMultiplier { get; set; }
    
    /// <summary>å…è®¸çš„æ§½ä½</summary>
    public List<EquipmentSlot> AllowedSlots { get; set; }
    
    /// <summary>ä¼¤å®³ç±»å‹å€¾å‘</summary>
    public string DamageTypeBias { get; set; } // "Physical", "Magical"
    
    /// <summary>æ˜¯å¦åŒæ‰‹æ­¦å™¨</summary>
    public bool IsTwoHanded { get; set; }
}
```

#### ProfessionEquipmentConfig

```csharp
/// <summary>
/// èŒä¸šè£…å¤‡é™åˆ¶é…ç½®
/// </summary>
public class ProfessionEquipmentConfig
{
    public string ProfessionId { get; set; } // "Warrior", "Mage", etc.
    public List<ArmorType> AllowedArmorTypes { get; set; }
    public List<WeaponType> AllowedWeaponTypes { get; set; }
    public bool CanDualWield { get; set; } // æ˜¯å¦å¯åŒæŒ
    public bool CanUseShields { get; set; } // æ˜¯å¦å¯ç”¨ç›¾ç‰Œ
}
```

### 5.4 æ•°æ®åº“è¡¨ç»“æ„

#### GearDefinitions è¡¨

```sql
CREATE TABLE gear_definitions (
    id VARCHAR(100) PRIMARY KEY,
    name VARCHAR(200) NOT NULL,
    icon VARCHAR(50),
    slot VARCHAR(50) NOT NULL,
    required_level INT NOT NULL DEFAULT 1,
    base_stats_json TEXT,
    allowed_affix_pool_json TEXT,
    rarity_weights_json TEXT,
    set_id VARCHAR(100),
    
    -- æ–°å¢å­—æ®µ
    armor_type VARCHAR(50) NOT NULL DEFAULT 'None',
    weapon_type VARCHAR(50) NOT NULL DEFAULT 'None',
    base_armor DOUBLE PRECISION DEFAULT 0,
    base_attack_speed DOUBLE PRECISION DEFAULT 0,
    attack_power_multiplier DOUBLE PRECISION DEFAULT 1.0,
    block_chance DOUBLE PRECISION DEFAULT 0,
    block_reduction DOUBLE PRECISION DEFAULT 0,
    allowed_professions_json TEXT,
    is_two_handed BOOLEAN DEFAULT FALSE,
    
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_gear_def_slot ON gear_definitions(slot);
CREATE INDEX idx_gear_def_armor_type ON gear_definitions(armor_type);
CREATE INDEX idx_gear_def_weapon_type ON gear_definitions(weapon_type);
```

#### GearInstances è¡¨

```sql
CREATE TABLE gear_instances (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    definition_id VARCHAR(100) NOT NULL REFERENCES gear_definitions(id),
    character_id UUID NOT NULL REFERENCES characters(id) ON DELETE CASCADE,
    rarity VARCHAR(50) NOT NULL,
    tier INT NOT NULL DEFAULT 1,
    item_level INT NOT NULL,
    rolled_stats_json TEXT NOT NULL,
    affix_instances_json TEXT,
    quality_score INT NOT NULL,
    is_equipped BOOLEAN DEFAULT FALSE,
    current_slot VARCHAR(50),
    is_bound BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_gear_inst_char ON gear_instances(character_id);
CREATE INDEX idx_gear_inst_def ON gear_instances(definition_id);
CREATE INDEX idx_gear_inst_equipped ON gear_instances(character_id, is_equipped);
CREATE INDEX idx_gear_inst_slot ON gear_instances(character_id, current_slot) WHERE is_equipped = TRUE;
```

#### AffixDefinitions è¡¨

```sql
CREATE TABLE affix_definitions (
    id VARCHAR(100) PRIMARY KEY,
    name_template VARCHAR(200) NOT NULL,
    stat_type VARCHAR(50) NOT NULL,
    modifier_type VARCHAR(50) NOT NULL,
    min_value DOUBLE PRECISION NOT NULL,
    max_value DOUBLE PRECISION NOT NULL,
    affix_tier INT NOT NULL DEFAULT 1,
    weight DOUBLE PRECISION NOT NULL DEFAULT 1.0,
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_affix_stat_type ON affix_definitions(stat_type);
CREATE INDEX idx_affix_tier ON affix_definitions(affix_tier);
```

#### GearSets è¡¨

```sql
CREATE TABLE gear_sets (
    id VARCHAR(100) PRIMARY KEY,
    name VARCHAR(200) NOT NULL,
    description TEXT,
    bonuses_json TEXT NOT NULL,
    icon VARCHAR(50),
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);
```

---

## Phase 1: æ•°æ®åº“ä¸é¢†åŸŸæ¨¡å‹åŸºç¡€ (ç¬¬1-2å‘¨)

### é˜¶æ®µç›®æ ‡

å»ºç«‹è£…å¤‡ç³»ç»Ÿçš„æ•°æ®åŸºç¡€å’Œé¢†åŸŸæ¨¡å‹ï¼ŒåŒ…æ‹¬æ•°æ®åº“è¡¨ã€å®ä½“ç±»ã€é…ç½®ç±»å’Œç§å­æ•°æ®ã€‚

### è¯¦ç»†ä»»åŠ¡æ¸…å•

#### Task 1.1: åˆ›å»ºæšä¸¾å’ŒåŸºç¡€ç±»å‹ âœ…

**ä¼˜å…ˆçº§**: ğŸ”´ é«˜  
**é¢„è®¡æ—¶é—´**: 2å°æ—¶  
**ä¾èµ–**: æ— 

**å®æ–½æ­¥éª¤**:

1. åˆ›å»º `BlazorIdle.Server/Domain/Equipment/Enums/` ç›®å½•

2. åˆ›å»º `EquipmentSlot.cs` (17ä¸ªæ§½ä½)
```csharp
namespace BlazorIdle.Server.Domain.Equipment.Enums;

/// <summary>è£…å¤‡æ§½ä½æšä¸¾ - å®Œæ•´17æ§½ä½ç³»ç»Ÿ</summary>
public enum EquipmentSlot
{
    // é˜²å…·æ§½ä½ (10ä¸ª)
    Head, Neck, Shoulder, Back, Chest,
    Wrist, Hands, Waist, Legs, Feet,
    
    // é¥°å“æ§½ä½ (4ä¸ª)
    Finger1, Finger2, Trinket1, Trinket2,
    
    // æ­¦å™¨æ§½ä½ (3ä¸ª)
    MainHand, OffHand, TwoHand
}
```

3. åˆ›å»º `ArmorType.cs`
```csharp
/// <summary>æŠ¤ç”²ç±»å‹</summary>
public enum ArmorType
{
    None, Cloth, Leather, Mail, Plate
}
```

4. åˆ›å»º `WeaponType.cs` (15ç§æ­¦å™¨)
```csharp
/// <summary>æ­¦å™¨ç±»å‹</summary>
public enum WeaponType
{
    None,
    // å•æ‰‹
    Sword, Dagger, Axe, Mace, Fist, Wand,
    // åŒæ‰‹
    TwoHandSword, TwoHandAxe, TwoHandMace, Staff, Polearm,
    // è¿œç¨‹
    Bow, Crossbow, Gun,
    // å‰¯æ‰‹ä¸“ç”¨
    Shield
}
```

5. åˆ›å»º `Rarity.cs`
```csharp
/// <summary>ç¨€æœ‰åº¦</summary>
public enum Rarity
{
    Common,     // æ™®é€š - ç™½è‰²
    Rare,       // ç¨€æœ‰ - è“è‰²
    Epic,       // å²è¯— - ç´«è‰²
    Legendary   // ä¼ è¯´ - æ©™è‰²
}
```

6. åˆ›å»º `ModifierType.cs`
```csharp
/// <summary>ä¿®é¥°ç¬¦ç±»å‹</summary>
public enum ModifierType
{
    Additive,       // åŠ æ³•
    Multiplicative, // ä¹˜æ³•
    FinalAdd        // æœ€ç»ˆåŠ æ³•
}
```

7. åˆ›å»º `SlotCategory.cs`
```csharp
/// <summary>æ§½ä½åˆ†ç±»</summary>
public enum SlotCategory
{
    Armor,    // é˜²å…·
    Jewelry,  // é¥°å“
    Weapon    // æ­¦å™¨
}
```

**å‰ç«¯éªŒè¯ç‚¹**: æ— ï¼ˆçº¯åç«¯æšä¸¾ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰æšä¸¾å®šä¹‰å®Œæ•´
- âœ… ä½¿ç”¨ XML æ–‡æ¡£æ³¨é‡Š
- âœ… ç¼–è¯‘é€šè¿‡æ— è­¦å‘Š

---

#### Task 1.2: åˆ›å»ºé…ç½®ç±» âœ…

**ä¼˜å…ˆçº§**: ğŸ”´ é«˜  
**é¢„è®¡æ—¶é—´**: 4å°æ—¶  
**ä¾èµ–**: Task 1.1

**å®æ–½æ­¥éª¤**:

1. åˆ›å»º `BlazorIdle.Server/Domain/Equipment/Models/` ç›®å½•

2. åˆ›å»º `ArmorTypeConfig.cs`
```csharp
namespace BlazorIdle.Server.Domain.Equipment.Models;

/// <summary>æŠ¤ç”²ç±»å‹é…ç½®</summary>
public class ArmorTypeConfig
{
    public ArmorType Type { get; set; }
    public string TypeId { get; set; }
    public string DisplayName { get; set; }
    public double BaseArmorMultiplier { get; set; }
    public double StaminaMultiplier { get; set; }
    public Dictionary<string, double> SecondaryStatWeights { get; set; } = new();
    public List<EquipmentSlot> ApplicableSlots { get; set; } = new();
}
```

3. åˆ›å»º `WeaponTypeConfig.cs`
```csharp
/// <summary>æ­¦å™¨ç±»å‹é…ç½®</summary>
public class WeaponTypeConfig
{
    public WeaponType Type { get; set; }
    public string TypeId { get; set; }
    public string DisplayName { get; set; }
    public double BaseAttackSpeed { get; set; }
    public double AttackPowerMultiplier { get; set; }
    public List<EquipmentSlot> AllowedSlots { get; set; } = new();
    public string DamageTypeBias { get; set; } = "Physical";
    public bool IsTwoHanded { get; set; }
}
```

4. åˆ›å»º `EquipmentSlotConfig.cs`
```csharp
/// <summary>è£…å¤‡æ§½ä½é…ç½®</summary>
public class EquipmentSlotConfig
{
    public EquipmentSlot Slot { get; set; }
    public string SlotId { get; set; }
    public string DisplayName { get; set; }
    public string Icon { get; set; }
    public SlotCategory Category { get; set; }
    public bool AllowsArmorType { get; set; }
    public bool RequiresWeaponType { get; set; }
}
```

5. åˆ›å»º `ProfessionEquipmentConfig.cs`
```csharp
/// <summary>èŒä¸šè£…å¤‡é™åˆ¶é…ç½®</summary>
public class ProfessionEquipmentConfig
{
    public string ProfessionId { get; set; }
    public List<ArmorType> AllowedArmorTypes { get; set; } = new();
    public List<WeaponType> AllowedWeaponTypes { get; set; } = new();
    public bool CanDualWield { get; set; }
    public bool CanUseShields { get; set; }
}
```

6. åˆ›å»º `EquipmentSystemConfiguration.cs` (ä¸»é…ç½®ç±»)
```csharp
/// <summary>è£…å¤‡ç³»ç»Ÿä¸»é…ç½®ç±»</summary>
public class EquipmentSystemConfiguration
{
    public List<ArmorTypeConfig> ArmorTypes { get; set; } = new();
    public List<WeaponTypeConfig> WeaponTypes { get; set; } = new();
    public List<EquipmentSlotConfig> Slots { get; set; } = new();
    public List<ProfessionEquipmentConfig> ProfessionRestrictions { get; set; } = new();
    
    // æˆ˜æ–—æœºåˆ¶é…ç½®
    public double ArmorDamageReductionBase { get; set; } = 0.06;
    public double MaxArmorDamageReduction { get; set; } = 0.75;
    public double DefaultBlockReduction { get; set; } = 0.30;
}
```

**å‰ç«¯éªŒè¯ç‚¹**: æ— ï¼ˆçº¯åç«¯é…ç½®ç±»ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- âœ… æ‰€æœ‰é…ç½®ç±»å®šä¹‰å®Œæ•´
- âœ… ä½¿ç”¨ XML æ–‡æ¡£æ³¨é‡Š
- âœ… æä¾›åˆç†çš„é»˜è®¤å€¼
- âœ… æ”¯æŒ JSON åºåˆ—åŒ–/ååºåˆ—åŒ–

---

#### Task 1.3: åˆ›å»ºJSONé…ç½®æ–‡ä»¶ âœ…

**ä¼˜å…ˆçº§**: ğŸ”´ é«˜  
**é¢„è®¡æ—¶é—´**: 3å°æ—¶  
**ä¾èµ–**: Task 1.2

**å®æ–½æ­¥éª¤**:

1. åˆ›å»º `BlazorIdle.Server/Configuration/EquipmentSystemConfig.json`

2. å®šä¹‰æŠ¤ç”²ç±»å‹é…ç½®
```json
{
  "ArmorTypes": [
    {
      "Type": "Cloth",
      "TypeId": "cloth",
      "DisplayName": "å¸ƒç”²",
      "BaseArmorMultiplier": 0.5,
      "StaminaMultiplier": 0.8,
      "SecondaryStatWeights": {
        "Intellect": 1.5,
        "SpellPower": 1.2
      },
      "ApplicableSlots": ["Head", "Shoulder", "Chest", "Wrist", "Hands", "Waist", "Legs", "Feet"]
    },
    {
      "Type": "Leather",
      "TypeId": "leather",
      "DisplayName": "çš®ç”²",
      "BaseArmorMultiplier": 1.0,
      "StaminaMultiplier": 1.0,
      "SecondaryStatWeights": {
        "Agility": 1.5,
        "Dodge": 0.03
      },
      "ApplicableSlots": ["Head", "Shoulder", "Chest", "Wrist", "Hands", "Waist", "Legs", "Feet"]
    },
    {
      "Type": "Mail",
      "TypeId": "mail",
      "DisplayName": "é”ç”²",
      "BaseArmorMultiplier": 1.5,
      "StaminaMultiplier": 1.2,
      "SecondaryStatWeights": {
        "Agility": 1.0,
        "Intellect": 1.0
      },
      "ApplicableSlots": ["Head", "Shoulder", "Chest", "Wrist", "Hands", "Waist", "Legs", "Feet"]
    },
    {
      "Type": "Plate",
      "TypeId": "plate",
      "DisplayName": "æ¿ç”²",
      "BaseArmorMultiplier": 2.0,
      "StaminaMultiplier": 1.5,
      "SecondaryStatWeights": {
        "Strength": 1.5,
        "Stamina": 1.2
      },
      "ApplicableSlots": ["Head", "Shoulder", "Chest", "Wrist", "Hands", "Waist", "Legs", "Feet"]
    }
  ],
  
  "WeaponTypes": [
    {
      "Type": "Sword",
      "TypeId": "sword",
      "DisplayName": "å‰‘",
      "BaseAttackSpeed": 2.0,
      "AttackPowerMultiplier": 1.0,
      "AllowedSlots": ["MainHand", "OffHand"],
      "DamageTypeBias": "Physical",
      "IsTwoHanded": false
    },
    {
      "Type": "Dagger",
      "TypeId": "dagger",
      "DisplayName": "åŒ•é¦–",
      "BaseAttackSpeed": 1.5,
      "AttackPowerMultiplier": 0.8,
      "AllowedSlots": ["MainHand", "OffHand"],
      "DamageTypeBias": "Physical",
      "IsTwoHanded": false
    },
    {
      "Type": "TwoHandSword",
      "TypeId": "two_hand_sword",
      "DisplayName": "åŒæ‰‹å‰‘",
      "BaseAttackSpeed": 3.0,
      "AttackPowerMultiplier": 2.0,
      "AllowedSlots": ["TwoHand"],
      "DamageTypeBias": "Physical",
      "IsTwoHanded": true
    },
    {
      "Type": "Shield",
      "TypeId": "shield",
      "DisplayName": "ç›¾ç‰Œ",
      "BaseAttackSpeed": 0,
      "AttackPowerMultiplier": 0,
      "AllowedSlots": ["OffHand"],
      "DamageTypeBias": "Physical",
      "IsTwoHanded": false
    }
    // ... å…¶ä»–æ­¦å™¨ç±»å‹
  ],
  
  "ProfessionRestrictions": [
    {
      "ProfessionId": "Warrior",
      "AllowedArmorTypes": ["Leather", "Mail", "Plate"],
      "AllowedWeaponTypes": ["Sword", "Axe", "Mace", "TwoHandSword", "TwoHandAxe", "TwoHandMace", "Polearm", "Shield"],
      "CanDualWield": true,
      "CanUseShields": true
    },
    {
      "ProfessionId": "Mage",
      "AllowedArmorTypes": ["Cloth"],
      "AllowedWeaponTypes": ["Staff", "Wand"],
      "CanDualWield": false,
      "CanUseShields": false
    }
    // ... å…¶ä»–èŒä¸š
  ]
}
```

3. æ›´æ–° `appsettings.json` æ·»åŠ é…ç½®è·¯å¾„
```json
{
  "EquipmentSystem": {
    "ConfigurationFile": "Configuration/EquipmentSystemConfig.json"
  }
}
```

**å‰ç«¯éªŒè¯ç‚¹**: æ— ï¼ˆçº¯é…ç½®æ–‡ä»¶ï¼‰

**éªŒæ”¶æ ‡å‡†**:
- âœ… JSONæ ¼å¼æ­£ç¡®ï¼Œå¯æ­£å¸¸è§£æ
- âœ… æ‰€æœ‰æŠ¤ç”²ç±»å‹é…ç½®å®Œæ•´
- âœ… æ‰€æœ‰æ­¦å™¨ç±»å‹é…ç½®å®Œæ•´ï¼ˆè‡³å°‘5ç§ï¼‰
- âœ… æ‰€æœ‰èŒä¸šé™åˆ¶é…ç½®å®Œæ•´ï¼ˆè‡³å°‘2ä¸ªèŒä¸šï¼‰

---

*(ç»§ç»­åç»­Task...ç”±äºç¯‡å¹…é™åˆ¶ï¼Œå®Œæ•´çš„Phase 1-3å†…å®¹å°†åœ¨æ–‡æ¡£ä¸­ç»§ç»­)*

### Phase 1 éªŒæ”¶æ€»ç»“

**å®Œæˆæ ‡å‡†**:
- âœ… æ‰€æœ‰æšä¸¾ã€é…ç½®ç±»ã€æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ
- âœ… ç§å­æ•°æ®æ­£ç¡®åŠ è½½
- âœ… é…ç½®æœåŠ¡å¯æ­£å¸¸åŠ è½½JSONé…ç½®
- âœ… å•å…ƒæµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%
- âœ… æ•°æ®åº“è¿ç§»æˆåŠŸæ‰§è¡Œ

**å‰ç«¯éªŒè¯**:
- æš‚æ— ï¼ˆPhase 1çº¯åç«¯åŸºç¡€è®¾æ–½ï¼‰

**ä¸‹ä¸€æ­¥**:
- è¿›å…¥Phase 2: è£…å¤‡ç”Ÿæˆä¸æ‰è½ç³»ç»Ÿ

---

*ï¼ˆä¸Šç¯‡åˆ°æ­¤ç»“æŸï¼Œä¸­ç¯‡å°†ç»§ç»­Phase 2-3çš„è¯¦ç»†å®æ–½æ­¥éª¤å’Œå‰ç«¯éªŒè¯ï¼‰*

**æ–‡æ¡£ç‰ˆæœ¬**: 2.0  
**æœ€åæ›´æ–°**: 2025-10-11  
**ç»´æŠ¤å›¢é˜Ÿ**: BlazorIdleå¼€å‘å›¢é˜Ÿ  

---

### ç›¸å…³æ–‡æ¡£

- **ä¸­ç¯‡**: [è£…å¤‡ç³»ç»Ÿå®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ-ä¸­ç¯‡.md](è£…å¤‡ç³»ç»Ÿå®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ-ä¸­ç¯‡.md)
- **ä¸‹ç¯‡**: [è£…å¤‡ç³»ç»Ÿå®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ-ä¸‹ç¯‡.md](è£…å¤‡ç³»ç»Ÿå®Œæ•´ä¼˜åŒ–æ–¹æ¡ˆ-ä¸‹ç¯‡.md)
- **å‚è€ƒ**: [æ•´åˆè®¾è®¡æ€»ç»“.txt](æ•´åˆè®¾è®¡æ€»ç»“.txt)
