# SignalR ç³»ç»Ÿä¸ç°æœ‰æ¶æ„é›†æˆè¯´æ˜

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**ç”Ÿæˆæ—¥æœŸ**: 2025å¹´10æœˆ  
**ç›®çš„**: è¯´æ˜ SignalR ç³»ç»Ÿå¦‚ä½•ä¸å½“å‰é¡¹ç›®æ¶æ„é›†æˆ

---

## ğŸ“ å½“å‰é¡¹ç›®ç»“æ„åˆ†æ

### ç°æœ‰ç›®å½•ç»“æ„

```
BlazorIdle.Server/
â”œâ”€â”€ Api/                    # æ§åˆ¶å™¨å±‚
â”‚   â”œâ”€â”€ BattlesController.cs
â”‚   â”œâ”€â”€ StepBattlesController.cs
â”‚   â””â”€â”€ CharactersController.cs
â”‚
â”œâ”€â”€ Application/            # åº”ç”¨æœåŠ¡å±‚
â”‚   â”œâ”€â”€ Abstractions/
â”‚   â”‚   â”œâ”€â”€ IBattleRepository.cs
â”‚   â”‚   â””â”€â”€ ICharacterRepository.cs
â”‚   â””â”€â”€ Battles/
â”‚       â”œâ”€â”€ BattleRunner.cs
â”‚       â””â”€â”€ Step/
â”‚           â”œâ”€â”€ StepBattleCoordinator.cs
â”‚           â”œâ”€â”€ RunningBattle.cs
â”‚           â””â”€â”€ StepBattleHostedService.cs
â”‚
â”œâ”€â”€ Domain/                 # é¢†åŸŸæ¨¡å‹å±‚
â”‚   â”œâ”€â”€ Combat/
â”‚   â”‚   â”œâ”€â”€ BattleAggregate.cs
â”‚   â”‚   â”œâ”€â”€ BattleContext.cs
â”‚   â”‚   â”œâ”€â”€ EventScheduler.cs
â”‚   â”‚   â”œâ”€â”€ SegmentCollector.cs
â”‚   â”‚   â”œâ”€â”€ IGameEvent.cs
â”‚   â”‚   â”œâ”€â”€ Skills/
â”‚   â”‚   â”œâ”€â”€ Buffs/
â”‚   â”‚   â”œâ”€â”€ Resources/
â”‚   â”‚   â””â”€â”€ Professions/
â”‚   â””â”€â”€ Characters/
â”‚
â””â”€â”€ Infrastructure/         # åŸºç¡€è®¾æ–½å±‚
    â”œâ”€â”€ Persistence/
    â”‚   â”œâ”€â”€ GameDbContext.cs
    â”‚   â””â”€â”€ Repositories/
    â”œâ”€â”€ Startup/
    â””â”€â”€ DependencyInjection/
```

---

## ğŸ¯ SignalR ç³»ç»Ÿé›†æˆç‚¹

### æ–°å¢ç›®å½•ç»“æ„

```
BlazorIdle.Server/
â”œâ”€â”€ Domain/
â”‚   â””â”€â”€ Events/  â† æ–°å¢ï¼šé¢†åŸŸäº‹ä»¶å®šä¹‰
â”‚       â”œâ”€â”€ IDomainEvent.cs
â”‚       â”œâ”€â”€ INotificationEvent.cs
â”‚       â””â”€â”€ Combat/
â”‚           â”œâ”€â”€ CombatSegmentFlushedEvent.cs
â”‚           â”œâ”€â”€ BattleStartedEvent.cs
â”‚           â””â”€â”€ BattleEndedEvent.cs
â”‚
â”œâ”€â”€ Infrastructure/
â”‚   â””â”€â”€ Messaging/  â† æ–°å¢ï¼šæ¶ˆæ¯åŸºç¡€è®¾æ–½
â”‚       â”œâ”€â”€ IDomainEventBus.cs
â”‚       â”œâ”€â”€ InMemoryEventBus.cs
â”‚       â”œâ”€â”€ ISignalRDispatcher.cs
â”‚       â”œâ”€â”€ SignalRDispatcher.cs
â”‚       â”œâ”€â”€ ConnectionManager.cs
â”‚       â”œâ”€â”€ NotificationEventSubscriber.cs
â”‚       â””â”€â”€ Hubs/
â”‚           â””â”€â”€ GameNotificationHub.cs
â”‚
â””â”€â”€ Api/
    â””â”€â”€ MonitoringController.cs  â† æ–°å¢ï¼šç›‘æ§ç«¯ç‚¹
```

---

## ğŸ”— ä¸ç°æœ‰ä»£ç çš„é›†æˆæ–¹å¼

### 1. Domain.Combat å±‚é›†æˆ

#### SegmentCollector ä¿®æ”¹ï¼ˆæœ€å°åŒ–ï¼‰

**ä½ç½®**: `Domain/Combat/SegmentCollector.cs`

**ä¿®æ”¹å†…å®¹**:
```csharp
// æ·»åŠ å§”æ‰˜å±æ€§
public Action<CombatSegment>? OnSegmentFlushed { get; set; }

// åœ¨ Flush() æ–¹æ³•æœ«å°¾æ·»åŠ 
public CombatSegment Flush(double currentTime)
{
    // ... ç°æœ‰é€»è¾‘ ...
    
    var seg = new CombatSegment { /* ... */ };
    
    // æ–°å¢ï¼šè§¦å‘å›è°ƒ
    OnSegmentFlushed?.Invoke(seg);
    
    Reset(currentTime);
    return seg;
}
```

**å½±å“**: 
- âœ… ä¸ç ´åç°æœ‰é€»è¾‘
- âœ… å‘åå…¼å®¹ï¼ˆå§”æ‰˜å¯ä¸º nullï¼‰
- âœ… Domain å±‚æ— å¤–éƒ¨ä¾èµ–

---

### 2. Application å±‚é›†æˆ

#### StepBattleCoordinator ä¿®æ”¹

**ä½ç½®**: `Application/Battles/Step/StepBattleCoordinator.cs`

**ä¿®æ”¹å†…å®¹**:

```csharp
// 1. æ·»åŠ ä¾èµ–æ³¨å…¥
private readonly IDomainEventBus _eventBus;

public StepBattleCoordinator(
    IServiceScopeFactory scopeFactory,
    IDomainEventBus eventBus)  // â† æ–°å¢
{
    _scopeFactory = scopeFactory;
    _eventBus = eventBus;
}

// 2. åœ¨ Start() ä¸­æ³¨å†Œå›è°ƒå¹¶å‘å¸ƒäº‹ä»¶
public Guid Start(/* å‚æ•° */)
{
    // ... ç°æœ‰é€»è¾‘ ...
    
    var rb = new RunningBattle(/* ... */);
    
    // æ–°å¢ï¼šæ³¨å†Œ Segment åˆ·æ–°å›è°ƒ
    rb.Collector.OnSegmentFlushed = segment =>
    {
        PublishSegmentFlushedEvent(id, characterId, rb.Clock.CurrentTime, segment);
    };
    
    _running.TryAdd(id, rb);
    
    // æ–°å¢ï¼šå‘å¸ƒæˆ˜æ–—å¼€å§‹äº‹ä»¶
    PublishBattleStartedEvent(id, characterId, profession, enemyId, /* ... */);
    
    return id;
}

// 3. åœ¨ Stop() ä¸­å‘å¸ƒäº‹ä»¶
public async Task<(bool, StepBattleStatusDto?)> Stop(Guid id)
{
    // ... ç°æœ‰é€»è¾‘ ...
    
    // æ–°å¢ï¼šå‘å¸ƒæˆ˜æ–—ç»“æŸäº‹ä»¶
    if (finalStatus.found)
    {
        PublishBattleEndedEvent(rb, finalStatus.status);
    }
    
    return finalStatus;
}

// 4. æ–°å¢è¾…åŠ©æ–¹æ³•
private void PublishSegmentFlushedEvent(/* å‚æ•° */)
{
    var @event = new CombatSegmentFlushedEvent { /* ... */ };
    _eventBus.Publish(@event);
}

private void PublishBattleStartedEvent(/* å‚æ•° */)
{
    var @event = new BattleStartedEvent { /* ... */ };
    _eventBus.Publish(@event);
}

private void PublishBattleEndedEvent(/* å‚æ•° */)
{
    var @event = new BattleEndedEvent { /* ... */ };
    _eventBus.Publish(@event);
}
```

**å½±å“**:
- âœ… åªåœ¨ä¸Šå±‚æœåŠ¡æ³¨å…¥äº‹ä»¶æ€»çº¿
- âœ… Domain å±‚ä¿æŒçº¯å‡€
- âœ… äº‹ä»¶å‘å¸ƒé€»è¾‘é›†ä¸­ç®¡ç†

---

### 3. Infrastructure å±‚é›†æˆ

#### ä¾èµ–æ³¨å…¥é…ç½®

**ä½ç½®**: `Infrastructure/DependencyInjection.cs` æˆ–æ–°å»º `Infrastructure/DependencyInjection/MessagingExtensions.cs`

**æ–°å¢å†…å®¹**:

```csharp
// Infrastructure/DependencyInjection/MessagingExtensions.cs
public static class MessagingExtensions
{
    public static IServiceCollection AddMessaging(
        this IServiceCollection services,
        IConfiguration configuration)
    {
        // äº‹ä»¶æ€»çº¿
        services.AddSingleton<IDomainEventBus, InMemoryEventBus>();

        // SignalR
        services.AddSignalR(options =>
        {
            options.EnableDetailedErrors = 
                configuration.GetValue<bool>("Messaging:SignalR:EnableDetailedErrors", false);
            options.MaximumReceiveMessageSize = 128 * 1024;
            options.KeepAliveInterval = TimeSpan.FromSeconds(15);
            options.ClientTimeoutInterval = TimeSpan.FromSeconds(30);
        });

        // SignalR åˆ†å‘å™¨
        services.AddSingleton<ISignalRDispatcher, SignalRDispatcher>();

        // è¿æ¥ç®¡ç†å™¨
        services.AddSingleton<ConnectionManager>();

        // äº‹ä»¶è®¢é˜…æœåŠ¡
        services.AddHostedService<NotificationEventSubscriber>();

        // ç›‘æ§æœåŠ¡ï¼ˆå¯é€‰ï¼‰
        services.AddSingleton<EventStatisticsService>();
        services.AddHostedService(sp => sp.GetRequiredService<EventStatisticsService>());

        return services;
    }
}
```

---

### 4. Program.cs ä¿®æ”¹

**ä½ç½®**: `BlazorIdle.Server/Program.cs`

**ä¿®æ”¹å†…å®¹**:

```csharp
var builder = WebApplication.CreateBuilder(args);

// ç°æœ‰æœåŠ¡æ³¨å†Œ
builder.Services.AddControllers();
builder.Services.AddEndpointsApiExplorer();
builder.Services.AddSwaggerGen();

builder.Services
    .AddInfrastructure(builder.Configuration)
    .AddApplication()
    .AddMessaging(builder.Configuration);  // â† æ–°å¢

// CORS é…ç½®æ›´æ–°ï¼ˆSignalR éœ€è¦ AllowCredentialsï¼‰
builder.Services.AddCors(options =>
{
    options.AddPolicy("AllowBlazorClient", policy =>
    {
        policy
            .WithOrigins("https://localhost:5001", "http://localhost:5000")
            .AllowAnyHeader()
            .AllowAnyMethod()
            .AllowCredentials();  // â† æ–°å¢æˆ–ç¡®ä¿å­˜åœ¨
    });
});

var app = builder.Build();

// ... ç°æœ‰ä¸­é—´ä»¶é…ç½® ...

app.UseHttpsRedirection();
app.UseCors("AllowBlazorClient");

// æ–°å¢ï¼šæ˜ å°„ SignalR Hub
app.MapHub<GameNotificationHub>("/hubs/notifications");

app.MapControllers();
app.Run();
```

**å½±å“**:
- âœ… æœ€å°åŒ–ä¿®æ”¹
- âœ… æ¨¡å—åŒ–é…ç½®
- âœ… æ˜“äºå¯ç”¨/ç¦ç”¨

---

## ğŸ§ª éªŒè¯é›†æˆæ­£ç¡®æ€§

### æ­¥éª¤ 1: ç¼–è¯‘æ£€æŸ¥

```bash
cd /home/runner/work/BlazorIdle/BlazorIdle
dotnet build
```

**æœŸæœ›**: æ— ç¼–è¯‘é”™è¯¯

---

### æ­¥éª¤ 2: å¯åŠ¨æœåŠ¡å™¨

```bash
dotnet run --project BlazorIdle.Server
```

**æœŸæœ›**: 
- æœåŠ¡æ­£å¸¸å¯åŠ¨
- æ—¥å¿—æ˜¾ç¤º `NotificationEventSubscriber started`
- æ— å¼‚å¸¸æŠ›å‡º

---

### æ­¥éª¤ 3: æ£€æŸ¥ SignalR Hub ç«¯ç‚¹

```bash
curl https://localhost:7001/hubs/notifications
```

**æœŸæœ›**: è¿”å› SignalR åå•†å“åº”ï¼ˆé 404ï¼‰

---

### æ­¥éª¤ 4: æµ‹è¯•äº‹ä»¶å‘å¸ƒ

åˆ›å»ºæµ‹è¯•æ§åˆ¶å™¨ï¼š

```csharp
// Api/TestController.cs
[ApiController]
[Route("api/test")]
public class TestController : ControllerBase
{
    private readonly IDomainEventBus _eventBus;

    public TestController(IDomainEventBus eventBus)
    {
        _eventBus = eventBus;
    }

    [HttpPost("publish-event")]
    public IActionResult PublishTestEvent()
    {
        var @event = new BattleStartedEvent
        {
            EventId = Guid.NewGuid(),
            OccurredAtUtc = DateTime.UtcNow,
            CharacterId = Guid.NewGuid(),
            BattleId = Guid.NewGuid(),
            Profession = Profession.Warrior,
            EnemyId = "dummy",
            EnemyCount = 1,
            Mode = "test",
            DungeonId = null
        };

        _eventBus.Publish(@event);

        return Ok(new { message = "Event published", eventId = @event.EventId });
    }
}
```

**æµ‹è¯•**:
```bash
curl -X POST https://localhost:7001/api/test/publish-event
```

**æœŸæœ›**: 
- è¿”å›æˆåŠŸå“åº”
- æ—¥å¿—æ˜¾ç¤ºäº‹ä»¶è¢«å¤„ç†
- å¦‚æœ‰ SignalR å®¢æˆ·ç«¯è¿æ¥ï¼Œåº”æ”¶åˆ°æ¨é€

---

## ğŸ“Š ä¸ç°æœ‰ä»£ç çš„å…¼å®¹æ€§æ£€æŸ¥è¡¨

### Domain å±‚

- [x] `IGameEvent` æ¥å£ä¿æŒä¸å˜
- [x] `EventScheduler` é€»è¾‘ä¸å—å½±å“
- [x] `BattleRunner` æ‰§è¡Œæµç¨‹ä¸å˜
- [x] `SegmentCollector` ä»…æ·»åŠ å§”æ‰˜ï¼ˆå¯é€‰ï¼‰
- [x] æ‰€æœ‰æˆ˜æ–—é€»è¾‘ä¿æŒåŸæ ·

**ç»“è®º**: âœ… å®Œå…¨å…¼å®¹ï¼Œæ— ç ´åæ€§ä¿®æ”¹

---

### Application å±‚

- [x] `BattleRunner` ä½¿ç”¨æ–¹å¼ä¸å˜
- [x] `StepBattleCoordinator` æ·»åŠ äº‹ä»¶å‘å¸ƒé€»è¾‘
- [x] ç°æœ‰ API ç«¯ç‚¹ä¿æŒä¸å˜
- [x] Repository æ¥å£æ— ä¿®æ”¹

**ç»“è®º**: âœ… æœ€å°åŒ–ä¿®æ”¹ï¼Œå‘åå…¼å®¹

---

### Infrastructure å±‚

- [x] `GameDbContext` æ— ä¿®æ”¹
- [x] Repository å®ç°æ— ä¿®æ”¹
- [x] ç°æœ‰æœåŠ¡æ³¨å†Œä¿æŒä¸å˜
- [x] æ–°å¢æœåŠ¡é€šè¿‡æ‰©å±•æ–¹æ³•ç‹¬ç«‹æ³¨å†Œ

**ç»“è®º**: âœ… æ¨¡å—åŒ–æ‰©å±•ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½

---

### Api å±‚

- [x] ç°æœ‰æ§åˆ¶å™¨æ— éœ€ä¿®æ”¹
- [x] ç°æœ‰ç«¯ç‚¹ç»§ç»­å·¥ä½œ
- [x] æ–°å¢ç›‘æ§ç«¯ç‚¹ç‹¬ç«‹
- [x] å®¢æˆ·ç«¯è°ƒç”¨æ–¹å¼ä¸å˜

**ç»“è®º**: âœ… å®Œå…¨å…¼å®¹

---

## ğŸ¨ ä»£ç é£æ ¼ä¸€è‡´æ€§

### å‘½åè§„èŒƒ

SignalR ç³»ç»Ÿéµå¾ªç°æœ‰å‘½åè§„èŒƒï¼š

| ç±»å‹ | ç°æœ‰ç¤ºä¾‹ | SignalR ç³»ç»Ÿ |
|------|---------|-------------|
| æ¥å£ | `IGameEvent`, `IBattleRepository` | `IDomainEvent`, `ISignalRDispatcher` |
| å®ç°ç±» | `EventScheduler`, `BattleRunner` | `InMemoryEventBus`, `SignalRDispatcher` |
| é¢†åŸŸæ¨¡å‹ | `Battle`, `CombatSegment` | `BattleStartedEvent`, `CombatSegmentData` |
| æœåŠ¡ | `StepBattleCoordinator` | `NotificationEventSubscriber` |

**ç»“è®º**: âœ… ä¸€è‡´

---

### ä»£ç ç»„ç»‡

```
ç°æœ‰æ¨¡å¼:
Domain/
  Combat/
    BattleAggregate.cs      (èšåˆæ ¹)
    SegmentCollector.cs     (å€¼å¯¹è±¡/æœåŠ¡)
    IGameEvent.cs           (æ¥å£)

SignalR æ¨¡å¼:
Domain/
  Events/
    IDomainEvent.cs         (æ¥å£)
    Combat/
      BattleStartedEvent.cs (äº‹ä»¶)
```

**ç»“è®º**: âœ… éµå¾ªç°æœ‰åˆ†å±‚å’Œæ¨¡å—åˆ’åˆ†

---

### ä¾èµ–æ³¨å…¥æ¨¡å¼

```csharp
// ç°æœ‰æ¨¡å¼
public class StepBattleCoordinator
{
    private readonly IServiceScopeFactory _scopeFactory;
    
    public StepBattleCoordinator(IServiceScopeFactory scopeFactory)
    {
        _scopeFactory = scopeFactory;
    }
}

// SignalR ç³»ç»Ÿï¼ˆä¸€è‡´ï¼‰
public class SignalRDispatcher : ISignalRDispatcher
{
    private readonly IHubContext<GameNotificationHub> _hubContext;
    private readonly ILogger<SignalRDispatcher> _logger;
    
    public SignalRDispatcher(
        IHubContext<GameNotificationHub> hubContext,
        ILogger<SignalRDispatcher> logger)
    {
        _hubContext = hubContext;
        _logger = logger;
    }
}
```

**ç»“è®º**: âœ… å®Œå…¨ä¸€è‡´

---

## ğŸ” æ½œåœ¨é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜ 1: äº‹ä»¶æ€»çº¿çº¿ç¨‹å®‰å…¨

**æè¿°**: å¤šä¸ªæˆ˜æ–—å®ä¾‹å¹¶å‘å‘å¸ƒäº‹ä»¶

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨ `Channel<T>` å®ç°å¼‚æ­¥é˜Ÿåˆ—
- å•ä¸€å¤„ç†çº¿ç¨‹æ¶ˆè´¹äº‹ä»¶
- æ— é”æ•°æ®ç»“æ„ï¼ˆ`ConcurrentDictionary`ï¼‰

**çŠ¶æ€**: âœ… å·²åœ¨è®¾è®¡ä¸­è§£å†³

---

### é—®é¢˜ 2: SignalR è¿æ¥çŠ¶æ€ç®¡ç†

**æè¿°**: å®¢æˆ·ç«¯æ–­çº¿åé‡è¿ï¼Œå¯èƒ½ä¸¢å¤±æ¶ˆæ¯

**è§£å†³æ–¹æ¡ˆ**:
- è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼ˆSignalR å†…ç½®ï¼‰
- å®¢æˆ·ç«¯ç¼“å†²é˜Ÿåˆ—
- å¯é€‰ï¼šæ¶ˆæ¯åºåˆ—å·å’Œè¡¥å‘æœºåˆ¶

**çŠ¶æ€**: âœ… å·²åœ¨è®¾è®¡ä¸­è€ƒè™‘

---

### é—®é¢˜ 3: æ€§èƒ½å½±å“

**æè¿°**: é¢‘ç¹æ¨é€å¯èƒ½å½±å“æˆ˜æ–—è®¡ç®—æ€§èƒ½

**è§£å†³æ–¹æ¡ˆ**:
- äº‹ä»¶å‘å¸ƒå¼‚æ­¥æ‰§è¡Œ
- Segment èšåˆå‡å°‘æ¨é€é¢‘ç‡
- æ‰¹é‡å‘é€ä¼˜åŒ–
- ä¼˜å…ˆçº§é˜Ÿåˆ—æ§åˆ¶

**çŠ¶æ€**: âœ… å·²ä¼˜åŒ–

---

## ğŸ“ˆ æ€§èƒ½è¯„ä¼°

### é¢„æœŸæ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å®æµ‹å€¼ï¼ˆå¾…éªŒè¯ï¼‰ |
|------|--------|-----------------|
| æ¶ˆæ¯å»¶è¿Ÿ (P99) | < 500ms | - |
| æˆ˜æ–—æ€§èƒ½å½±å“ | < 5% | - |
| å¹¶å‘è¿æ¥æ•° | > 1000 | - |
| å†…å­˜å ç”¨ï¼ˆ1000è¿æ¥ï¼‰ | < 500MB | - |
| CPU å ç”¨ï¼ˆç©ºé—²ï¼‰ | < 20% | - |

---

### æ€§èƒ½æµ‹è¯•å»ºè®®

```csharp
// 1. æˆ˜æ–—æ€§èƒ½æµ‹è¯•
// å¯¹æ¯”å¯ç”¨/ç¦ç”¨äº‹ä»¶å‘å¸ƒçš„æˆ˜æ–—æ‰§è¡Œæ—¶é—´

// 2. SignalR æ¨é€æ€§èƒ½æµ‹è¯•
// æµ‹è¯•å¤§é‡å¹¶å‘è¿æ¥æ—¶çš„ååé‡

// 3. å†…å­˜æ³„æ¼æµ‹è¯•
// é•¿æ—¶é—´è¿è¡Œæ£€æŸ¥å†…å­˜å¢é•¿

// 4. å‹åŠ›æµ‹è¯•
// æ¨¡æ‹Ÿé«˜é¢‘ç‡æˆ˜æ–—å’Œæ¨é€åœºæ™¯
```

---

## âœ… é›†æˆæ£€æŸ¥æ¸…å•

### Phase 1 å®Œæˆæ£€æŸ¥

- [ ] Domain å±‚äº‹ä»¶æ¥å£å®šä¹‰
- [ ] Infrastructure å±‚äº‹ä»¶æ€»çº¿å®ç°
- [ ] SignalR Hub åˆ›å»ºå’Œé…ç½®
- [ ] SignalR åˆ†å‘å™¨å®ç°
- [ ] è¿æ¥ç®¡ç†å™¨å®ç°
- [ ] ä¾èµ–æ³¨å…¥é…ç½®
- [ ] Program.cs é›†æˆ
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] æ–‡æ¡£å®Œæ•´

---

### Phase 2 å®Œæˆæ£€æŸ¥

- [ ] æˆ˜æ–—äº‹ä»¶å®šä¹‰
- [ ] SegmentCollector é›†æˆ
- [ ] StepBattleCoordinator é›†æˆ
- [ ] å®¢æˆ·ç«¯æœåŠ¡å®ç°
- [ ] UI é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] å‘åå…¼å®¹æ€§éªŒè¯
- [ ] æ–‡æ¡£æ›´æ–°

---

### Phase 3 å®Œæˆæ£€æŸ¥

- [ ] ä¼˜å…ˆçº§æ”¯æŒå®ç°
- [ ] ç›‘æ§ç«¯ç‚¹åˆ›å»º
- [ ] ç»Ÿè®¡æœåŠ¡å®ç°
- [ ] å¥åº·æ£€æŸ¥å®ç°
- [ ] æ‰©å±•æ–‡æ¡£å®Œå–„
- [ ] ç¤ºä¾‹ä»£ç é½å…¨
- [ ] æœ€ä½³å®è·µæ–‡æ¡£

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚åœ¨é›†æˆè¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥é˜…è®¾è®¡æ–‡æ¡£**: æŸ¥çœ‹å¯¹åº” Phase çš„è¯¦ç»†è¯´æ˜
2. **æ£€æŸ¥ä»£ç ç¤ºä¾‹**: æ–‡æ¡£ä¸­æä¾›äº†å®Œæ•´çš„ä»£ç ç¤ºä¾‹
3. **å‚è€ƒç°æœ‰ä»£ç **: éµå¾ªé¡¹ç›®ç°æœ‰çš„ä»£ç é£æ ¼å’Œæ¨¡å¼
4. **æŸ¥çœ‹æ—¥å¿—**: å¯ç”¨è¯¦ç»†æ—¥å¿—æŸ¥çœ‹äº‹ä»¶æµè½¬
5. **å•å…ƒæµ‹è¯•**: ç¼–å†™æµ‹è¯•éªŒè¯é›†æˆç‚¹

---

## ğŸ‰ æ€»ç»“

SignalR æ¨é€ç³»ç»Ÿè®¾è®¡ï¼š

âœ… **æœ€å°åŒ–ä¾µå…¥æ€§** - Domain å±‚å‡ ä¹æ— ä¿®æ”¹  
âœ… **éµå¾ªç°æœ‰æ¶æ„** - åˆ†å±‚æ¸…æ™°ï¼ŒèŒè´£æ˜ç¡®  
âœ… **ä¿æŒä»£ç é£æ ¼** - å‘½åã€ç»„ç»‡ã€æ¨¡å¼ä¸€è‡´  
âœ… **å‘åå…¼å®¹** - ä¸ç ´åç°æœ‰åŠŸèƒ½  
âœ… **æ˜“äºæ‰©å±•** - æ–°å¢äº‹ä»¶ç±»å‹ç®€å•  
âœ… **é«˜æ€§èƒ½** - å¼‚æ­¥ã€æ‰¹é‡ã€èšåˆä¼˜åŒ–  

å¯ä»¥å®‰å…¨ã€æ¸è¿›å¼åœ°é›†æˆåˆ°ç°æœ‰é¡¹ç›®ä¸­ï¼ğŸš€
