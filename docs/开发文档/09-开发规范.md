# BlazorIdle å¼€å‘è§„èŒƒ

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-15  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ  
**çŠ¶æ€**: Phase 9 å¼€å‘æ–‡æ¡£

---

## ğŸ“‹ ç›®å½•

1. [ä»£ç é£æ ¼](#ä»£ç é£æ ¼)
2. [å‘½åçº¦å®š](#å‘½åçº¦å®š)
3. [æ³¨é‡Šè§„èŒƒ](#æ³¨é‡Šè§„èŒƒ)
4. [é¡¹ç›®ç»“æ„è§„èŒƒ](#é¡¹ç›®ç»“æ„è§„èŒƒ)
5. [é…ç½®åŒ–è§„èŒƒ](#é…ç½®åŒ–è§„èŒƒ)
6. [æµ‹è¯•è§„èŒƒ](#æµ‹è¯•è§„èŒƒ)
7. [Git æäº¤è§„èŒƒ](#git-æäº¤è§„èŒƒ)
8. [Code Review æ¸…å•](#code-review-æ¸…å•)

---

## ä»£ç é£æ ¼

### C# ä»£ç é£æ ¼

éµå¾ª [C# ç¼–ç çº¦å®š](https://docs.microsoft.com/zh-cn/dotnet/csharp/fundamentals/coding-style/coding-conventions)ã€‚

#### åŸºæœ¬è§„åˆ™

- **ç¼©è¿›**: 4 ä¸ªç©ºæ ¼ï¼ˆä¸ä½¿ç”¨ Tabï¼‰
- **å¤§æ‹¬å·**: å§‹ç»ˆä½¿ç”¨å¤§æ‹¬å·ï¼Œå³ä½¿åªæœ‰ä¸€è¡Œä»£ç 
- **è¡Œå®½**: å»ºè®®ä¸è¶…è¿‡ 120 å­—ç¬¦
- **æ–‡ä»¶ç¼–ç **: UTF-8 with BOM
- **æ¢è¡Œç¬¦**: LF (Unix é£æ ¼)

#### ç¤ºä¾‹

```csharp
// âœ… æ¨è
public class CharacterService
{
    private readonly ICharacterRepository _repository;
    
    public CharacterService(ICharacterRepository repository)
    {
        _repository = repository ?? throw new ArgumentNullException(nameof(repository));
    }
    
    public async Task<Character> GetCharacterAsync(Guid characterId)
    {
        if (characterId == Guid.Empty)
        {
            throw new ArgumentException("è§’è‰²IDä¸èƒ½ä¸ºç©º", nameof(characterId));
        }
        
        return await _repository.GetByIdAsync(characterId);
    }
}

// âŒ é¿å…
public class CharacterService{
private ICharacterRepository _repo;
public CharacterService(ICharacterRepository repo){_repo=repo;}
public async Task<Character> GetCharacter(Guid id){return await _repo.GetByIdAsync(id);}
}
```

### ç©ºæ ¼å’Œç©ºè¡Œ

#### ç©ºæ ¼ä½¿ç”¨

```csharp
// âœ… æ¨è
if (condition) { }
for (int i = 0; i < count; i++) { }
var result = Calculate(a, b, c);
var value = array[index];

// âŒ é¿å…
if(condition){}
for(int i=0;i<count;i++){}
var result = Calculate(a,b,c);
var value = array[ index ];
```

#### ç©ºè¡Œä½¿ç”¨

```csharp
// âœ… æ¨è
public class Example
{
    // å­—æ®µä¹‹é—´æ— ç©ºè¡Œ
    private readonly IService _service;
    private readonly ILogger _logger;
    
    // æ„é€ å‡½æ•°å‰æœ‰ç©ºè¡Œ
    public Example(IService service, ILogger logger)
    {
        _service = service;
        _logger = logger;
    }
    
    // æ–¹æ³•ä¹‹é—´æœ‰ç©ºè¡Œ
    public void Method1()
    {
        // é€»è¾‘åˆ†ç»„ä¹‹é—´æœ‰ç©ºè¡Œ
        var data = PrepareData();
        
        ProcessData(data);
        
        SaveData(data);
    }
    
    public void Method2()
    {
        // ...
    }
}
```

---

## å‘½åçº¦å®š

### é€šç”¨è§„åˆ™

| ç±»å‹ | å‘½åè§„åˆ™ | ç¤ºä¾‹ |
|-----|---------|------|
| å‘½åç©ºé—´ | PascalCase | `BlazorIdle.Domain.Combat` |
| ç±» | PascalCase | `CharacterService` |
| æ¥å£ | I + PascalCase | `ICharacterRepository` |
| æ–¹æ³• | PascalCase | `GetCharacterAsync` |
| å±æ€§ | PascalCase | `CharacterId` |
| å­—æ®µï¼ˆç§æœ‰ï¼‰ | _camelCase | `_repository` |
| å­—æ®µï¼ˆå¸¸é‡ï¼‰ | PascalCase | `MaxRetryCount` |
| å‚æ•° | camelCase | `characterId` |
| å±€éƒ¨å˜é‡ | camelCase | `character` |
| å¼‚æ­¥æ–¹æ³• | åç¼€Async | `SaveCharacterAsync` |

### è¯¦ç»†è§„èŒƒ

#### 1. ç±»å‘½å

```csharp
// âœ… æ¨è - åè¯æˆ–åè¯çŸ­è¯­
public class Character { }
public class BattleEngine { }
public class DamageCalculator { }
public class CharacterService { }

// âŒ é¿å… - åŠ¨è¯æˆ–æ¨¡ç³Šåç§°
public class ProcessData { }
public class Helper { }
public class Manager { }
public class Utils { }
```

#### 2. æ¥å£å‘½å

```csharp
// âœ… æ¨è - I å‰ç¼€ + èƒ½åŠ›æè¿°
public interface ICharacterRepository { }
public interface IDamageCalculator { }
public interface IEventScheduler { }

// âŒ é¿å…
public interface CharacterRepo { }  // ç¼ºå°‘ I å‰ç¼€
public interface IHelper { }        // åç§°å¤ªæ¨¡ç³Š
```

#### 3. æ–¹æ³•å‘½å

```csharp
// âœ… æ¨è - åŠ¨è¯æˆ–åŠ¨è¯çŸ­è¯­
public void SaveCharacter() { }
public Character GetCharacter() { }
public bool ValidateEquipment() { }
public async Task<Character> LoadCharacterAsync() { }

// âŒ é¿å…
public void Character() { }          // åè¯
public void DoIt() { }               // ä¸æ˜ç¡®
public void get_character() { }      // é”™è¯¯çš„å‘½åé£æ ¼
public async Task<Character> LoadCharacter() { }  // å¼‚æ­¥æ–¹æ³•ç¼ºå°‘ Async åç¼€
```

#### 4. å±æ€§å‘½å

```csharp
// âœ… æ¨è
public Guid CharacterId { get; set; }
public string Name { get; set; }
public int MaxHealth { get; set; }
public bool IsAlive { get; set; }
public bool CanAttack { get; set; }

// âŒ é¿å…
public Guid characterId { get; set; }     // åº”è¯¥æ˜¯ PascalCase
public string name_ { get; set; }          // ä¸ä½¿ç”¨ä¸‹åˆ’çº¿åç¼€
public int m_maxHealth { get; set; }       // ä¸ä½¿ç”¨åŒˆç‰™åˆ©å‘½åæ³•
```

#### 5. å­—æ®µå‘½å

```csharp
// âœ… æ¨è
private readonly ICharacterRepository _repository;
private readonly ILogger<CharacterService> _logger;
private int _retryCount;

private const int MaxRetryCount = 3;
private static readonly TimeSpan DefaultTimeout = TimeSpan.FromSeconds(30);

// âŒ é¿å…
private ICharacterRepository repository;           // ç§æœ‰å­—æ®µåº”æœ‰ä¸‹åˆ’çº¿å‰ç¼€
private ILogger<CharacterService> m_logger;       // ä¸ä½¿ç”¨åŒˆç‰™åˆ©å‘½åæ³•
private int RetryCount;                           // ç§æœ‰å­—æ®µä¸åº”è¯¥ PascalCase
```

#### 6. é…ç½®ç±»å‘½å

```csharp
// âœ… æ¨è - Options åç¼€
public class CombatEngineOptions { }
public class ShopOptions { }
public class EquipmentSystemOptions { }

// âŒ é¿å…
public class CombatEngineConfig { }    // ä½¿ç”¨ Options è€Œé Config
public class CombatEngineSettings { }  // ä½¿ç”¨ Options è€Œé Settings
```

**è§„èŒƒ**: æ ¹æ® Phase 8 ç¡®ç«‹çš„çº¦å®šï¼Œé…ç½®ç±»ç»Ÿä¸€ä½¿ç”¨ `Options` åç¼€ã€‚

---

## æ³¨é‡Šè§„èŒƒ

### XML æ–‡æ¡£æ³¨é‡Š

æ‰€æœ‰å…¬å…± API å¿…é¡»æœ‰ XML æ–‡æ¡£æ³¨é‡Šã€‚

#### ç±»æ³¨é‡Š

```csharp
/// <summary>
/// æˆ˜æ–—å¼•æ“ - æ ¸å¿ƒæˆ˜æ–—å¾ªç¯å¤„ç†å™¨
/// </summary>
/// <remarks>
/// èŒè´£ï¼š
/// 1. é©±åŠ¨äº‹ä»¶è°ƒåº¦å™¨æ¨è¿›æˆ˜æ–—æ—¶é—´
/// 2. å¤„ç†æ”»å‡»ã€æŠ€èƒ½ã€Buffç­‰æˆ˜æ–—äº‹ä»¶
/// 3. ç®¡ç†æ•Œäººç”Ÿæˆå’Œæ³¢æ¬¡åˆ‡æ¢
/// </remarks>
public sealed class BattleEngine
{
    // ...
}
```

#### æ–¹æ³•æ³¨é‡Š

```csharp
/// <summary>
/// æ¨è¿›æˆ˜æ–—åˆ°æŒ‡å®šæ—¶é—´ç‚¹
/// </summary>
/// <param name="targetTime">ç›®æ ‡æ—¶é—´ï¼ˆç§’ï¼‰</param>
/// <returns>æ˜¯å¦æˆ˜æ–—ç»“æŸ</returns>
/// <exception cref="InvalidOperationException">å½“æˆ˜æ–—å·²ç»“æŸæ—¶æŠ›å‡º</exception>
public bool AdvanceTo(double targetTime)
{
    // ...
}
```

#### å±æ€§æ³¨é‡Š

```csharp
/// <summary>
/// è¿œæœªæ¥æ—¶é—´æˆ³ï¼Œç”¨äºæ ‡è®°æœªæ¿€æ´»çš„äº‹ä»¶
/// </summary>
public double FarFutureTimestamp { get; set; } = 1e10;

/// <summary>
/// æŠ€èƒ½æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰ï¼Œæ§åˆ¶æ•ŒäººæŠ€èƒ½è§¦å‘æ£€æŸ¥é¢‘ç‡
/// </summary>
public double SkillCheckIntervalSeconds { get; set; } = 0.5;
```

### ä»£ç å†…æ³¨é‡Š

#### ç®—æ³•æ³¨é‡Š

```csharp
public double CalculateArmorReduction(double armor, int attackerLevel)
{
    // æŠ¤ç”²å‡ä¼¤å…¬å¼: Armor / (Armor + C + K * Level)
    // C = å¸¸é‡ (é»˜è®¤ 400)
    // K = ç³»æ•° (é»˜è®¤ 50)
    // è¯¥å…¬å¼ç¡®ä¿æŠ¤ç”²æ”¶ç›Šé€’å‡ï¼Œé˜²æ­¢æ— é™å †å 
    
    var denominator = armor + _options.DamageReduction.ConstantC + 
                     _options.DamageReduction.CoefficientK * attackerLevel;
    
    var reduction = armor / denominator;
    
    // é™åˆ¶æœ€å¤§å‡ä¼¤ç‡ä¸º 75%
    return Math.Min(reduction, _options.ArmorCalculation.MaxArmorReduction);
}
```

#### æ­¥éª¤æ³¨é‡Š

```csharp
public async Task ProcessBattleAsync(Guid characterId)
{
    // 1. éªŒè¯å‚æ•°
    if (characterId == Guid.Empty)
        throw new ArgumentException("è§’è‰²IDä¸èƒ½ä¸ºç©º", nameof(characterId));
    
    // 2. åŠ è½½è§’è‰²æ•°æ®
    var character = await _repository.GetByIdAsync(characterId);
    if (character == null)
        throw new InvalidOperationException("è§’è‰²ä¸å­˜åœ¨");
    
    // 3. åˆå§‹åŒ–æˆ˜æ–—å¼•æ“
    var battle = _battleFactory.CreateBattle(character);
    
    // 4. æ‰§è¡Œæˆ˜æ–—å¾ªç¯
    while (!battle.IsCompleted)
    {
        battle.AdvanceTo(battle.CurrentTime + 1.0);
    }
    
    // 5. å‘æ”¾å¥–åŠ±
    await _rewardService.GrantRewardsAsync(characterId, battle.Rewards);
}
```

#### TODO æ³¨é‡Š

```csharp
// TODO: å®ç°è£…å¤‡å¥—è£…æ•ˆæœè®¡ç®—
// TODO: ä¼˜åŒ–å¤§è§„æ¨¡æˆ˜æ–—çš„æ€§èƒ½ - é¢„è®¡ Phase 11
// FIXME: ä¿®å¤æš´å‡»ç‡è®¡ç®—ç²¾åº¦é—®é¢˜
// NOTE: æ­¤å¤„é€»è¾‘ä¸å®¢æˆ·ç«¯åŒæ­¥ï¼Œä¿®æ”¹æ—¶éœ€åŒæ­¥æ›´æ–°
```

### æ³¨é‡ŠåŸåˆ™

âœ… **åº”è¯¥æ³¨é‡Š**:
- å¤æ‚çš„ä¸šåŠ¡é€»è¾‘
- ç‰¹æ®Šçš„ç®—æ³•å®ç°
- éæ˜¾è€Œæ˜“è§çš„è®¾è®¡å†³ç­–
- ä¸´æ—¶è§£å†³æ–¹æ¡ˆå’Œå¾…ä¼˜åŒ–é¡¹
- ä¸å…¶ä»–æ¨¡å—çš„äº¤äº’è¯´æ˜

âŒ **ä¸åº”æ³¨é‡Š**:
- æ˜¾è€Œæ˜“è§çš„ä»£ç ï¼ˆå¦‚ `// åˆ›å»ºå¯¹è±¡`ï¼‰
- é‡å¤ä»£ç çš„å†…å®¹ï¼ˆå¦‚æ–¹æ³•åå·²è¯´æ˜çš„å†…å®¹ï¼‰
- è¿‡æ—¶çš„æ³¨é‡Šï¼ˆä¿®æ”¹ä»£ç æ—¶åŠ¡å¿…æ›´æ–°æ³¨é‡Šï¼‰

---

## é¡¹ç›®ç»“æ„è§„èŒƒ

### ç›®å½•ç»„ç»‡

```
BlazorIdle.Server/
â”œâ”€â”€ Api/                          # API æ§åˆ¶å™¨
â”‚   â””â”€â”€ [Name]Controller.cs
â”œâ”€â”€ Application/                  # åº”ç”¨å±‚æœåŠ¡
â”‚   â”œâ”€â”€ [Feature]/
â”‚   â”‚   â”œâ”€â”€ [Name]Service.cs
â”‚   â”‚   â””â”€â”€ I[Name]Service.cs
â”‚   â””â”€â”€ Abstractions/
â”œâ”€â”€ Domain/                       # é¢†åŸŸå±‚
â”‚   â”œâ”€â”€ [Aggregate]/
â”‚   â”‚   â”œâ”€â”€ [Entity].cs
â”‚   â”‚   â”œâ”€â”€ [ValueObject].cs
â”‚   â”‚   â””â”€â”€ Services/
â”‚   â”‚       â””â”€â”€ [DomainService].cs
â”œâ”€â”€ Infrastructure/               # åŸºç¡€è®¾æ–½å±‚
â”‚   â”œâ”€â”€ Configuration/            # é…ç½®é€‰é¡¹ç±»
â”‚   â”‚   â””â”€â”€ [Feature]Options.cs
â”‚   â”œâ”€â”€ DependencyInjection/
â”‚   â”‚   â””â”€â”€ DependencyInjection.cs
â”‚   â”œâ”€â”€ Persistence/
â”‚   â”‚   â”œâ”€â”€ Configurations/
â”‚   â”‚   â”‚   â””â”€â”€ [Entity]Configuration.cs
â”‚   â”‚   â””â”€â”€ Repositories/
â”‚   â”‚       â””â”€â”€ [Entity]Repository.cs
â”‚   â””â”€â”€ Startup/
â”œâ”€â”€ Hubs/                         # SignalR Hubs
â”‚   â””â”€â”€ [Name]Hub.cs
â””â”€â”€ Config/                       # é…ç½®æ–‡ä»¶ç›®å½•
    â””â”€â”€ [Feature]/
        â””â”€â”€ [ConfigFile].json
```

### æ–‡ä»¶ç»„ç»‡è§„åˆ™

1. **ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªç±»**: æ¯ä¸ªæ–‡ä»¶åªåŒ…å«ä¸€ä¸ªä¸»è¦ç±»
2. **æ–‡ä»¶åä¸ç±»åä¸€è‡´**: `CharacterService.cs` â†’ `class CharacterService`
3. **ç›¸å…³æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•**: å¦‚ `Character.cs` å’Œ `CharacterConfiguration.cs`
4. **ä½¿ç”¨å‘½åç©ºé—´å¯¹åº”ç›®å½•ç»“æ„**: `BlazorIdle.Domain.Combat` â†’ `Domain/Combat/`

---

## é…ç½®åŒ–è§„èŒƒ

### Phase 8 ç¡®ç«‹çš„é…ç½®åŒ–åŸåˆ™

åŸºäº Phase 8 çš„æˆåŠŸå®è·µï¼Œåˆ¶å®šä»¥ä¸‹é…ç½®åŒ–è§„èŒƒï¼š

#### 1. é…ç½®ç±»å‘½å

```csharp
// âœ… æ¨è - Options åç¼€
public class CombatEngineOptions { }
public class EquipmentSystemOptions { }

// âŒ é¿å…
public class CombatEngineConfig { }
public class CombatEngineSettings { }
```

#### 2. é…ç½®ç±»ç»“æ„

```csharp
/// <summary>
/// æˆ˜æ–—å¼•æ“é…ç½®é€‰é¡¹
/// </summary>
public class CombatEngineOptions
{
    /// <summary>
    /// è¿œæœªæ¥æ—¶é—´æˆ³ï¼Œç”¨äºæ ‡è®°æœªæ¿€æ´»çš„äº‹ä»¶
    /// </summary>
    public double FarFutureTimestamp { get; set; } = 1e10;
    
    /// <summary>
    /// æŠ€èƒ½æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰
    /// </summary>
    public double SkillCheckIntervalSeconds { get; set; } = 0.5;
    
    /// <summary>
    /// ä¼¤å®³å‡å…å‚æ•°
    /// </summary>
    public DamageReductionOptions DamageReduction { get; set; } = new();
}

/// <summary>
/// ä¼¤å®³å‡å…é…ç½®é€‰é¡¹
/// </summary>
public class DamageReductionOptions
{
    /// <summary>
    /// ä¼¤å®³å‡å…ç³»æ•°K
    /// </summary>
    public double CoefficientK { get; set; } = 50.0;
    
    /// <summary>
    /// ä¼¤å®³å‡å…å¸¸é‡C
    /// </summary>
    public double ConstantC { get; set; } = 400.0;
}
```

**è§„èŒƒè¦ç‚¹**:
- æ‰€æœ‰å±æ€§éƒ½æœ‰ XML æ³¨é‡Š
- æä¾›åˆç†çš„é»˜è®¤å€¼
- ä½¿ç”¨é©¼å³°å‘½åæ³•ï¼ˆPascalCaseï¼‰
- åµŒå¥—é…ç½®ä½¿ç”¨ç‹¬ç«‹çš„ Options ç±»

#### 3. é…ç½®æ³¨å†Œ

```csharp
// Infrastructure/DependencyInjection/DependencyInjection.cs
public static IServiceCollection AddCombatEngine(
    this IServiceCollection services,
    IConfiguration configuration)
{
    // æ³¨å†Œé…ç½®
    services.Configure<CombatEngineOptions>(
        configuration.GetSection("CombatEngine"));
    
    // æ³¨å†ŒæœåŠ¡
    services.AddScoped<IBattleEngine, BattleEngine>();
    
    return services;
}
```

#### 4. é…ç½®ä½¿ç”¨

```csharp
public class BattleEngine
{
    private readonly CombatEngineOptions _options;
    
    public BattleEngine(IOptions<CombatEngineOptions> options)
    {
        _options = options.Value;
    }
    
    public void Initialize()
    {
        // ä½¿ç”¨é…ç½®å€¼
        var farFuture = _options.FarFutureTimestamp;
        var interval = _options.SkillCheckIntervalSeconds;
    }
}
```

#### 5. é…ç½®æ–‡ä»¶

```json
{
  "CombatEngine": {
    "FarFutureTimestamp": 1e10,
    "SkillCheckIntervalSeconds": 0.5,
    "BuffTickIntervalSeconds": 1.0,
    "BaseAttackDamage": 10,
    "DefaultAttackerLevel": 50,
    "DamageReduction": {
      "CoefficientK": 50.0,
      "ConstantC": 400.0
    }
  }
}
```

**é…ç½®æ–‡ä»¶è§„èŒƒ**:
- ä½¿ç”¨é©¼å³°å‘½åï¼ˆPascalCaseï¼‰
- ä¿æŒç»“æ„æ¸…æ™°ï¼Œé€‚å½“åµŒå¥—
- æ·»åŠ æ³¨é‡Šè¯´æ˜ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡

#### 6. é¿å…ç¡¬ç¼–ç 

```csharp
// âŒ é¿å… - ç¡¬ç¼–ç 
private const double FAR_FUTURE = 1e10;
private const double SKILL_CHECK_INTERVAL = 0.5;

// âœ… æ¨è - ä½¿ç”¨é…ç½®
private readonly CombatEngineOptions _options;

public void Method()
{
    var farFuture = _options.FarFutureTimestamp;
    var interval = _options.SkillCheckIntervalSeconds;
}
```

**Phase 8 æˆæœ**: 16ä¸ªç¡¬ç¼–ç å¸¸é‡å·²å…¨éƒ¨è¿ç§»åˆ°é…ç½®æ–‡ä»¶ âœ…

### ä½•æ—¶éœ€è¦é…ç½®åŒ–

éœ€è¦é…ç½®åŒ–çš„å‚æ•°ï¼š
- âœ… æ•°å€¼å¹³è¡¡å‚æ•°ï¼ˆä¼¤å®³ç³»æ•°ã€å†·å´æ—¶é—´ç­‰ï¼‰
- âœ… ç³»ç»Ÿè¡Œä¸ºå¼€å…³ï¼ˆå¯ç”¨/ç¦ç”¨æŸåŠŸèƒ½ï¼‰
- âœ… æ€§èƒ½è°ƒä¼˜å‚æ•°ï¼ˆç¼“å­˜æ—¶é•¿ã€æ‰¹å¤„ç†å¤§å°ç­‰ï¼‰
- âœ… ç¯å¢ƒç›¸å…³å‚æ•°ï¼ˆæ•°æ®åº“è¿æ¥ã€API ç«¯ç‚¹ç­‰ï¼‰
- âœ… ä¸šåŠ¡è§„åˆ™å‚æ•°ï¼ˆè´­ä¹°é™åˆ¶ã€åˆ·æ–°é—´éš”ç­‰ï¼‰

ä¸éœ€è¦é…ç½®åŒ–çš„å‚æ•°ï¼š
- âŒ å¸¸é‡å®šä¹‰ï¼ˆå¦‚æšä¸¾å€¼ã€å›ºå®šå­—ç¬¦ä¸²ï¼‰
- âŒ ç®—æ³•å†…éƒ¨ä¸´æ—¶å˜é‡
- âŒ æ¡†æ¶è¦æ±‚çš„é­”æ³•å€¼

---

## æµ‹è¯•è§„èŒƒ

### æµ‹è¯•å‘½å

```csharp
// âœ… æ¨è - [MethodName]_[Scenario]_[ExpectedBehavior]
[Fact]
public void CalculateDamage_WithHighArmor_ReducesDamageCorrectly()
{
    // Arrange
    var calculator = new DamageCalculator(_options);
    var armor = 1000;
    
    // Act
    var reduction = calculator.CalculateArmorReduction(armor, 50);
    
    // Assert
    Assert.InRange(reduction, 0.0, 0.75);
}

[Fact]
public void GetCharacter_WithInvalidId_ThrowsArgumentException()
{
    // Arrange
    var service = new CharacterService(_repository);
    
    // Act & Assert
    Assert.ThrowsAsync<ArgumentException>(() => 
        service.GetCharacterAsync(Guid.Empty));
}
```

### æµ‹è¯•ç»“æ„

ä½¿ç”¨ **AAA æ¨¡å¼** (Arrange-Act-Assert):

```csharp
[Fact]
public void ExampleTest()
{
    // Arrange - å‡†å¤‡æµ‹è¯•æ•°æ®å’Œå¯¹è±¡
    var service = new CharacterService(_repository);
    var characterId = Guid.NewGuid();
    
    // Act - æ‰§è¡Œè¢«æµ‹è¯•çš„æ–¹æ³•
    var result = service.GetCharacter(characterId);
    
    // Assert - éªŒè¯ç»“æœ
    Assert.NotNull(result);
    Assert.Equal(characterId, result.Id);
}
```

### æµ‹è¯•è¦†ç›–

- **å•å…ƒæµ‹è¯•**: è¦†ç›–æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- **é›†æˆæµ‹è¯•**: è¦†ç›–æ¨¡å—é—´äº¤äº’
- **å›å½’æµ‹è¯•**: é˜²æ­¢å·²ä¿®å¤çš„bugå†æ¬¡å‡ºç°

**ç›®æ ‡**: ä¿æŒ 330+ æµ‹è¯•å…¨éƒ¨é€šè¿‡ âœ…

---

## Git æäº¤è§„èŒƒ

### æäº¤æ¶ˆæ¯æ ¼å¼

```
<type>(<scope>): <subject>

<body>

<footer>
```

### Type ç±»å‹

| ç±»å‹ | è¯´æ˜ |
|-----|------|
| feat | æ–°åŠŸèƒ½ |
| fix | Bugä¿®å¤ |
| docs | æ–‡æ¡£æ›´æ–° |
| style | ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰ |
| refactor | é‡æ„ï¼ˆä¸æ”¹å˜åŠŸèƒ½ï¼‰ |
| test | æµ‹è¯•ç›¸å…³ |
| chore | æ„å»º/å·¥å…·é“¾æ›´æ–° |
| perf | æ€§èƒ½ä¼˜åŒ– |

### ç¤ºä¾‹

```
feat(combat): æ·»åŠ æˆ˜æ–—å¼•æ“é…ç½®åŒ–æ”¯æŒ

- åˆ›å»º CombatEngineOptions é…ç½®ç±»
- è¿ç§» 7 ä¸ªç¡¬ç¼–ç å¸¸é‡åˆ°é…ç½®æ–‡ä»¶
- æ›´æ–° BattleEngine ä½¿ç”¨é…ç½®æ³¨å…¥
- æ·»åŠ é…ç½®éªŒè¯å’Œé»˜è®¤å€¼

Phase 8 - æˆ˜æ–—å¼•æ“é…ç½®åŒ–
```

```
fix(equipment): ä¿®å¤æŠ¤ç”²å‡ä¼¤è®¡ç®—ç²¾åº¦é—®é¢˜

æŠ¤ç”²å‡ä¼¤å…¬å¼åœ¨æç«¯å€¼æ—¶å‡ºç°ç²¾åº¦é—®é¢˜ï¼Œè°ƒæ•´ä¸ºä½¿ç”¨
double ç±»å‹å¹¶é™åˆ¶æœ€å¤§å‡ä¼¤ç‡ã€‚

Fixes #123
```

```
docs(phase9): æ·»åŠ å¼€å‘æ–‡æ¡£ - æ¶æ„æ¦‚è§ˆå’Œé…ç½®æŒ‡å—

Phase 9 å¼€å‘æ–‡æ¡£ç¼–å†™
```

### æäº¤åŸåˆ™

- âœ… æ¯æ¬¡æäº¤ä¸“æ³¨äºä¸€ä¸ªé—®é¢˜
- âœ… æäº¤æ¶ˆæ¯æ¸…æ™°æè¿°å˜æ›´å†…å®¹
- âœ… åŒ…å«ç›¸å…³çš„ Issue ç¼–å·
- âœ… å¤§åŠŸèƒ½åˆ†å¤šæ¬¡å°æäº¤
- âŒ é¿å…"WIP"ã€"fix"ç­‰æ¨¡ç³Šæ¶ˆæ¯
- âŒ é¿å…ä¸€æ¬¡æäº¤åŒ…å«å¤šä¸ªä¸ç›¸å…³çš„å˜æ›´

---

## Code Review æ¸…å•

### åŠŸèƒ½æ€§

- [ ] ä»£ç å®ç°äº†éœ€æ±‚çš„åŠŸèƒ½
- [ ] è¾¹ç•Œæ¡ä»¶å’Œé”™è¯¯æƒ…å†µéƒ½å·²å¤„ç†
- [ ] æ²¡æœ‰å¼•å…¥æ–°çš„ Bug
- [ ] å·²æœ‰æµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] æ–°å¢åŠŸèƒ½æœ‰å¯¹åº”çš„æµ‹è¯•

### ä»£ç è´¨é‡

- [ ] ä»£ç æ¸…æ™°æ˜“è¯»
- [ ] å‘½åç¬¦åˆè§„èŒƒ
- [ ] æ²¡æœ‰é‡å¤ä»£ç 
- [ ] æ²¡æœ‰è¿‡é•¿çš„æ–¹æ³•ï¼ˆå»ºè®® < 50 è¡Œï¼‰
- [ ] æ²¡æœ‰è¿‡æ·±çš„åµŒå¥—ï¼ˆå»ºè®® < 4 å±‚ï¼‰
- [ ] åˆç†ä½¿ç”¨è®¾è®¡æ¨¡å¼

### æ³¨é‡Šå’Œæ–‡æ¡£

- [ ] å…¬å…± API æœ‰ XML æ–‡æ¡£æ³¨é‡Š
- [ ] å¤æ‚é€»è¾‘æœ‰å¿…è¦çš„ä»£ç æ³¨é‡Š
- [ ] æ³¨é‡Šå‡†ç¡®ä¸”æœ€æ–°
- [ ] ç›¸å…³æ–‡æ¡£å·²æ›´æ–°

### é…ç½®åŒ– (Phase 8+)

- [ ] æ²¡æœ‰æ–°çš„ç¡¬ç¼–ç å¸¸é‡
- [ ] é…ç½®ç±»ä½¿ç”¨ Options åç¼€
- [ ] é…ç½®æœ‰åˆç†çš„é»˜è®¤å€¼
- [ ] é…ç½®åœ¨ appsettings.json ä¸­å®šä¹‰
- [ ] é…ç½®å‚æ•°æœ‰æ–‡æ¡£è¯´æ˜

### æ€§èƒ½

- [ ] æ²¡æœ‰æ˜æ˜¾çš„æ€§èƒ½é—®é¢˜
- [ ] æ•°æ®åº“æŸ¥è¯¢å·²ä¼˜åŒ–
- [ ] é¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œåˆ†é…
- [ ] å¼‚æ­¥æ–¹æ³•æ­£ç¡®ä½¿ç”¨

### å®‰å…¨æ€§

- [ ] è¾“å…¥éªŒè¯å……åˆ†
- [ ] æ²¡æœ‰ SQL æ³¨å…¥é£é™©
- [ ] æ•æ„Ÿä¿¡æ¯æ²¡æœ‰ç¡¬ç¼–ç 
- [ ] æƒé™æ£€æŸ¥æ­£ç¡®

### å¯ç»´æŠ¤æ€§

- [ ] ä»£ç ç¬¦åˆé¡¹ç›®é£æ ¼
- [ ] ä¾èµ–æ³¨å…¥ä½¿ç”¨æ­£ç¡®
- [ ] é”™è¯¯å¤„ç†é€‚å½“
- [ ] æ—¥å¿—è®°å½•å……åˆ†

---

## æœ€ä½³å®è·µæ€»ç»“

### æ ¸å¿ƒåŸåˆ™

1. **é›¶åŠŸèƒ½æ”¹åŠ¨** - ä»£ç ä¼˜åŒ–ä¸æ”¹å˜ä¸šåŠ¡é€»è¾‘
2. **ç»´æŒä»£ç é£æ ¼** - éµå¾ªç°æœ‰å‘½åå’Œç»„ç»‡è§„èŒƒ
3. **æ¸è¿›å¼æ¨è¿›** - å°æ­¥å¿«è·‘ï¼Œåˆ†é˜¶æ®µéªŒæ”¶
4. **å®Œå–„æ–‡æ¡£** - ä»£ç å³æ–‡æ¡£ï¼Œæ–‡æ¡£ä¿æŒæ›´æ–°
5. **æµ‹è¯•ä¼˜å…ˆ** - ä¿®æ”¹å‰æµ‹è¯•é€šè¿‡ï¼Œä¿®æ”¹åæµ‹è¯•é€šè¿‡
6. **é…ç½®åŒ–ä¼˜å…ˆ** - é¿å…ç¡¬ç¼–ç ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶

### Phase 8 ç»éªŒæ€»ç»“

âœ… **æˆåŠŸå®è·µ**:
- Options åç¼€å‘½åç»Ÿä¸€ä¸”æ¸…æ™°
- é…ç½®ç±»æä¾›é»˜è®¤å€¼ï¼Œå‘åå…¼å®¹
- é©¼å³°å‘½åæ³•ï¼ˆPascalCaseï¼‰æ˜“äºç†è§£
- Infrastructure/Configuration ç›®å½•ç»„ç»‡æ¸…æ™°
- æ¯é˜¶æ®µæµ‹è¯•ï¼Œç¡®ä¿åŠŸèƒ½ä¸å˜

âœ… **å¯å¤ç”¨æ¨¡å¼**:
- é…ç½®ç±» + Options æ¨¡å¼
- ä¾èµ–æ³¨å…¥ + IOptions\<T>
- åµŒå¥—é…ç½®ç»“æ„
- XML æ–‡æ¡£æ³¨é‡Š
- å•å…ƒæµ‹è¯•è¦†ç›–

---

## ç›¸å…³æ–‡æ¡£

- [01-æ¶æ„æ¦‚è§ˆ.md](./01-æ¶æ„æ¦‚è§ˆ.md) - ç³»ç»Ÿæ¶æ„è®¾è®¡
- [07-é…ç½®æŒ‡å—.md](./07-é…ç½®æŒ‡å—.md) - é…ç½®å‚æ•°è¯´æ˜
- `docs/æœåŠ¡ç«¯ä»£ç ä¼˜åŒ–æ–¹æ¡ˆ.md` - æ•´ä½“ä¼˜åŒ–æ–¹æ¡ˆ
- `æœåŠ¡ç«¯ä»£ç ä¼˜åŒ–Phase8å®Œæˆæ€»ç»“.md` - Phase 8 æœ€ä½³å®è·µ

---

**æ–‡æ¡£ç»´æŠ¤**:  
æœ¬æ–‡æ¡£ä½œä¸º Phase 9 å¼€å‘æ–‡æ¡£çš„ä¸€éƒ¨åˆ†ï¼Œåº”éšé¡¹ç›®æ¼”è¿›æŒç»­æ›´æ–°ã€‚å›¢é˜Ÿæˆå‘˜åº”éµå¾ªæœ¬è§„èŒƒï¼Œå¹¶åœ¨å®è·µä¸­ä¸æ–­å®Œå–„ã€‚
