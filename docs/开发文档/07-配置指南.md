# BlazorIdle é…ç½®æŒ‡å—

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-15  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ  
**çŠ¶æ€**: Phase 9 å¼€å‘æ–‡æ¡£

---

## ğŸ“‹ ç›®å½•

1. [é…ç½®æ¦‚è¿°](#é…ç½®æ¦‚è¿°)
2. [é…ç½®æ–‡ä»¶ç»“æ„](#é…ç½®æ–‡ä»¶ç»“æ„)
3. [æ ¸å¿ƒé…ç½®èŠ‚](#æ ¸å¿ƒé…ç½®èŠ‚)
4. [ç¯å¢ƒç‰¹å®šé…ç½®](#ç¯å¢ƒç‰¹å®šé…ç½®)
5. [é…ç½®éªŒè¯](#é…ç½®éªŒè¯)
6. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## é…ç½®æ¦‚è¿°

BlazorIdle é‡‡ç”¨ ASP.NET Core çš„é…ç½®ç³»ç»Ÿï¼Œæ”¯æŒï¼š

- **å¤šé…ç½®æº**: JSON æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œå‚æ•°
- **ç¯å¢ƒåŒºåˆ†**: Developmentã€Productionã€Staging
- **çƒ­é‡è½½**: éƒ¨åˆ†é…ç½®æ”¯æŒè¿è¡Œæ—¶æ›´æ–°
- **å¼ºç±»å‹**: ä½¿ç”¨ Options æ¨¡å¼è¿›è¡Œç±»å‹å®‰å…¨çš„é…ç½®è®¿é—®
- **éªŒè¯**: é…ç½®åŠ è½½æ—¶è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿åˆæ³•æ€§

### é…ç½®æ–‡ä»¶ä½ç½®

```
BlazorIdle.Server/
â”œâ”€â”€ appsettings.json                      # åŸºç¡€é…ç½®ï¼ˆæ‰€æœ‰ç¯å¢ƒå…±äº«ï¼‰
â”œâ”€â”€ appsettings.Development.json          # å¼€å‘ç¯å¢ƒè¦†ç›–
â”œâ”€â”€ appsettings.Production.json           # ç”Ÿäº§ç¯å¢ƒè¦†ç›–
â””â”€â”€ appsettings.Development.example.json  # å¼€å‘é…ç½®ç¤ºä¾‹
```

### é…ç½®åŠ è½½é¡ºåº

1. `appsettings.json` - åŸºç¡€é…ç½®
2. `appsettings.{Environment}.json` - ç¯å¢ƒç‰¹å®šé…ç½®ï¼ˆè¦†ç›–åŸºç¡€é…ç½®ï¼‰
3. ç¯å¢ƒå˜é‡ - è¦†ç›–æ–‡ä»¶é…ç½®
4. å‘½ä»¤è¡Œå‚æ•° - æœ€é«˜ä¼˜å…ˆçº§

---

## é…ç½®æ–‡ä»¶ç»“æ„

### å®Œæ•´é…ç½®ç¤ºä¾‹

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=gamedata.db"
  },
  "Economy": { ... },
  "Combat": { ... },
  "CombatEngine": { ... },
  "CombatLoop": { ... },
  "Offline": { ... },
  "Jwt": { ... },
  "SignalR": { ... },
  "BattleMessages": { ... },
  "Shop": { ... },
  "Equipment": { ... },
  "Logging": { ... }
}
```

---

## æ ¸å¿ƒé…ç½®èŠ‚

### 1. ConnectionStrings - æ•°æ®åº“è¿æ¥

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=gamedata.db"
  }
}
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|-----|------|------|
| DefaultConnection | string | SQLite æ•°æ®åº“æ–‡ä»¶è·¯å¾„ |

**æ³¨æ„**: 
- å¼€å‘ç¯å¢ƒå»ºè®®ä½¿ç”¨ç›¸å¯¹è·¯å¾„
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–æŒä¹…åŒ–å·

---

### 2. Economy - ç»æµç³»ç»Ÿé…ç½®

```json
{
  "Economy": {
    "DefaultDropMode": "expected"
  }
}
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| DefaultDropMode | string | "expected" | æ‰è½æ¨¡å¼: "expected" æˆ– "random" |

**æ‰è½æ¨¡å¼è¯´æ˜**:
- `expected`: æœŸæœ›å€¼æ¨¡å¼ï¼Œè¿”å›æ•°å­¦æœŸæœ›å€¼
- `random`: éšæœºæ¨¡å¼ï¼Œæ¯æ¬¡éšæœºæ‰è½

---

### 3. Combat - æˆ˜æ–—ç³»ç»Ÿé…ç½®

```json
{
  "Combat": {
    "EnablePeriodicRewards": true,
    "RewardFlushIntervalSeconds": 10.0
  }
}
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| EnablePeriodicRewards | bool | true | æ˜¯å¦å¯ç”¨å‘¨æœŸæ€§å¥–åŠ±å‘æ”¾ |
| RewardFlushIntervalSeconds | double | 10.0 | å¥–åŠ±å‘æ”¾é—´éš”ï¼ˆç§’ï¼‰ |

**æ€§èƒ½å½±å“**:
- é—´éš”è¶ŠçŸ­ï¼Œå¥–åŠ±å‘æ”¾è¶ŠåŠæ—¶ï¼Œä½†æ€§èƒ½å¼€é”€è¶Šå¤§
- å»ºè®®ç”Ÿäº§ç¯å¢ƒè®¾ç½®ä¸º 10-30 ç§’

---

### 4. CombatEngine - æˆ˜æ–—å¼•æ“é…ç½® âœ… Phase 8

```json
{
  "CombatEngine": {
    "FarFutureTimestamp": 1e10,
    "SkillCheckIntervalSeconds": 0.5,
    "BuffTickIntervalSeconds": 1.0,
    "BaseAttackDamage": 10,
    "DefaultAttackerLevel": 50,
    "DamageReduction": {
      "CoefficientK": 50.0,
      "ConstantC": 400.0
    }
  }
}
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| FarFutureTimestamp | double | 1e10 | è¿œæœªæ¥æ—¶é—´æˆ³ï¼Œç”¨äºæ ‡è®°æœªæ¿€æ´»çš„äº‹ä»¶ |
| SkillCheckIntervalSeconds | double | 0.5 | æŠ€èƒ½æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰ï¼Œæ§åˆ¶æ•ŒäººæŠ€èƒ½è§¦å‘é¢‘ç‡ |
| BuffTickIntervalSeconds | double | 1.0 | Buffåˆ·æ–°é—´éš”ï¼ˆç§’ï¼‰ï¼Œæ§åˆ¶DoT/HoTå‘¨æœŸæ•ˆæœ |
| BaseAttackDamage | int | 10 | åŸºç¡€æ”»å‡»ä¼¤å®³ |
| DefaultAttackerLevel | int | 50 | é»˜è®¤æ”»å‡»è€…ç­‰çº§ï¼Œç”¨äºæŠ¤ç”²å‡ä¼¤è®¡ç®— |
| DamageReduction.CoefficientK | double | 50.0 | ä¼¤å®³å‡å…ç³»æ•°Kï¼ŒæŠ¤ç”²å‡ä¼¤å…¬å¼å‚æ•° |
| DamageReduction.ConstantC | double | 400.0 | ä¼¤å®³å‡å…å¸¸é‡Cï¼ŒæŠ¤ç”²å‡ä¼¤å…¬å¼å‚æ•° |

**ä¼¤å®³å‡å…å…¬å¼**:
```
å‡ä¼¤ç‡ = Armor / (Armor + C + K * AttackerLevel)
```

**è°ƒæ•´å»ºè®®**:
- è°ƒé«˜ K å’Œ C ä¼šé™ä½æŠ¤ç”²çš„å‡ä¼¤æ•ˆæœ
- è°ƒä½ K å’Œ C ä¼šå¢å¼ºæŠ¤ç”²çš„å‡ä¼¤æ•ˆæœ

**Phase 8 å®Œæˆ**: è¿™äº›å‚æ•°å·²ä»ç¡¬ç¼–ç è¿ç§»åˆ°é…ç½®æ–‡ä»¶ âœ…

---

### 5. CombatLoop - æˆ˜æ–—å¾ªç¯é…ç½®

```json
{
  "CombatLoop": {
    "AttackStartsWithFullInterval": true,
    "SpecialStartsWithFullInterval": true,
    "PauseAttackWhenNoEnemies": true,
    "PauseSpecialWhenNoEnemiesByDefault": true,
    "SpecialStartsImmediatelyAfterReviveByDefault": false,
    "LockTargetForAttackCycle": true
  }
}
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| AttackStartsWithFullInterval | bool | true | æ”»å‡»æ˜¯å¦ä»å®Œæ•´é—´éš”å¼€å§‹ |
| SpecialStartsWithFullInterval | bool | true | æŠ€èƒ½æ˜¯å¦ä»å®Œæ•´é—´éš”å¼€å§‹ |
| PauseAttackWhenNoEnemies | bool | true | æ— æ•Œäººæ—¶æš‚åœæ™®æ”» |
| PauseSpecialWhenNoEnemiesByDefault | bool | true | æ— æ•Œäººæ—¶æš‚åœæŠ€èƒ½ |
| SpecialStartsImmediatelyAfterReviveByDefault | bool | false | å¤æ´»åç«‹å³é‡Šæ”¾æŠ€èƒ½ |
| LockTargetForAttackCycle | bool | true | é”å®šæ”»å‡»ç›®æ ‡ |

---

### 6. Offline - ç¦»çº¿ç³»ç»Ÿé…ç½®

```json
{
  "Offline": {
    "OfflineDetectionSeconds": 60,
    "MaxOfflineSeconds": 43200,
    "AutoApplyRewards": true
  }
}
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| OfflineDetectionSeconds | int | 60 | ç¦»çº¿æ£€æµ‹é˜ˆå€¼ï¼ˆç§’ï¼‰ |
| MaxOfflineSeconds | int | 43200 | æœ€å¤§ç¦»çº¿è¡¥ç®—æ—¶é•¿ï¼ˆç§’ï¼Œ12å°æ—¶ï¼‰ |
| AutoApplyRewards | bool | true | è‡ªåŠ¨åº”ç”¨ç¦»çº¿å¥–åŠ± |

**ç¦»çº¿æ—¶é•¿é™åˆ¶**:
- é»˜è®¤æœ€å¤šè¡¥ç®— 12 å°æ—¶ç¦»çº¿æ—¶é—´
- è¶…è¿‡é™åˆ¶çš„æ—¶é—´ä¸ä¼šè·å¾—é¢å¤–æ”¶ç›Š
- é˜²æ­¢é•¿æœŸç¦»çº¿ç©å®¶è·å¾—è¿‡å¤šæ”¶ç›Š

---

### 7. Jwt - JWT è®¤è¯é…ç½®

```json
{
  "Jwt": {
    "SecretKey": "YourSecretKeyHere-ChangeThisInProduction-MustBeAtLeast32CharactersLong!",
    "Issuer": "BlazorIdle.Server",
    "Audience": "BlazorIdle.Client",
    "ExpirationMinutes": 1440
  }
}
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| SecretKey | string | - | JWTç­¾åå¯†é’¥ï¼ˆè‡³å°‘32å­—ç¬¦ï¼‰ |
| Issuer | string | BlazorIdle.Server | Token å‘è¡Œè€… |
| Audience | string | BlazorIdle.Client | Token å—ä¼— |
| ExpirationMinutes | int | 1440 | Token è¿‡æœŸæ—¶é—´ï¼ˆåˆ†é’Ÿï¼Œ24å°æ—¶ï¼‰ |

**âš ï¸ å®‰å…¨è­¦å‘Š**:
- **ç”Ÿäº§ç¯å¢ƒå¿…é¡»æ›´æ”¹ SecretKey**
- SecretKey åº”ä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²
- å»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨ SecretKey
- ä¸è¦å°† SecretKey æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

---

### 8. SignalR - å®æ—¶é€šä¿¡é…ç½®

```json
{
  "SignalR": {
    "HubEndpoint": "/hubs/battle",
    "EnableSignalR": true,
    "MaxReconnectAttempts": 5,
    "ReconnectBaseDelayMs": 1000,
    "MaxReconnectDelayMs": 30000,
    "EnableDetailedLogging": false,
    "ConnectionTimeoutSeconds": 30,
    "KeepAliveIntervalSeconds": 15,
    "ServerTimeoutSeconds": 30,
    "Notification": { ... },
    "Performance": { ... }
  }
}
```

#### è¿æ¥é…ç½®

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| HubEndpoint | string | /hubs/battle | SignalR Hub ç«¯ç‚¹ |
| EnableSignalR | bool | true | æ˜¯å¦å¯ç”¨ SignalR |
| MaxReconnectAttempts | int | 5 | æœ€å¤§é‡è¿æ¬¡æ•° |
| ReconnectBaseDelayMs | int | 1000 | åŸºç¡€é‡è¿å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ |
| MaxReconnectDelayMs | int | 30000 | æœ€å¤§é‡è¿å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ |
| EnableDetailedLogging | bool | false | è¯¦ç»†æ—¥å¿— |
| ConnectionTimeoutSeconds | int | 30 | è¿æ¥è¶…æ—¶ |
| KeepAliveIntervalSeconds | int | 15 | ä¿æ´»é—´éš” |
| ServerTimeoutSeconds | int | 30 | æœåŠ¡å™¨è¶…æ—¶ |

#### é€šçŸ¥é…ç½®

```json
{
  "SignalR": {
    "Notification": {
      "EnablePlayerDeathNotification": true,
      "EnablePlayerReviveNotification": true,
      "EnableEnemyKilledNotification": true,
      "EnableTargetSwitchedNotification": true,
      "EnableWaveSpawnNotification": false,
      "EnableSkillCastNotification": false,
      "EnableBuffChangeNotification": false,
      "EnableAttackStartedNotification": true,
      "EnableEnemyAttackStartedNotification": true,
      "EnableDamageAppliedNotification": true,
      "EnableDamageReceivedNotification": true
    }
  }
}
```

**é€šçŸ¥å¼€å…³è¯´æ˜**:
- å¯å•ç‹¬æ§åˆ¶æ¯ç§é€šçŸ¥çš„å¯ç”¨çŠ¶æ€
- å…³é—­ä¸å¿…è¦çš„é€šçŸ¥å¯å‡å°‘ç½‘ç»œæµé‡
- å»ºè®®ä¿ç•™å…³é”®é€šçŸ¥ï¼ˆæ­»äº¡ã€å‡»æ€ã€ä¼¤å®³ï¼‰

#### æ€§èƒ½é…ç½®

```json
{
  "SignalR": {
    "Performance": {
      "EnableThrottling": false,
      "ThrottleWindowMs": 1000,
      "EnableBatching": false,
      "BatchDelayMs": 100,
      "AutoDegradeOnMobile": false
    }
  }
}
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| EnableThrottling | bool | false | å¯ç”¨æ¶ˆæ¯èŠ‚æµ |
| ThrottleWindowMs | int | 1000 | èŠ‚æµçª—å£ï¼ˆæ¯«ç§’ï¼‰ |
| EnableBatching | bool | false | å¯ç”¨æ¶ˆæ¯æ‰¹å¤„ç† |
| BatchDelayMs | int | 100 | æ‰¹å¤„ç†å»¶è¿Ÿï¼ˆæ¯«ç§’ï¼‰ |
| AutoDegradeOnMobile | bool | false | ç§»åŠ¨ç«¯è‡ªåŠ¨é™çº§ |

---

### 9. BattleMessages - æˆ˜æ–—æ¶ˆæ¯é…ç½®

```json
{
  "BattleMessages": {
    "AttackStartedTemplate": "{attacker} å¼€å§‹æ”»å‡» {target}",
    "DamageDealtTemplate": "{attacker} å¯¹ {target} é€ æˆ {damage} ç‚¹ä¼¤å®³{critSuffix}",
    "CritSuffix": "ï¼ˆæš´å‡»ï¼‰",
    "DamageReceivedTemplate": "{target} å—åˆ°æ¥è‡ª {attacker} çš„ {damage} ç‚¹ä¼¤å®³",
    "EnemyAttackStartedTemplate": "{attacker} å¼€å§‹æ”»å‡» {target}",
    "EnableAttackStartedEvent": true,
    "EnableDamageDealtEvent": true,
    "EnableDamageReceivedEvent": true,
    "EnableEnemyAttackStartedEvent": true,
    "PlayerName": "ç©å®¶",
    "MaxMessageHistory": 100
  }
}
```

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| AttackStartedTemplate | string | - | æ”»å‡»å¼€å§‹æ¶ˆæ¯æ¨¡æ¿ |
| DamageDealtTemplate | string | - | ä¼¤å®³é€ æˆæ¶ˆæ¯æ¨¡æ¿ |
| CritSuffix | string | ï¼ˆæš´å‡»ï¼‰ | æš´å‡»åç¼€ |
| PlayerName | string | ç©å®¶ | ç©å®¶æ˜¾ç¤ºåç§° |
| MaxMessageHistory | int | 100 | æœ€å¤§æ¶ˆæ¯å†å²è®°å½•æ•° |

**æ¨¡æ¿å˜é‡**:
- `{attacker}`: æ”»å‡»è€…åç§°
- `{target}`: ç›®æ ‡åç§°
- `{damage}`: ä¼¤å®³æ•°å€¼
- `{critSuffix}`: æš´å‡»åç¼€ï¼ˆä»…æš´å‡»æ—¶ï¼‰

---

### 10. Shop - å•†åº—ç³»ç»Ÿé…ç½®

```json
{
  "Shop": {
    "EnableCaching": true,
    "ShopDefinitionCacheMinutes": 60,
    "ShopItemsCacheMinutes": 30,
    "ConfigPath": "Config/Shop",
    "ShopDefinitionsFile": "ShopDefinitions.json",
    "ShopItemsFile": "ShopItems.json",
    "DefaultRefreshIntervalSeconds": 3600,
    "MaxShopNameLength": 50,
    "MaxShopDescriptionLength": 200,
    "MaxItemNameLength": 100,
    "MaxItemDescriptionLength": 500,
    "UnlimitedStock": -1,
    "DailyResetSeconds": 86400,
    "WeeklyResetSeconds": 604800,
    "DefaultDailyLimit": 10,
    "DefaultWeeklyLimit": 5,
    "MinPriceAmount": 1,
    "MaxPriceAmount": 1000000,
    "MinLevelRequirement": 1,
    "MaxLevelRequirement": 100,
    "MinPurchaseQuantity": 1,
    "MaxPurchaseQuantity": 999,
    "DefaultPageSize": 20,
    "MaxPageSize": 100,
    "PurchaseHistoryDefaultDays": 30
  }
}
```

#### ç¼“å­˜é…ç½®

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| EnableCaching | bool | true | å¯ç”¨ç¼“å­˜ |
| ShopDefinitionCacheMinutes | int | 60 | å•†åº—å®šä¹‰ç¼“å­˜æ—¶é•¿ |
| ShopItemsCacheMinutes | int | 30 | å•†å“ç¼“å­˜æ—¶é•¿ |

#### æ–‡ä»¶é…ç½®

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| ConfigPath | string | Config/Shop | é…ç½®æ–‡ä»¶ç›®å½• |
| ShopDefinitionsFile | string | ShopDefinitions.json | å•†åº—å®šä¹‰æ–‡ä»¶ |
| ShopItemsFile | string | ShopItems.json | å•†å“æ–‡ä»¶ |

#### ä¸šåŠ¡è§„åˆ™

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| DefaultRefreshIntervalSeconds | int | 3600 | é»˜è®¤åˆ·æ–°é—´éš”ï¼ˆ1å°æ—¶ï¼‰ |
| UnlimitedStock | int | -1 | æ— é™åº“å­˜æ ‡è¯† |
| DailyResetSeconds | int | 86400 | æ—¥å¸¸é‡ç½®é—´éš”ï¼ˆ24å°æ—¶ï¼‰ |
| WeeklyResetSeconds | int | 604800 | å‘¨å¸¸é‡ç½®é—´éš”ï¼ˆ7å¤©ï¼‰ |
| DefaultDailyLimit | int | 10 | é»˜è®¤æ¯æ—¥è´­ä¹°é™åˆ¶ |
| DefaultWeeklyLimit | int | 5 | é»˜è®¤æ¯å‘¨è´­ä¹°é™åˆ¶ |

#### éªŒè¯è§„åˆ™

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| MaxShopNameLength | int | 50 | å•†åº—åç§°æœ€å¤§é•¿åº¦ |
| MaxShopDescriptionLength | int | 200 | å•†åº—æè¿°æœ€å¤§é•¿åº¦ |
| MaxItemNameLength | int | 100 | å•†å“åç§°æœ€å¤§é•¿åº¦ |
| MaxItemDescriptionLength | int | 500 | å•†å“æè¿°æœ€å¤§é•¿åº¦ |
| MinPriceAmount | int | 1 | æœ€å°ä»·æ ¼ |
| MaxPriceAmount | int | 1000000 | æœ€å¤§ä»·æ ¼ |
| MinLevelRequirement | int | 1 | æœ€å°ç­‰çº§è¦æ±‚ |
| MaxLevelRequirement | int | 100 | æœ€å¤§ç­‰çº§è¦æ±‚ |
| MinPurchaseQuantity | int | 1 | æœ€å°è´­ä¹°æ•°é‡ |
| MaxPurchaseQuantity | int | 999 | æœ€å¤§è´­ä¹°æ•°é‡ |

**å‚è€ƒæ–‡æ¡£**: `docs/å•†åº—ç³»ç»Ÿä¼˜åŒ–æ€»ç»“-Phase1-4å®Œæ•´æŠ¥å‘Š.md`

---

### 11. Equipment - è£…å¤‡ç³»ç»Ÿé…ç½® âœ… Phase 8

```json
{
  "Equipment": {
    "ArmorCalculation": {
      "ArmorConstant": 400.0,
      "MaxArmorReduction": 0.75,
      "ShieldArmorMultiplier": 2.25
    },
    "BlockCalculation": {
      "BaseBlockChance": 0.05,
      "BlockDamageReduction": 0.30,
      "BlockChancePerStrength": 0.001,
      "BlockChancePerItemLevel": 0.002,
      "MaxBlockChance": 0.50
    },
    "WeaponDamage": {
      "OffHandDamageCoefficient": 0.85
    }
  }
}
```

#### æŠ¤ç”²è®¡ç®—

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| ArmorConstant | double | 400.0 | æŠ¤ç”²å‡ä¼¤å¸¸æ•° |
| MaxArmorReduction | double | 0.75 | æœ€å¤§æŠ¤ç”²å‡ä¼¤ç‡ï¼ˆ75%ï¼‰ |
| ShieldArmorMultiplier | double | 2.25 | ç›¾ç‰ŒæŠ¤ç”²ç³»æ•° |

**æŠ¤ç”²å‡ä¼¤å…¬å¼**:
```
å‡ä¼¤ç‡ = min(Armor / (Armor + ArmorConstant), MaxArmorReduction)
```

#### æ ¼æŒ¡è®¡ç®—

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| BaseBlockChance | double | 0.05 | åŸºç¡€æ ¼æŒ¡ç‡ï¼ˆ5%ï¼‰ |
| BlockDamageReduction | double | 0.30 | æ ¼æŒ¡å‡ä¼¤ï¼ˆ30%ï¼‰ |
| BlockChancePerStrength | double | 0.001 | æ¯ç‚¹åŠ›é‡å¢åŠ æ ¼æŒ¡ç‡ |
| BlockChancePerItemLevel | double | 0.002 | æ¯çº§ç‰©å“ç­‰çº§å¢åŠ æ ¼æŒ¡ç‡ |
| MaxBlockChance | double | 0.50 | æœ€å¤§æ ¼æŒ¡ç‡ï¼ˆ50%ï¼‰ |

**æ ¼æŒ¡ç‡è®¡ç®—**:
```
æ ¼æŒ¡ç‡ = min(
  BaseBlockChance + 
  Strength * BlockChancePerStrength + 
  ItemLevel * BlockChancePerItemLevel,
  MaxBlockChance
)
```

#### æ­¦å™¨ä¼¤å®³

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| OffHandDamageCoefficient | double | 0.85 | å‰¯æ‰‹ä¼¤å®³ç³»æ•°ï¼ˆ85%ï¼‰ |

**å‰¯æ‰‹ä¼¤å®³è®¡ç®—**:
```
å‰¯æ‰‹ä¼¤å®³ = æ­¦å™¨åŸºç¡€ä¼¤å®³ * OffHandDamageCoefficient
```

**Phase 8 å®Œæˆ**: è¿™äº›å‚æ•°å·²ä»ç¡¬ç¼–ç è¿ç§»åˆ°é…ç½®æ–‡ä»¶ âœ…

---

### 12. Logging - æ—¥å¿—é…ç½®

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  }
}
```

| å‚æ•° | ç±»å‹ | å¯é€‰å€¼ | è¯´æ˜ |
|-----|------|--------|------|
| LogLevel.Default | string | Trace/Debug/Information/Warning/Error/Critical/None | é»˜è®¤æ—¥å¿—çº§åˆ« |
| LogLevel.Microsoft.AspNetCore | string | åŒä¸Š | ASP.NET Core æ—¥å¿—çº§åˆ« |

**æ—¥å¿—çº§åˆ«è¯´æ˜**:
- `Trace`: æœ€è¯¦ç»†ï¼ŒåŒ…å«æ‰€æœ‰ä¿¡æ¯
- `Debug`: è°ƒè¯•ä¿¡æ¯
- `Information`: ä¸€èˆ¬ä¿¡æ¯
- `Warning`: è­¦å‘Šä¿¡æ¯
- `Error`: é”™è¯¯ä¿¡æ¯
- `Critical`: ä¸¥é‡é”™è¯¯
- `None`: ç¦ç”¨æ—¥å¿—

---

## ç¯å¢ƒç‰¹å®šé…ç½®

### Development ç¯å¢ƒ

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Debug",
      "Microsoft.AspNetCore": "Information"
    }
  },
  "SignalR": {
    "EnableDetailedLogging": true
  }
}
```

**å¼€å‘ç¯å¢ƒç‰¹ç‚¹**:
- æ›´è¯¦ç»†çš„æ—¥å¿—è¾“å‡º
- å¯ç”¨ SignalR è¯¦ç»†æ—¥å¿—
- è¾ƒçŸ­çš„ç¼“å­˜æ—¶é—´ä¾¿äºæµ‹è¯•

### Production ç¯å¢ƒ

```json
{
  "Logging": {
    "LogLevel": {
      "Default": "Warning",
      "Microsoft.AspNetCore": "Error"
    }
  },
  "Jwt": {
    "SecretKey": "ä½¿ç”¨ç¯å¢ƒå˜é‡è®¾ç½®"
  },
  "SignalR": {
    "EnableDetailedLogging": false,
    "Performance": {
      "EnableThrottling": true,
      "EnableBatching": true
    }
  }
}
```

**ç”Ÿäº§ç¯å¢ƒç‰¹ç‚¹**:
- ä»…è®°å½•è­¦å‘Šå’Œé”™è¯¯
- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- å¯ç”¨æ€§èƒ½ä¼˜åŒ–ï¼ˆèŠ‚æµã€æ‰¹å¤„ç†ï¼‰

### ä½¿ç”¨ç¯å¢ƒå˜é‡

```bash
# Linux/macOS
export Jwt__SecretKey="your-production-secret-key"
export ConnectionStrings__DefaultConnection="/data/gamedata.db"

# Windows
set Jwt__SecretKey=your-production-secret-key
set ConnectionStrings__DefaultConnection=C:\data\gamedata.db
```

**æ³¨æ„**: ç¯å¢ƒå˜é‡ä½¿ç”¨åŒä¸‹åˆ’çº¿ `__` è¡¨ç¤ºå±‚çº§å…³ç³»

---

## é…ç½®éªŒè¯

### å¯åŠ¨æ—¶éªŒè¯

é…ç½®åœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨éªŒè¯ï¼Œç¡®ä¿ï¼š

1. å¿…éœ€å‚æ•°å­˜åœ¨
2. æ•°å€¼åœ¨åˆç†èŒƒå›´å†…
3. æ–‡ä»¶è·¯å¾„æœ‰æ•ˆ
4. æ ¼å¼æ­£ç¡®

### éªŒè¯å¤±è´¥å¤„ç†

å¦‚æœé…ç½®éªŒè¯å¤±è´¥ï¼Œåº”ç”¨å°†ï¼š
1. è®°å½•è¯¦ç»†é”™è¯¯ä¿¡æ¯
2. ä½¿ç”¨é»˜è®¤å€¼ï¼ˆå¦‚æœå¯ç”¨ï¼‰
3. æŠ›å‡ºå¼‚å¸¸å¹¶æ‹’ç»å¯åŠ¨ï¼ˆä¸¥é‡é”™è¯¯ï¼‰

### è‡ªå®šä¹‰éªŒè¯

```csharp
// åœ¨ DependencyInjection.cs ä¸­æ·»åŠ éªŒè¯
services.AddOptions<CombatEngineOptions>()
    .Bind(configuration.GetSection("CombatEngine"))
    .ValidateDataAnnotations()
    .ValidateOnStart();
```

---

## æœ€ä½³å®è·µ

### 1. é…ç½®æ–‡ä»¶ç®¡ç†

âœ… **æ¨èåšæ³•**:
- å°† `appsettings.Development.json` æ·»åŠ åˆ° `.gitignore`
- æä¾› `appsettings.Development.example.json` ä½œä¸ºç¤ºä¾‹
- æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡

âŒ **é¿å…åšæ³•**:
- å°†ç”Ÿäº§ç¯å¢ƒå¯†é’¥æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- åœ¨ä»£ç ä¸­ç¡¬ç¼–ç é…ç½®å€¼
- æ‰€æœ‰ç¯å¢ƒä½¿ç”¨ç›¸åŒé…ç½®

### 2. å‚æ•°è°ƒæ•´

âœ… **æ¨èåšæ³•**:
- å°æ­¥è°ƒæ•´ï¼Œé€æ­¥éªŒè¯
- è®°å½•æ¯æ¬¡è°ƒæ•´åŠå…¶å½±å“
- å¤‡ä»½åŸå§‹é…ç½®

âŒ **é¿å…åšæ³•**:
- å¤§å¹…åº¦ä¿®æ”¹å¤šä¸ªå‚æ•°
- æœªç»æµ‹è¯•ç›´æ¥åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒ
- è°ƒæ•´åä¸éªŒè¯å½±å“

### 3. æ€§èƒ½ä¼˜åŒ–

âœ… **æ¨èåšæ³•**:
- æ ¹æ®å®é™…è´Ÿè½½è°ƒæ•´ç¼“å­˜æ—¶é—´
- ç›‘æ§é…ç½®è°ƒæ•´çš„æ€§èƒ½å½±å“
- ä½¿ç”¨æ€§èƒ½é…ç½®ï¼ˆèŠ‚æµã€æ‰¹å¤„ç†ï¼‰

âŒ **é¿å…åšæ³•**:
- æ— é™åˆ¶å¢åŠ ç¼“å­˜æ—¶é—´
- å…³é—­æ‰€æœ‰é€šçŸ¥ä»¥"æå‡æ€§èƒ½"
- ä¸ç›‘æ§å°±ç›²ç›®ä¼˜åŒ–

### 4. å®‰å…¨æ€§

âœ… **æ¨èåšæ³•**:
- JWT SecretKey ä½¿ç”¨å¼ºéšæœºå­—ç¬¦ä¸²
- ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨å¯†é’¥
- å®šæœŸæ›´æ¢å¯†é’¥

âŒ **é¿å…åšæ³•**:
- ä½¿ç”¨é»˜è®¤æˆ–å¼±å¯†é’¥
- å°†å¯†é’¥ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
- å¤šç¯å¢ƒå…±äº«å¯†é’¥

---

## å¸¸è§é—®é¢˜

### Q1: ä¿®æ”¹é…ç½®åéœ€è¦é‡æ–°ç¼–è¯‘å—ï¼Ÿ

**A**: ä¸éœ€è¦ã€‚åªéœ€ä¿®æ”¹ `appsettings.json` å¹¶é‡å¯åº”ç”¨å³å¯ã€‚

éƒ¨åˆ†é…ç½®æ”¯æŒçƒ­é‡è½½ï¼ˆæ— éœ€é‡å¯ï¼‰ï¼Œä½†å¤§å¤šæ•°é…ç½®éœ€è¦é‡å¯åº”ç”¨æ‰èƒ½ç”Ÿæ•ˆã€‚

---

### Q2: å¦‚ä½•åœ¨ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒé…ç½®ï¼Ÿ

**A**: ä½¿ç”¨ç¯å¢ƒç‰¹å®šé…ç½®æ–‡ä»¶ï¼š

1. åˆ›å»º `appsettings.{Environment}.json`
2. è®¾ç½®ç¯å¢ƒå˜é‡ `ASPNETCORE_ENVIRONMENT`
3. ç¯å¢ƒç‰¹å®šé…ç½®ä¼šè‡ªåŠ¨è¦†ç›–åŸºç¡€é…ç½®

ç¤ºä¾‹ï¼š
```bash
# å¼€å‘ç¯å¢ƒ
export ASPNETCORE_ENVIRONMENT=Development

# ç”Ÿäº§ç¯å¢ƒ
export ASPNETCORE_ENVIRONMENT=Production
```

---

### Q3: Phase 8 é…ç½®åŒ–çš„å‚æ•°åœ¨å“ªé‡Œï¼Ÿ

**A**: Phase 8 å®Œæˆçš„é…ç½®å‚æ•°åœ¨ï¼š

1. **CombatEngine é…ç½®èŠ‚**: æˆ˜æ–—å¼•æ“å‚æ•°ï¼ˆ7ä¸ªï¼‰
   - ä½ç½®: `appsettings.json` â†’ `CombatEngine`
   - è¯¦æƒ…: æœ¬æ–‡æ¡£ [4. CombatEngine](#4-combatengine---æˆ˜æ–—å¼•æ“é…ç½®--phase-8)

2. **Equipment é…ç½®èŠ‚**: è£…å¤‡ç³»ç»Ÿå‚æ•°ï¼ˆ9ä¸ªï¼‰
   - ä½ç½®: `appsettings.json` â†’ `Equipment`
   - è¯¦æƒ…: æœ¬æ–‡æ¡£ [11. Equipment](#11-equipment---è£…å¤‡ç³»ç»Ÿé…ç½®--phase-8)

**å‚è€ƒæ–‡æ¡£**:
- `docs/Phase8-ç¡¬ç¼–ç å¸¸é‡è¿ç§»å®ŒæˆæŠ¥å‘Š.md`
- `æœåŠ¡ç«¯ä»£ç ä¼˜åŒ–Phase8å®Œæˆæ€»ç»“.md`

---

### Q4: å¦‚ä½•éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ

**A**: 
1. **å¯åŠ¨åº”ç”¨**: é…ç½®é”™è¯¯ä¼šåœ¨å¯åŠ¨æ—¶æŠ¥é”™
2. **æŸ¥çœ‹æ—¥å¿—**: æ£€æŸ¥æ˜¯å¦æœ‰é…ç½®è­¦å‘Š
3. **æµ‹è¯•åŠŸèƒ½**: éªŒè¯ä¿®æ”¹çš„å‚æ•°æ˜¯å¦ç”Ÿæ•ˆ
4. **è¿è¡Œæµ‹è¯•**: æ‰§è¡Œå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•éªŒè¯é…ç½®
dotnet test
```

---

### Q5: é…ç½®æ–‡ä»¶æ‰¾ä¸åˆ°æ€ä¹ˆåŠï¼Ÿ

**A**: ç¡®ä¿ï¼š

1. é…ç½®æ–‡ä»¶åœ¨æ­£ç¡®ä½ç½®ï¼ˆ`BlazorIdle.Server/` ç›®å½•ï¼‰
2. æ–‡ä»¶åæ­£ç¡®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
3. æ–‡ä»¶ç¼–ç ä¸º UTF-8
4. JSON æ ¼å¼æ­£ç¡®ï¼ˆå¯ä½¿ç”¨ JSON éªŒè¯å·¥å…·ï¼‰

å¦‚æœé…ç½®æ–‡ä»¶ç¼ºå¤±ï¼Œåº”ç”¨ä¼šä½¿ç”¨ä»£ç ä¸­çš„é»˜è®¤å€¼ã€‚

---

### Q6: å¦‚ä½•æ·»åŠ æ–°çš„é…ç½®å‚æ•°ï¼Ÿ

**A**: 

1. **åˆ›å»º Options ç±»**:
```csharp
public class MyFeatureOptions
{
    public int MyParameter { get; set; } = é»˜è®¤å€¼;
}
```

2. **åœ¨ appsettings.json æ·»åŠ é…ç½®**:
```json
{
  "MyFeature": {
    "MyParameter": å€¼
  }
}
```

3. **æ³¨å†Œåˆ° DI å®¹å™¨**:
```csharp
services.Configure<MyFeatureOptions>(
    configuration.GetSection("MyFeature"));
```

4. **åœ¨ä»£ç ä¸­ä½¿ç”¨**:
```csharp
public class MyService
{
    private readonly MyFeatureOptions _options;
    
    public MyService(IOptions<MyFeatureOptions> options)
    {
        _options = options.Value;
    }
}
```

5. **æ›´æ–°æœ¬é…ç½®æ–‡æ¡£**

---

### Q7: é…ç½®å€¼çš„åˆç†èŒƒå›´æ˜¯ä»€ä¹ˆï¼Ÿ

**A**: 

| é…ç½®ç±»å‹ | å»ºè®®èŒƒå›´ | æ³¨æ„äº‹é¡¹ |
|---------|---------|---------|
| æ—¶é—´é—´éš” | 0.1-60 ç§’ | å¤ªçŸ­å½±å“æ€§èƒ½ï¼Œå¤ªé•¿å½±å“ä½“éªŒ |
| ç¼“å­˜æ—¶é•¿ | 1-60 åˆ†é’Ÿ | æ ¹æ®æ›´æ–°é¢‘ç‡è°ƒæ•´ |
| æ•°å€¼ä¸Šé™ | 100-10000 | é˜²æ­¢æº¢å‡ºï¼Œè€ƒè™‘æ¸¸æˆå¹³è¡¡ |
| ç™¾åˆ†æ¯” | 0.0-1.0 | ä½¿ç”¨å°æ•°è¡¨ç¤ºç™¾åˆ†æ¯” |

å…·ä½“å‚æ•°çš„åˆç†èŒƒå›´è¯·å‚è€ƒå„é…ç½®èŠ‚çš„è¯´æ˜ã€‚

---

## ç›¸å…³æ–‡æ¡£

- [01-æ¶æ„æ¦‚è§ˆ.md](./01-æ¶æ„æ¦‚è§ˆ.md) - ç³»ç»Ÿæ¶æ„è®¾è®¡
- [09-å¼€å‘è§„èŒƒ.md](./09-å¼€å‘è§„èŒƒ.md) - å¼€å‘è§„èŒƒå’Œæœ€ä½³å®è·µ
- `docs/Phase8-ç¡¬ç¼–ç å¸¸é‡è¿ç§»å®ŒæˆæŠ¥å‘Š.md` - Phase 8 é…ç½®åŒ–è¯¦æƒ…
- `æœåŠ¡ç«¯ä»£ç ä¼˜åŒ–Phase8å®Œæˆæ€»ç»“.md` - Phase 8 å®Œæˆæ€»ç»“
- `docs/å•†åº—ç³»ç»Ÿé…ç½®åŒ–æ€»ç»“.md` - å•†åº—ç³»ç»Ÿé…ç½®åŒ–å‚è€ƒ
- `docs/æœåŠ¡ç«¯ä»£ç ä¼˜åŒ–æ–¹æ¡ˆ.md` - æ•´ä½“ä¼˜åŒ–æ–¹æ¡ˆ

---

**æ–‡æ¡£ç»´æŠ¤**:  
æœ¬æ–‡æ¡£ä½œä¸º Phase 9 å¼€å‘æ–‡æ¡£çš„ä¸€éƒ¨åˆ†ï¼Œåº”éšé…ç½®å˜æ›´æŒç»­æ›´æ–°ã€‚æ·»åŠ æ–°é…ç½®æ—¶ï¼Œè¯·åŠæ—¶æ›´æ–°æœ¬æ–‡æ¡£çš„ç›¸åº”ç« èŠ‚ã€‚
