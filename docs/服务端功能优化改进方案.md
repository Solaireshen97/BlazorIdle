# æœåŠ¡ç«¯ç°æœ‰åŠŸèƒ½ä¼˜åŒ–æ”¹è¿›æ–¹æ¡ˆ

**é¡¹ç›®**: BlazorIdle  
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-15  
**çŠ¶æ€**: ä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡  
**è´Ÿè´£äºº**: å¼€å‘å›¢é˜Ÿ

---

## ğŸ“‹ ç›®å½•

1. [æ‰§è¡Œæ‘˜è¦](#æ‰§è¡Œæ‘˜è¦)
2. [ä¼˜åŒ–åŸåˆ™ä¸ç›®æ ‡](#ä¼˜åŒ–åŸåˆ™ä¸ç›®æ ‡)
3. [æˆ˜æ–—ç³»ç»Ÿä¼˜åŒ–](#æˆ˜æ–—ç³»ç»Ÿä¼˜åŒ–)
4. [è£…å¤‡ç³»ç»Ÿä¼˜åŒ–](#è£…å¤‡ç³»ç»Ÿä¼˜åŒ–)
5. [æ´»åŠ¨è®¡åˆ’ç³»ç»Ÿä¼˜åŒ–](#æ´»åŠ¨è®¡åˆ’ç³»ç»Ÿä¼˜åŒ–)
6. [ç¦»çº¿ç»“ç®—ç³»ç»Ÿä¼˜åŒ–](#ç¦»çº¿ç»“ç®—ç³»ç»Ÿä¼˜åŒ–)
7. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
8. [ä»£ç è´¨é‡ä¼˜åŒ–](#ä»£ç è´¨é‡ä¼˜åŒ–)
9. [ç›‘æ§ä¸è¯Šæ–­ä¼˜åŒ–](#ç›‘æ§ä¸è¯Šæ–­ä¼˜åŒ–)
10. [ä¼˜åŒ–å®æ–½è·¯çº¿å›¾](#ä¼˜åŒ–å®æ–½è·¯çº¿å›¾)

---

## æ‰§è¡Œæ‘˜è¦

### ä¼˜åŒ–ç›®æ ‡

æœ¬æ–‡æ¡£é’ˆå¯¹ **å·²å®ç°çš„ç³»ç»Ÿ** æä¾›ä¼˜åŒ–æ”¹è¿›æ–¹æ¡ˆï¼Œç€çœ¼äºï¼š
- ğŸ¯ **å®Œå–„æ€§**: è¡¥å……ç¼ºå¤±çš„å­åŠŸèƒ½
- âš¡ **æ€§èƒ½**: æå‡è¿è¡Œæ•ˆç‡
- ğŸ”§ **å¯ç»´æŠ¤æ€§**: ä»£ç ç»“æ„ä¼˜åŒ–
- ğŸ“Š **å¯è§‚æµ‹æ€§**: ç›‘æ§ä¸è¯Šæ–­å¢å¼º

### æ ¸å¿ƒå‘ç°

é€šè¿‡å¯¹æ¯”ã€Šæ•´åˆè®¾è®¡æ€»ç»“.txtã€‹ä¸å½“å‰å®ç°ï¼Œå‘ç°ä»¥ä¸‹éœ€è¦ä¼˜åŒ–çš„æ–¹é¢ï¼š

**åŠŸèƒ½å®Œå–„** (7é¡¹):
1. ResourceBucket æº¢å‡ºè½¬æ¢ç­–ç•¥
2. Buff å±‚æ•°å åŠ æœºåˆ¶
3. CombatSegment è¯¦ç»†ç»Ÿè®¡
4. è£…å¤‡è¯æ¡é‡ç½®åŠŸèƒ½
5. æ´»åŠ¨äº’æ–¥æ ‡ç­¾
6. æ¶ˆè€—å“ç³»ç»ŸåŸºç¡€
7. ç»æµç›‘æ§å®Œå–„

**æ€§èƒ½ä¼˜åŒ–** (5é¡¹):
1. æˆ˜æ–—äº‹ä»¶æ‰¹å¤„ç†
2. æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
3. ç¼“å­˜ç­–ç•¥å®Œå–„
4. SignalR æ¶ˆæ¯ä¼˜åŒ–
5. ç¦»çº¿å¿«è¿›æ€§èƒ½

**ä»£ç è´¨é‡** (6é¡¹):
1. ä»£ç é‡å¤æ¶ˆé™¤
2. æ³¨é‡Šå®Œå–„
3. å•å…ƒæµ‹è¯•è¦†ç›–
4. å¼‚å¸¸å¤„ç†å¢å¼º
5. æ—¥å¿—è§„èŒƒåŒ–
6. é…ç½®éªŒè¯

---

## ä¼˜åŒ–åŸåˆ™ä¸ç›®æ ‡

### 2.1 ä¼˜åŒ–åŸåˆ™

1. **å‘åå…¼å®¹**: ä¸ç ´åç°æœ‰åŠŸèƒ½
2. **æ¸è¿›å¼**: åˆ†é˜¶æ®µå®æ–½
3. **å¯éªŒè¯**: æ¯ä¸ªä¼˜åŒ–ç‚¹å¯æµ‹è¯•
4. **é‡åŒ–è¯„ä¼°**: è®¾å®šæ˜ç¡®çš„æ”¹è¿›æŒ‡æ ‡

### 2.2 é‡åŒ–ç›®æ ‡

| ä¼˜åŒ–ç»´åº¦ | å½“å‰ | ç›®æ ‡ | æ”¹è¿›ç‡ |
|----------|------|------|--------|
| æˆ˜æ–—äº‹ä»¶å¤„ç†é€Ÿåº¦ | åŸºçº¿ | æå‡ 20% | +20% |
| ç¦»çº¿å¿«è¿›æ€§èƒ½ | åŸºçº¿ | æå‡ 30% | +30% |
| æ•°æ®åº“æŸ¥è¯¢æ¬¡æ•° | åŸºçº¿ | å‡å°‘ 40% | -40% |
| ä»£ç é‡å¤åº¦ | ~10% | < 5% | -50% |
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | ~85% | > 95% | +10% |
| ç›‘æ§æŒ‡æ ‡æ•°é‡ | 5 | 20+ | +300% |

---

## æˆ˜æ–—ç³»ç»Ÿä¼˜åŒ–

### 3.1 ResourceBucket æº¢å‡ºè½¬æ¢ç­–ç•¥

#### å½“å‰çŠ¶æ€
```csharp
public class ResourceBucket
{
    public string Id { get; set; }
    public double Current { get; set; }
    public double Max { get; set; }
    public OverflowPolicy Policy { get; set; } = OverflowPolicy.Clamp;  // ä»…æ”¯æŒ Clamp
}

public enum OverflowPolicy
{
    Clamp  // ä¸Šé™æˆªæ–­
}
```

#### é—®é¢˜åˆ†æ
- âŒ æ— æ³•å®ç°"æ€’æ°”æº¢å‡ºè½¬æˆ˜æ„ Buff"æœºåˆ¶
- âŒ æ— æ³•å®ç°èµ„æºè½¬æ¢èŒä¸šå·®å¼‚åŒ–

#### ä¼˜åŒ–æ–¹æ¡ˆ

**1. æ‰©å±• OverflowPolicy**
```csharp
public enum OverflowPolicy
{
    Clamp,      // ä¸Šé™æˆªæ–­
    Convert,    // è½¬æ¢ä¸ºå…¶ä»–èµ„æº/Buff
    Wrap        // å›ç»•ï¼ˆå¯é€‰ï¼‰
}

public class ResourceBucket
{
    public string Id { get; set; }
    public double Current { get; set; }
    public double Max { get; set; }
    public OverflowPolicy Policy { get; set; }
    
    // Convert ç­–ç•¥é…ç½®
    public ConvertConfig ConvertConfig { get; set; }
}

public class ConvertConfig
{
    public string TargetType { get; set; }  // "Resource" / "Buff"
    public string TargetId { get; set; }    // ç›®æ ‡èµ„æºID æˆ– Buff ID
    public double Ratio { get; set; }       // è½¬æ¢æ¯”ä¾‹ (ä¾‹å¦‚ 20:1)
    public double Remainder { get; set; }   // å‰©ä½™æœªè½¬æ¢é‡
}
```

**2. å®ç°è½¬æ¢é€»è¾‘**
```csharp
public class ResourceBucketService
{
    public void AddResource(ResourceBucket bucket, double amount, BattleContext context)
    {
        bucket.Current += amount;
        
        if (bucket.Current > bucket.Max)
        {
            var excess = bucket.Current - bucket.Max;
            
            switch (bucket.Policy)
            {
                case OverflowPolicy.Clamp:
                    bucket.Current = bucket.Max;
                    break;
                    
                case OverflowPolicy.Convert:
                    HandleConvert(bucket, excess, context);
                    break;
            }
        }
    }
    
    private void HandleConvert(ResourceBucket bucket, double excess, BattleContext context)
    {
        var config = bucket.ConvertConfig;
        var totalExcess = config.Remainder + excess;
        var converted = Math.Floor(totalExcess / config.Ratio);
        config.Remainder = totalExcess % config.Ratio;
        
        if (converted > 0)
        {
            if (config.TargetType == "Buff")
            {
                // åº”ç”¨ Buff å±‚æ•°
                context.ApplyBuff(config.TargetId, (int)converted);
            }
            else if (config.TargetType == "Resource")
            {
                // è½¬ä¸ºå…¶ä»–èµ„æº
                var targetBucket = context.GetResourceBucket(config.TargetId);
                AddResource(targetBucket, converted, context);
            }
        }
        
        bucket.Current = bucket.Max;
    }
}
```

**3. é…ç½®ç¤ºä¾‹**
```json
{
  "ResourceBuckets": {
    "rage": {
      "id": "rage",
      "max": 100,
      "policy": "Convert",
      "convertConfig": {
        "targetType": "Buff",
        "targetId": "battle_spirit",
        "ratio": 20.0
      }
    }
  },
  "Buffs": {
    "battle_spirit": {
      "id": "battle_spirit",
      "name": "æˆ˜æ„",
      "maxStacks": 5,
      "duration": 10.0,
      "effects": [
        { "type": "DamageMultiplier", "value": 0.1 }
      ]
    }
  }
}
```

**å·¥ä½œé‡ä¼°ç®—**: 
- æ•°æ®æ¨¡å‹æ‰©å±•: 2 å·¥æ—¶
- è½¬æ¢é€»è¾‘å®ç°: 4 å·¥æ—¶
- é…ç½®é›†æˆ: 2 å·¥æ—¶
- å•å…ƒæµ‹è¯•: 4 å·¥æ—¶
- **æ€»è®¡**: 12 å·¥æ—¶ (1.5 å¤©)

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ”¯æŒ Convert ç­–ç•¥
- [ ] æº¢å‡ºæ­£ç¡®è½¬ä¸º Buff å±‚æ•°
- [ ] å‰©ä½™é‡æ­£ç¡®ç´¯ç§¯
- [ ] é…ç½®åŒ–å®Œæ•´
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 95%

---

### 3.2 Buff å±‚æ•°å åŠ æœºåˆ¶å®Œå–„

#### å½“å‰çŠ¶æ€
```csharp
public class BuffInstance
{
    public string Id { get; set; }
    public string SourceId { get; set; }
    public double ExpireAt { get; set; }
    // âŒ ç¼ºå°‘å±‚æ•°ç®¡ç†
}
```

#### ä¼˜åŒ–æ–¹æ¡ˆ

**1. æ‰©å±• BuffInstance**
```csharp
public class BuffInstance
{
    public string Id { get; set; }
    public string SourceId { get; set; }
    public int Stacks { get; set; }          // å½“å‰å±‚æ•°
    public int MaxStacks { get; set; }       // æœ€å¤§å±‚æ•°
    public double ExpireAt { get; set; }
    public BuffRefreshMode RefreshMode { get; set; }  // åˆ·æ–°æ¨¡å¼
    public List<BuffEffect> Effects { get; set; }
}

public enum BuffRefreshMode
{
    RefreshDuration,     // åˆ·æ–°æŒç»­æ—¶é—´
    AddDuration,         // ç´¯åŠ æŒç»­æ—¶é—´
    IndependentStacks    // ç‹¬ç«‹å±‚æ•°è®¡æ—¶
}

public class BuffEffect
{
    public string Type { get; set; }  // "StatModifier" / "DamageOverTime" / "Proc"
    public Dictionary<string, object> Params { get; set; }
}
```

**2. å±‚æ•°ç®¡ç†é€»è¾‘**
```csharp
public class BuffManager
{
    public void ApplyBuff(Combatant combatant, string buffId, int stacks, double duration, GameClock clock)
    {
        var existingBuff = combatant.Buffs.FirstOrDefault(b => b.Id == buffId);
        
        if (existingBuff != null)
        {
            // å·²å­˜åœ¨ï¼Œå åŠ å±‚æ•°
            var newStacks = Math.Min(existingBuff.Stacks + stacks, existingBuff.MaxStacks);
            
            switch (existingBuff.RefreshMode)
            {
                case BuffRefreshMode.RefreshDuration:
                    existingBuff.Stacks = newStacks;
                    existingBuff.ExpireAt = clock.Now + duration;
                    break;
                    
                case BuffRefreshMode.AddDuration:
                    existingBuff.Stacks = newStacks;
                    existingBuff.ExpireAt += duration;
                    break;
                    
                case BuffRefreshMode.IndependentStacks:
                    // æ¯å±‚ç‹¬ç«‹è®¡æ—¶ï¼ˆé«˜çº§ï¼Œå¯åç»­å®ç°ï¼‰
                    break;
            }
        }
        else
        {
            // æ–°å»º Buff
            var buffDef = _buffRegistry.GetDefinition(buffId);
            combatant.Buffs.Add(new BuffInstance
            {
                Id = buffId,
                Stacks = Math.Min(stacks, buffDef.MaxStacks),
                MaxStacks = buffDef.MaxStacks,
                ExpireAt = clock.Now + duration,
                RefreshMode = buffDef.RefreshMode,
                Effects = buffDef.Effects
            });
        }
    }
    
    public void ConsumeBuffStacks(Combatant combatant, string buffId, int stacks)
    {
        var buff = combatant.Buffs.FirstOrDefault(b => b.Id == buffId);
        if (buff != null)
        {
            buff.Stacks = Math.Max(0, buff.Stacks - stacks);
            if (buff.Stacks == 0)
            {
                combatant.Buffs.Remove(buff);
            }
        }
    }
}
```

**3. å±æ€§ä¿®é¥°å™¨é›†æˆ**
```csharp
public class StatsCalculator
{
    public CombatStats CalculateStats(Combatant combatant)
    {
        var baseStats = combatant.BaseStats;
        var finalStats = baseStats.Clone();
        
        // åº”ç”¨ Buff æ•ˆæœ
        foreach (var buff in combatant.Buffs)
        {
            foreach (var effect in buff.Effects)
            {
                if (effect.Type == "StatModifier")
                {
                    var stat = effect.Params["stat"] as string;
                    var value = Convert.ToDouble(effect.Params["value"]);
                    var perStack = Convert.ToDouble(effect.Params.GetValueOrDefault("perStack", 0.0));
                    
                    var totalValue = value + (perStack * buff.Stacks);
                    ApplyModifier(finalStats, stat, totalValue);
                }
            }
        }
        
        return finalStats;
    }
}
```

**å·¥ä½œé‡ä¼°ç®—**: 
- æ•°æ®æ¨¡å‹æ‰©å±•: 3 å·¥æ—¶
- å±‚æ•°ç®¡ç†é€»è¾‘: 6 å·¥æ—¶
- å±æ€§ä¿®é¥°å™¨é›†æˆ: 4 å·¥æ—¶
- é…ç½®æ”¯æŒ: 2 å·¥æ—¶
- å•å…ƒæµ‹è¯•: 6 å·¥æ—¶
- **æ€»è®¡**: 21 å·¥æ—¶ (2.5-3 å¤©)

---

### 3.3 CombatSegment è¯¦ç»†ç»Ÿè®¡

#### å½“å‰çŠ¶æ€
```csharp
public class CombatSegment
{
    public double StartTime { get; set; }
    public double EndTime { get; set; }
    public int EventCount { get; set; }
    // âŒ ç¼ºå°‘è¯¦ç»†ç»Ÿè®¡
}
```

#### ä¼˜åŒ–æ–¹æ¡ˆ

**æ‰©å±•ç»Ÿè®¡å­—æ®µ**
```csharp
public class CombatSegment
{
    public double StartTime { get; set; }
    public double EndTime { get; set; }
    public int EventCount { get; set; }
    
    // ä¼¤å®³ç»Ÿè®¡
    public Dictionary<string, SegmentDamageStats> DamageBySource { get; set; }
    public double TotalDamageDealt { get; set; }
    public double TotalDamageReceived { get; set; }
    
    // èµ„æºç»Ÿè®¡
    public Dictionary<string, ResourceFlow> ResourceFlows { get; set; }
    
    // Buff ç»Ÿè®¡
    public Dictionary<string, BuffUptime> BuffUptimes { get; set; }
    
    // å¥–åŠ±ç»Ÿè®¡
    public RewardSummary Rewards { get; set; }
    
    // RNG ç§å­èŒƒå›´
    public (long Start, long End) RngSeedRange { get; set; }
}

public class SegmentDamageStats
{
    public string SourceId { get; set; }
    public double TotalDamage { get; set; }
    public int HitCount { get; set; }
    public int CritCount { get; set; }
    public double MaxHit { get; set; }
}

public class ResourceFlow
{
    public string ResourceId { get; set; }
    public double Gained { get; set; }
    public double Spent { get; set; }
    public double Wasted { get; set; }  // æº¢å‡ºæµªè´¹
}

public class BuffUptime
{
    public string BuffId { get; set; }
    public double UptimeSeconds { get; set; }
    public double UptimePercent { get; set; }
    public int ApplicationCount { get; set; }
}
```

**å·¥ä½œé‡ä¼°ç®—**: 16 å·¥æ—¶ (2 å¤©)

---

### 3.4 æŠ€èƒ½è‡ªåŠ¨æ–½æ”¾ä¼˜å…ˆçº§ç­–ç•¥

#### å½“å‰çŠ¶æ€
- åŸºç¡€æ§½ä½é¡ºåº (1â†’4)

#### ä¼˜åŒ–æ–¹æ¡ˆ

**1. æ‰©å±•ä¼˜å…ˆçº§ç­–ç•¥**
```csharp
public enum AutoCastStrategy
{
    SlotOrder,         // æ§½ä½é¡ºåº (å½“å‰)
    Rotation,          // å¾ªç¯è½®è½¬
    Conditional,       // æ¡ä»¶ä¼˜å…ˆ
    ResourceOptimal    // èµ„æºæœ€ä¼˜
}

public class SkillSlot
{
    public int Index { get; set; }
    public string SkillId { get; set; }
    public int Priority { get; set; }  // ä¼˜å…ˆçº§
    public string Condition { get; set; }  // æ¡ä»¶è¡¨è¾¾å¼ (å¯é€‰)
}
```

**2. æ¡ä»¶è¡¨è¾¾å¼ç¤ºä¾‹**
```
"hp < 50% AND cooldown.ready('heal')"
"resource.rage >= 80"
"buff.stacks('battle_spirit') >= 3"
```

**å·¥ä½œé‡ä¼°ç®—**: 18 å·¥æ—¶ (2-3 å¤©)

---

## è£…å¤‡ç³»ç»Ÿä¼˜åŒ–

### 4.1 è£…å¤‡è¯æ¡é‡ç½® (Reroll) åŠŸèƒ½

#### åŠŸèƒ½æè¿°
å…è®¸ç©å®¶æ¶ˆè€—èµ„æºé‡æ–°ç”Ÿæˆè£…å¤‡è¯æ¡

#### è®¾è®¡æ–¹æ¡ˆ

**1. æ•°æ®æ¨¡å‹**
```csharp
public class GearInstance
{
    // ç°æœ‰å­—æ®µ...
    public int RerollCount { get; set; }  // é‡ç½®æ¬¡æ•°
    public int RerollCostMultiplier { get; set; }  // æˆæœ¬å€æ•°
}

public class RerollConfig
{
    public int BaseCost { get; set; }  // åŸºç¡€é‡‘å¸æˆæœ¬
    public Dictionary<string, int> MaterialCosts { get; set; }  // ææ–™æˆæœ¬
    public double CostMultiplierPerReroll { get; set; }  // æ¯æ¬¡é‡ç½®æˆæœ¬é€’å¢
    public int GuaranteedRareAfterRerolls { get; set; }  // ä¿åº•ç¨€æœ‰è¯æ¡æ¬¡æ•°
}
```

**2. é‡ç½®é€»è¾‘**
```csharp
public class RerollService
{
    private readonly IRewardGrantService _rewardService;
    private readonly IGearGenerationService _gearGenService;
    
    public RerollResult RerollAffixes(GearInstance gear, string characterId)
    {
        // 1. è®¡ç®—æˆæœ¬
        var config = GetRerollConfig(gear.Tier, gear.Rarity);
        var cost = CalculateRerollCost(gear, config);
        
        // 2. éªŒè¯å¹¶æ‰£é™¤èµ„æº
        if (!ValidateAndDeductCost(characterId, cost))
        {
            return RerollResult.InsufficientResources();
        }
        
        // 3. é‡æ–°ç”Ÿæˆè¯æ¡
        var oldAffixes = gear.Affixes.ToList();
        gear.Affixes = _gearGenService.GenerateAffixes(
            gear.Definition, 
            gear.Tier,
            ApplyGuaranteeLogic(gear.RerollCount, config)
        );
        
        // 4. æ›´æ–°é‡ç½®è®¡æ•°
        gear.RerollCount++;
        
        return new RerollResult
        {
            Success = true,
            OldAffixes = oldAffixes,
            NewAffixes = gear.Affixes,
            CostPaid = cost
        };
    }
    
    private RerollCost CalculateRerollCost(GearInstance gear, RerollConfig config)
    {
        var multiplier = Math.Pow(config.CostMultiplierPerReroll, gear.RerollCount);
        
        return new RerollCost
        {
            Gold = (int)(config.BaseCost * multiplier),
            Materials = config.MaterialCosts.ToDictionary(
                kv => kv.Key,
                kv => (int)(kv.Value * multiplier)
            )
        };
    }
    
    private AffixGenerationParams ApplyGuaranteeLogic(int rerollCount, RerollConfig config)
    {
        var guarantee = config.GuaranteedRareAfterRerolls;
        if (rerollCount > 0 && rerollCount % guarantee == 0)
        {
            // ä¿åº•æœºåˆ¶ï¼šå¼ºåˆ¶è‡³å°‘ä¸€ä¸ªç¨€æœ‰è¯æ¡
            return new AffixGenerationParams { MinRareCount = 1 };
        }
        return new AffixGenerationParams();
    }
}
```

**3. é…ç½®ç¤ºä¾‹**
```json
{
  "EquipmentReroll": {
    "T1": {
      "baseCost": 1000,
      "materialCosts": { "dust": 10, "essence": 2 },
      "costMultiplierPerReroll": 1.5,
      "guaranteedRareAfterRerolls": 5
    },
    "T2": {
      "baseCost": 5000,
      "materialCosts": { "dust": 50, "essence": 10 },
      "costMultiplierPerReroll": 1.5,
      "guaranteedRareAfterRerolls": 5
    }
  }
}
```

**å·¥ä½œé‡ä¼°ç®—**: 
- æ•°æ®æ¨¡å‹: 2 å·¥æ—¶
- é‡ç½®é€»è¾‘: 6 å·¥æ—¶
- æˆæœ¬è®¡ç®—: 4 å·¥æ—¶
- ä¿åº•æœºåˆ¶: 3 å·¥æ—¶
- API ç«¯ç‚¹: 3 å·¥æ—¶
- å•å…ƒæµ‹è¯•: 6 å·¥æ—¶
- **æ€»è®¡**: 24 å·¥æ—¶ (3 å¤©)

**éªŒæ”¶æ ‡å‡†**:
- [ ] æˆæœ¬æ­£ç¡®è®¡ç®—ï¼ˆå«é€’å¢ï¼‰
- [ ] ä¿åº•æœºåˆ¶ç”Ÿæ•ˆ
- [ ] å¹‚ç­‰æ€§ä¿è¯
- [ ] äº‹åŠ¡å®Œæ•´æ€§
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 95%

---

### 4.2 è£…å¤‡å“çº§ç²¾ç‚¼ (Refine)

#### åŠŸèƒ½æè¿°
ç²¾ç‚¼æŒ‡å®šè¯æ¡ï¼Œå°å¹…æå‡æ•°å€¼ï¼ˆä¸æ”¹å˜è¯æ¡ç±»å‹ï¼‰

**å·¥ä½œé‡ä¼°ç®—**: 18 å·¥æ—¶ (2-3 å¤©)

---

### 4.3 è£…å¤‡ç‰¹æ•ˆè§¦å‘æœºåˆ¶

#### åŠŸèƒ½æè¿°
è£…å¤‡é™„å¸¦ç‰¹æ®Šæ•ˆæœï¼Œåœ¨ç‰¹å®šäº‹ä»¶è§¦å‘ï¼ˆOnHit/OnCast/OnKillï¼‰

**è®¾è®¡è¦ç‚¹**:
- äº‹ä»¶é’©å­ç³»ç»Ÿ
- ç‰¹æ•ˆæ³¨å†Œè¡¨
- è§¦å‘æ¡ä»¶åˆ¤å®š
- å†·å´ç®¡ç†

**å·¥ä½œé‡ä¼°ç®—**: 24 å·¥æ—¶ (3 å¤©)

---

## æ´»åŠ¨è®¡åˆ’ç³»ç»Ÿä¼˜åŒ–

### 5.1 æ´»åŠ¨äº’æ–¥æ ‡ç­¾ (Exclusion Tags)

#### å½“å‰çŠ¶æ€
- æ— äº’æ–¥æœºåˆ¶ï¼Œå¯èƒ½åŒæ—¶è¿è¡Œå¤šä¸ªæˆ˜æ–—æ´»åŠ¨

#### ä¼˜åŒ–æ–¹æ¡ˆ

**1. æ‰©å±• ActivityPlan**
```csharp
public class ActivityPlan
{
    // ç°æœ‰å­—æ®µ...
    public List<string> ExclusionTags { get; set; }  // äº’æ–¥æ ‡ç­¾
}

public class ActivitySlot
{
    public int Index { get; set; }
    public ActivityPlan CurrentPlan { get; set; }
    public Queue<ActivityPlan> PendingPlans { get; set; }
    
    // å½“å‰å ç”¨çš„äº’æ–¥æ ‡ç­¾
    public HashSet<string> OccupiedTags { get; set; }
}
```

**2. äº’æ–¥æ£€æŸ¥é€»è¾‘**
```csharp
public class ActivityPlanService
{
    public bool CanStartActivity(ActivityPlan plan, List<ActivitySlot> slots)
    {
        // æ”¶é›†æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„æ´»åŠ¨çš„äº’æ–¥æ ‡ç­¾
        var occupiedTags = slots
            .Where(s => s.CurrentPlan != null)
            .SelectMany(s => s.CurrentPlan.ExclusionTags ?? new List<string>())
            .ToHashSet();
        
        // æ£€æŸ¥æ–°æ´»åŠ¨çš„æ ‡ç­¾æ˜¯å¦å†²çª
        var planTags = plan.ExclusionTags ?? new List<string>();
        return !planTags.Any(tag => occupiedTags.Contains(tag));
    }
    
    public void StartActivity(ActivitySlot slot, ActivityPlan plan, List<ActivitySlot> allSlots)
    {
        if (!CanStartActivity(plan, allSlots))
        {
            throw new InvalidOperationException($"Activity conflicts with running activities");
        }
        
        slot.CurrentPlan = plan;
        slot.OccupiedTags = new HashSet<string>(plan.ExclusionTags ?? new List<string>());
        plan.State = ActivityState.Running;
    }
}
```

**3. é…ç½®ç¤ºä¾‹**
```json
{
  "ActivityTypes": {
    "Combat": {
      "exclusionTags": ["combat"]
    },
    "Dungeon": {
      "exclusionTags": ["combat", "dungeon"]
    },
    "Gathering": {
      "exclusionTags": []
    },
    "Crafting": {
      "exclusionTags": []
    }
  }
}
```

**å·¥ä½œé‡ä¼°ç®—**: 
- æ•°æ®æ¨¡å‹æ‰©å±•: 2 å·¥æ—¶
- äº’æ–¥é€»è¾‘: 4 å·¥æ—¶
- é…ç½®æ”¯æŒ: 2 å·¥æ—¶
- å•å…ƒæµ‹è¯•: 4 å·¥æ—¶
- **æ€»è®¡**: 12 å·¥æ—¶ (1.5 å¤©)

---

### 5.2 é‡‡é›†æ´»åŠ¨ (Gathering) æ”¯æŒ

#### è®¾è®¡è¦ç‚¹
- GatheringNode å®šä¹‰
- é‡‡é›†é€Ÿåº¦è®¡ç®—
- èµ„æºäº§å‡º
- èŠ‚ç‚¹è€—å°½æœºåˆ¶ï¼ˆå¯é€‰ï¼‰

**å·¥ä½œé‡ä¼°ç®—**: 20 å·¥æ—¶ (2.5-3 å¤©)

---

### 5.3 åˆ¶ä½œæ´»åŠ¨ (Crafting) æ”¯æŒ

#### è®¾è®¡è¦ç‚¹
- é…æ–¹ç³»ç»Ÿ
- ææ–™æ¶ˆè€—
- åˆ¶ä½œæ—¶é—´
- æˆåŠŸç‡æœºåˆ¶ï¼ˆå¯é€‰ï¼‰

**å·¥ä½œé‡ä¼°ç®—**: 24 å·¥æ—¶ (3 å¤©)

---

## ç¦»çº¿ç»“ç®—ç³»ç»Ÿä¼˜åŒ–

### 6.1 ç¦»çº¿å‰¯æœ¬æŒç»­æŒ‚æœº

#### å½“å‰çŠ¶æ€
- ç¦»çº¿åå‰¯æœ¬æš‚åœ

#### ä¼˜åŒ–æ–¹æ¡ˆ

**1. æŒç»­æ¨¡æ‹Ÿæ¡ä»¶**
```csharp
public class DungeonActivityPayload
{
    // ç°æœ‰å­—æ®µ...
    public bool ContinueWhenOffline { get; set; }  // å…¨å‘˜ç¦»çº¿æ˜¯å¦ç»§ç»­
    public double MaxContinuousDuration { get; set; }  // æœ€å¤§æŒç»­æ—¶é•¿ï¼ˆç§’ï¼‰
    public DateTime? ForceStopAt { get; set; }  // å¼ºåˆ¶åœæ­¢æ—¶é—´
}
```

**2. ç»ˆæ­¢æ¡ä»¶æ£€æµ‹**
```csharp
public class DungeonContinuousManager
{
    public bool ShouldTerminate(DungeonRun run, GameClock clock)
    {
        // 1. é˜Ÿé•¿ä¸»åŠ¨ç»“æŸ
        if (run.IsManuallyEnded)
            return true;
        
        // 2. æˆå‘˜ç¦»é˜Ÿå¯¼è‡´ä½äºæœ€å°éœ€æ±‚
        if (run.PartyMembers.Count < run.MinMembers)
            return true;
        
        // 3. è¶…è¿‡æœ€å¤§æŒç»­æ—¶é•¿
        var duration = clock.Now - run.StartTime;
        if (duration > run.MaxContinuousDuration)
            return true;
        
        // 4. åˆ°è¾¾å¼ºåˆ¶åœæ­¢æ—¶é—´
        if (run.ForceStopAt.HasValue && clock.Now >= run.ForceStopAt.Value.ToUnixTimestamp())
            return true;
        
        return false;
    }
}
```

**3. äº§å‡ºé€’å‡æœºåˆ¶**
```csharp
public class DungeonRewardCalculator
{
    public double CalculateDiminishingFactor(DungeonRun run, GameClock clock)
    {
        var duration = clock.Now - run.StartTime;
        var config = GetDungeonConfig(run.DungeonId);
        
        if (duration <= config.FullRewardDuration)
        {
            return 1.0;  // å®Œæ•´å¥–åŠ±
        }
        
        // è¶…è¿‡é˜ˆå€¼åæŒ‰æ›²çº¿é€’å‡
        var excessDuration = duration - config.FullRewardDuration;
        var factor = Math.Exp(-config.DiminishingRate * excessDuration / 3600.0);
        return Math.Max(factor, config.MinFactor);  // ä¿åº• 0.1
    }
}
```

**å·¥ä½œé‡ä¼°ç®—**: 
- æŒç»­æ¡ä»¶åˆ¤å®š: 4 å·¥æ—¶
- ç»ˆæ­¢æ£€æµ‹: 4 å·¥æ—¶
- äº§å‡ºé€’å‡: 4 å·¥æ—¶
- DungeonSegment åˆ†æ®µ: 4 å·¥æ—¶
- å•å…ƒæµ‹è¯•: 6 å·¥æ—¶
- **æ€»è®¡**: 22 å·¥æ—¶ (3 å¤©)

---

### 6.2 ç¦»çº¿å¿«è¿›æ€§èƒ½ä¼˜åŒ–

#### ä¼˜åŒ–è¦ç‚¹
1. **æ‰¹é‡äº‹ä»¶å¤„ç†**: åˆå¹¶ç›¸ä¼¼äº‹ä»¶
2. **ç®€åŒ–è®¡ç®—**: ç¦»çº¿æ—¶è·³è¿‡ä¸å¿…è¦çš„ä¸­é—´è®¡ç®—
3. **åˆ†æ®µç”Ÿæˆ**: æ¯å°æ—¶ç”Ÿæˆä¸€ä¸ª Segment

**å·¥ä½œé‡ä¼°ç®—**: 12 å·¥æ—¶ (1.5 å¤©)

---

## æ€§èƒ½ä¼˜åŒ–

### 7.1 æˆ˜æ–—äº‹ä»¶æ‰¹å¤„ç†ä¼˜åŒ–

#### å½“å‰çŠ¶æ€
- æ¯ä¸ªäº‹ä»¶å•ç‹¬å¤„ç†

#### ä¼˜åŒ–æ–¹æ¡ˆ

**æ‰¹é‡å¤„ç†ç›¸ä¼¼äº‹ä»¶**
```csharp
public class EventBatchProcessor
{
    private const int BATCH_SIZE = 50;
    private List<IGameEvent> _eventBuffer = new List<IGameEvent>();
    
    public void ProcessEvent(IGameEvent evt, BattleContext context)
    {
        _eventBuffer.Add(evt);
        
        if (_eventBuffer.Count >= BATCH_SIZE || evt is SegmentFlushEvent)
        {
            FlushBatch(context);
        }
    }
    
    private void FlushBatch(BattleContext context)
    {
        // æŒ‰ç±»å‹åˆ†ç»„
        var grouped = _eventBuffer.GroupBy(e => e.GetType());
        
        foreach (var group in grouped)
        {
            if (group.Key == typeof(DamageEvent))
            {
                BatchProcessDamage(group.Cast<DamageEvent>(), context);
            }
            else
            {
                foreach (var evt in group)
                {
                    evt.Execute(context);
                }
            }
        }
        
        _eventBuffer.Clear();
    }
    
    private void BatchProcessDamage(IEnumerable<DamageEvent> events, BattleContext context)
    {
        // åˆå¹¶å¯¹åŒä¸€ç›®æ ‡çš„ä¼¤å®³
        var damageByTarget = events
            .GroupBy(e => e.TargetId)
            .ToDictionary(g => g.Key, g => g.Sum(e => e.Amount));
        
        foreach (var (targetId, totalDamage) in damageByTarget)
        {
            context.ApplyDamage(targetId, totalDamage);
        }
    }
}
```

**é¢„æœŸæ”¶ç›Š**: æˆ˜æ–—äº‹ä»¶å¤„ç†é€Ÿåº¦æå‡ 15-20%

**å·¥ä½œé‡ä¼°ç®—**: 14 å·¥æ—¶ (2 å¤©)

---

### 7.2 æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

#### ä¼˜åŒ–è¦ç‚¹
1. **æ‰¹é‡æŸ¥è¯¢**: å‡å°‘å¾€è¿”æ¬¡æ•°
2. **ç¼“å­˜ç­–ç•¥**: è§’è‰²æ•°æ®ã€è£…å¤‡å®šä¹‰ç¼“å­˜
3. **ç´¢å¼•ä¼˜åŒ–**: æ·»åŠ å¿…è¦çš„æ•°æ®åº“ç´¢å¼•
4. **å»¶è¿ŸåŠ è½½**: æŒ‰éœ€åŠ è½½å…³è”æ•°æ®

**å·¥ä½œé‡ä¼°ç®—**: 16 å·¥æ—¶ (2 å¤©)

---

### 7.3 SignalR æ¶ˆæ¯ä¼˜åŒ–

#### ä¼˜åŒ–è¦ç‚¹
1. **æ¶ˆæ¯åˆå¹¶**: çŸ­æ—¶é—´å†…çš„å¤šä¸ªæ¶ˆæ¯åˆå¹¶å‘é€
2. **é€‰æ‹©æ€§æ¨é€**: æ ¹æ®å®¢æˆ·ç«¯è®¢é˜…æ¨é€
3. **æ¶ˆæ¯å‹ç¼©**: å¯ç”¨ MessagePack

**å·¥ä½œé‡ä¼°ç®—**: 10 å·¥æ—¶ (1-1.5 å¤©)

---

## ä»£ç è´¨é‡ä¼˜åŒ–

### 8.1 ä»£ç é‡å¤æ¶ˆé™¤

#### ç›®æ ‡
- ä»£ç é‡å¤åº¦ä» ~10% é™è‡³ < 5%

#### å…³é”®ä»»åŠ¡
1. **æå–å…¬å…±å·¥å…·ç±»**
   - ValidationHelper
   - ConfigurationValidator
   - MathHelper
   - TimeHelper

2. **ç»Ÿä¸€å¼‚å¸¸å¤„ç†**
   - åˆ›å»º ExceptionHandler åŸºç±»
   - æ ‡å‡†åŒ–é”™è¯¯å“åº”æ ¼å¼

3. **ç»Ÿä¸€æ•°æ®è®¿é—®æ¨¡å¼**
   - åˆ›å»º Repository åŸºç±»
   - ç»Ÿä¸€æŸ¥è¯¢æ–¹æ³•

**å·¥ä½œé‡ä¼°ç®—**: 20 å·¥æ—¶ (2.5 å¤©)

---

### 8.2 æ³¨é‡Šå®Œå–„

#### ç›®æ ‡
- æ‰€æœ‰ å…¬å…± API æœ‰ XML æ³¨é‡Š
- æ ¸å¿ƒç®—æ³•æœ‰è¯¦ç»†æ³¨é‡Š

#### å…³é”®ä»»åŠ¡
1. **API æ§åˆ¶å™¨æ³¨é‡Š** (13 ä¸ªæ§åˆ¶å™¨)
2. **æ ¸å¿ƒå¼•æ“æ³¨é‡Š** (BattleEngine, DamageCalculator ç­‰)
3. **é¢†åŸŸæ¨¡å‹æ³¨é‡Š**

**å·¥ä½œé‡ä¼°ç®—**: 24 å·¥æ—¶ (3 å¤©)

---

### 8.3 å•å…ƒæµ‹è¯•è¦†ç›–ç‡æå‡

#### ç›®æ ‡
- è¦†ç›–ç‡ä» ~85% æå‡è‡³ > 95%

#### å…³é”®ä»»åŠ¡
1. **è¡¥å……æµ‹è¯•ç”¨ä¾‹**
   - ResourceBucket æµ‹è¯•
   - BuffManager æµ‹è¯•
   - ActivityPlanService æµ‹è¯•
   - RerollService æµ‹è¯•

2. **è¾¹ç•Œæ¡ä»¶æµ‹è¯•**
3. **å¼‚å¸¸åœºæ™¯æµ‹è¯•**

**å·¥ä½œé‡ä¼°ç®—**: 28 å·¥æ—¶ (3.5 å¤©)

---

### 8.4 æ—¥å¿—è§„èŒƒåŒ–

#### ç›®æ ‡
- æ—¥å¿—è°ƒç”¨ä» 96 å¢è‡³ 150+
- ç»“æ„åŒ–æ—¥å¿—æ ¼å¼ç»Ÿä¸€

#### å…³é”®ä»»åŠ¡
1. **æˆ˜æ–—ç³»ç»Ÿæ—¥å¿—å¢å¼º**
2. **ç»æµç³»ç»Ÿæ—¥å¿—å¢å¼º**
3. **æ´»åŠ¨ç³»ç»Ÿæ—¥å¿—å¢å¼º**

**å·¥ä½œé‡ä¼°ç®—**: 16 å·¥æ—¶ (2 å¤©)

---

## ç›‘æ§ä¸è¯Šæ–­ä¼˜åŒ–

### 9.1 ç›‘æ§æŒ‡æ ‡å®Œå–„

#### ç›®æ ‡
- ç›‘æ§æŒ‡æ ‡ä» 5 ä¸ªå¢è‡³ 20+ ä¸ª

#### æ–°å¢æŒ‡æ ‡

**æˆ˜æ–—ç³»ç»ŸæŒ‡æ ‡**:
- `combat.segment_events_per_min` - æ¯åˆ†é’Ÿäº‹ä»¶æ•°
- `combat.avg_events_per_segment` - æ¯æ®µå¹³å‡äº‹ä»¶æ•°
- `combat.flush_due_time_ratio` - æ—¶é—´è§¦å‘ flush å æ¯”

**èµ„æºç³»ç»ŸæŒ‡æ ‡**:
- `resource.overflow_rate` - èµ„æºæº¢å‡ºç‡
- `resource.bucket_fill_ratio` - èµ„æºæ¡¶å¡«å……ç‡
- `resource.convert_events` - è½¬æ¢äº‹ä»¶æ¬¡æ•°

**ç¦»çº¿ç³»ç»ŸæŒ‡æ ‡**:
- `offline.fast_forward_duration_ms` - å¿«è¿›è€—æ—¶
- `offline.segment_generated` - ç”Ÿæˆæ®µæ•°
- `offline.reward_amount` - å¥–åŠ±é‡‘é¢

**ç»æµç³»ç»ŸæŒ‡æ ‡**:
- `economy.gold_in_out_ratio` - é‡‘å¸æµå…¥æµå‡ºæ¯”
- `economy.reroll_cost_avg` - å¹³å‡é‡ç½®æˆæœ¬
- `economy.disenchant_yield` - åˆ†è§£äº§å‡º

**æŠ€èƒ½ç³»ç»ŸæŒ‡æ ‡**:
- `skill.autocast_skip_cycles` - è‡ªåŠ¨æ–½æ”¾è·³è¿‡æ¬¡æ•°
- `skill.avg_cast_per_minute` - æ¯åˆ†é’Ÿæ–½æ”¾æ¬¡æ•°

**å‰¯æœ¬ç³»ç»ŸæŒ‡æ ‡**:
- `dungeon.continuous_runtime_dist` - æŒç»­è¿è¡Œæ—¶é•¿åˆ†å¸ƒ
- `dungeon.diminishing_applied_count` - é€’å‡ç”Ÿæ•ˆæ¬¡æ•°

**å·¥ä½œé‡ä¼°ç®—**: 20 å·¥æ—¶ (2.5 å¤©)

---

### 9.2 è°ƒè¯•é¢æ¿ API

#### åŠŸèƒ½
- å®æ—¶æˆ˜æ–—çŠ¶æ€å¿«ç…§
- Track çŠ¶æ€æŸ¥çœ‹
- ResourceBucket çŠ¶æ€
- æŠ€èƒ½å†·å´çŠ¶æ€
- æ´»åŠ¨è®¡åˆ’çŠ¶æ€
- æœ€è¿‘ Segment æŸ¥çœ‹

**å·¥ä½œé‡ä¼°ç®—**: 12 å·¥æ—¶ (1.5 å¤©)

---

## ä¼˜åŒ–å®æ–½è·¯çº¿å›¾

### 10.1 åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

#### é˜¶æ®µ 1: æˆ˜æ–—ç³»ç»Ÿå®Œå–„ (10-12 å¤©)
**ç›®æ ‡**: å®Œå–„æˆ˜æ–—æ ¸å¿ƒæœºåˆ¶

| ä»»åŠ¡ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|------|--------|--------|
| ResourceBucket æº¢å‡ºè½¬æ¢ | 1.5 å¤© | P0 |
| Buff å±‚æ•°å åŠ æœºåˆ¶ | 2.5-3 å¤© | P0 |
| CombatSegment è¯¦ç»†ç»Ÿè®¡ | 2 å¤© | P1 |
| æŠ€èƒ½è‡ªåŠ¨æ–½æ”¾ç­–ç•¥ | 2-3 å¤© | P1 |
| æˆ˜æ–—äº‹ä»¶æ‰¹å¤„ç†ä¼˜åŒ– | 2 å¤© | P1 |

**é‡Œç¨‹ç¢‘**: M1 - æˆ˜æ–—ç³»ç»Ÿå®Œå–„å®Œæˆ

---

#### é˜¶æ®µ 2: è£…å¤‡ä¸æ´»åŠ¨å®Œå–„ (8-10 å¤©)
**ç›®æ ‡**: å®Œå–„è£…å¤‡å’Œæ´»åŠ¨ç³»ç»Ÿ

| ä»»åŠ¡ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|------|--------|--------|
| è£…å¤‡è¯æ¡é‡ç½®åŠŸèƒ½ | 3 å¤© | P0 |
| è£…å¤‡å“çº§ç²¾ç‚¼ | 2-3 å¤© | P1 |
| æ´»åŠ¨äº’æ–¥æ ‡ç­¾ | 1.5 å¤© | P0 |
| é‡‡é›†æ´»åŠ¨æ”¯æŒ | 2.5-3 å¤© | P1 |

**é‡Œç¨‹ç¢‘**: M2 - è£…å¤‡ä¸æ´»åŠ¨å®Œå–„å®Œæˆ

---

#### é˜¶æ®µ 3: ç¦»çº¿ä¸æ€§èƒ½ä¼˜åŒ– (6-8 å¤©)
**ç›®æ ‡**: ä¼˜åŒ–ç¦»çº¿å’Œæ•´ä½“æ€§èƒ½

| ä»»åŠ¡ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|------|--------|--------|
| ç¦»çº¿å‰¯æœ¬æŒç»­æŒ‚æœº | 3 å¤© | P0 |
| ç¦»çº¿å¿«è¿›æ€§èƒ½ä¼˜åŒ– | 1.5 å¤© | P1 |
| æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ– | 2 å¤© | P1 |
| SignalR æ¶ˆæ¯ä¼˜åŒ– | 1-1.5 å¤© | P1 |

**é‡Œç¨‹ç¢‘**: M3 - æ€§èƒ½ä¼˜åŒ–å®Œæˆ

---

#### é˜¶æ®µ 4: ä»£ç è´¨é‡æå‡ (10-12 å¤©)
**ç›®æ ‡**: æå‡ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§

| ä»»åŠ¡ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|------|--------|--------|
| ä»£ç é‡å¤æ¶ˆé™¤ | 2.5 å¤© | P0 |
| æ³¨é‡Šå®Œå–„ | 3 å¤© | P0 |
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡æå‡ | 3.5 å¤© | P0 |
| æ—¥å¿—è§„èŒƒåŒ– | 2 å¤© | P1 |

**é‡Œç¨‹ç¢‘**: M4 - ä»£ç è´¨é‡è¾¾æ ‡

---

#### é˜¶æ®µ 5: ç›‘æ§ä¸è¯Šæ–­ (4-5 å¤©)
**ç›®æ ‡**: å®Œå–„ç›‘æ§å’Œè¯Šæ–­èƒ½åŠ›

| ä»»åŠ¡ | å·¥ä½œé‡ | ä¼˜å…ˆçº§ |
|------|--------|--------|
| ç›‘æ§æŒ‡æ ‡å®Œå–„ | 2.5 å¤© | P1 |
| è°ƒè¯•é¢æ¿ API | 1.5 å¤© | P1 |

**é‡Œç¨‹ç¢‘**: M5 - ç›‘æ§ä½“ç³»å®Œå–„

---

### 10.2 æ€»ä½“æ—¶é—´è¡¨

| é˜¶æ®µ | æ—¶é—´èŒƒå›´ | å·¥ä½œé‡ |
|------|----------|--------|
| **é˜¶æ®µ 1**: æˆ˜æ–—ç³»ç»Ÿå®Œå–„ | Day 1-12 | 80-96 å·¥æ—¶ |
| **é˜¶æ®µ 2**: è£…å¤‡ä¸æ´»åŠ¨å®Œå–„ | Day 13-22 | 64-80 å·¥æ—¶ |
| **é˜¶æ®µ 3**: ç¦»çº¿ä¸æ€§èƒ½ä¼˜åŒ– | Day 23-30 | 48-64 å·¥æ—¶ |
| **é˜¶æ®µ 4**: ä»£ç è´¨é‡æå‡ | Day 31-42 | 80-96 å·¥æ—¶ |
| **é˜¶æ®µ 5**: ç›‘æ§ä¸è¯Šæ–­ | Day 43-47 | 32-40 å·¥æ—¶ |
| **æ€»è®¡** | **47 å¤©** | **304-376 å·¥æ—¶** |

### 10.3 å¹¶è¡Œå¼€å‘å»ºè®®

**å¯å¹¶è¡Œä»»åŠ¡ç»„åˆ**:
1. é˜¶æ®µ 1 + é˜¶æ®µ 4 (éƒ¨åˆ†)
   - æˆ˜æ–—ç³»ç»Ÿå®Œå–„ + ä»£ç é‡å¤æ¶ˆé™¤
2. é˜¶æ®µ 2 + é˜¶æ®µ 5
   - è£…å¤‡å®Œå–„ + ç›‘æ§æŒ‡æ ‡å¢å¼º

**2 äººå›¢é˜Ÿå·¥æœŸ**: çº¦ 30-35 å¤©  
**3 äººå›¢é˜Ÿå·¥æœŸ**: çº¦ 20-25 å¤©

---

## é™„å½•

### A. ä¼˜åŒ–ä»»åŠ¡æ£€æŸ¥æ¸…å•

#### æˆ˜æ–—ç³»ç»Ÿ
- [ ] ResourceBucket æº¢å‡ºè½¬æ¢ç­–ç•¥
- [ ] Buff å±‚æ•°å åŠ æœºåˆ¶
- [ ] CombatSegment è¯¦ç»†ç»Ÿè®¡
- [ ] æŠ€èƒ½è‡ªåŠ¨æ–½æ”¾ç­–ç•¥å¢å¼º
- [ ] æˆ˜æ–—äº‹ä»¶æ‰¹å¤„ç†ä¼˜åŒ–

#### è£…å¤‡ç³»ç»Ÿ
- [ ] è£…å¤‡è¯æ¡é‡ç½®åŠŸèƒ½
- [ ] è£…å¤‡å“çº§ç²¾ç‚¼
- [ ] è£…å¤‡ç‰¹æ•ˆè§¦å‘æœºåˆ¶

#### æ´»åŠ¨ç³»ç»Ÿ
- [ ] æ´»åŠ¨äº’æ–¥æ ‡ç­¾
- [ ] é‡‡é›†æ´»åŠ¨æ”¯æŒ
- [ ] åˆ¶ä½œæ´»åŠ¨æ”¯æŒ

#### ç¦»çº¿ç³»ç»Ÿ
- [ ] ç¦»çº¿å‰¯æœ¬æŒç»­æŒ‚æœº
- [ ] äº§å‡ºé€’å‡æœºåˆ¶
- [ ] ç¦»çº¿å¿«è¿›æ€§èƒ½ä¼˜åŒ–

#### æ€§èƒ½ä¼˜åŒ–
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- [ ] SignalR æ¶ˆæ¯ä¼˜åŒ–
- [ ] ç¼“å­˜ç­–ç•¥å®Œå–„

#### ä»£ç è´¨é‡
- [ ] ä»£ç é‡å¤æ¶ˆé™¤
- [ ] æ³¨é‡Šå®Œå–„
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡æå‡
- [ ] æ—¥å¿—è§„èŒƒåŒ–
- [ ] å¼‚å¸¸å¤„ç†å¢å¼º

#### ç›‘æ§è¯Šæ–­
- [ ] ç›‘æ§æŒ‡æ ‡å®Œå–„ (20+ æŒ‡æ ‡)
- [ ] è°ƒè¯•é¢æ¿ API
- [ ] ç»æµç›‘æ§æŠ¥è¡¨

---

**æ–‡æ¡£çŠ¶æ€**: âœ… ä¼˜åŒ–æ–¹æ¡ˆå®Œæˆ  
**ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-10-15
